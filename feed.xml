<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://edumunozsala.github.io/BlogEms/feed.xml" rel="self" type="application/atom+xml" /><link href="https://edumunozsala.github.io/BlogEms/" rel="alternate" type="text/html" /><updated>2021-05-02T10:25:32-05:00</updated><id>https://edumunozsala.github.io/BlogEms/feed.xml</id><title type="html">Eduardo Muñoz NLP Blog</title><subtitle>Introducing many NLP models and task I learnt on my learning path. I hope I can find new content soon.</subtitle><entry><title type="html">Steps to start training your custom Tensorflow model in AWS SageMaker</title><link href="https://edumunozsala.github.io/BlogEms/nlp/sagemaker/tensorflow%202/2020/11/15/transformer_nmt_training_and_serving.html" rel="alternate" type="text/html" title="Steps to start training your custom Tensorflow model in AWS SageMaker" /><published>2020-11-15T00:00:00-06:00</published><updated>2020-11-15T00:00:00-06:00</updated><id>https://edumunozsala.github.io/BlogEms/nlp/sagemaker/tensorflow%202/2020/11/15/transformer_nmt_training_and_serving</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/nlp/sagemaker/tensorflow%202/2020/11/15/transformer_nmt_training_and_serving.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-11-15-transformer_nmt_training_and_serving.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;SageMaker-Experiments,-TensorFlow-script-mode-training-and-restore-checkpoint-to-resume-training&quot;&gt;SageMaker Experiments, TensorFlow script mode training and restore checkpoint to resume training&lt;a class=&quot;anchor-link&quot; href=&quot;#SageMaker-Experiments,-TensorFlow-script-mode-training-and-restore-checkpoint-to-resume-training&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Some sections of this notebook has been inspired by the tutorial:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sagemaker Python SDK Examples: tensorflow_script_mode_training_and_serving.ipynb&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/awslabs/amazon-sagemaker-examples/blob/master/sagemaker-python-sdk/tensorflow_script_mode_training_and_serving/tensorflow_script_mode_training_and_serving.ipynb&quot;&gt;https://github.com/awslabs/amazon-sagemaker-examples/blob/master/sagemaker-python-sdk/tensorflow_script_mode_training_and_serving/tensorflow_script_mode_training_and_serving.ipynb&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;In this notebook we will describe the most relevant steps to start training a custom algorithm in AWS SageMaker, not using a custom container, showing how to deal with experiments and solving some of the problems when facing with custom models when using SageMaker script mode on. Some basics concepts on SageMaker will not be detailed in order to focus on the relevant concepts.&lt;/p&gt;
&lt;p&gt;Following steps will be explained:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Create an Experiment and Trial to keep track of our experiments&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Load the training data to our training instance&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create the scripts to train our custom model, a Transformer.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create an Estimator to train our model in a Tensorflow 2.1 container in script mode&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Create metric definitions to keep track of them in SageMaker&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Download the trained model to make predictions&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Resume training using the latest checkpoint from a previous training&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Amazon-SageMaker-Overview&quot;&gt;Amazon SageMaker Overview&lt;a class=&quot;anchor-link&quot; href=&quot;#Amazon-SageMaker-Overview&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;em&gt;Amazon SageMaker is a fully managed machine learning service. With SageMaker, data scientists and developers can quickly and easily build and train machine learning models, and then directly deploy them into a production-ready hosted environment.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Amazon SageMaker Developer Guide&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Amazon SageMaker provides many tools to help developers to manage the Machine Learning Lifecycle workflow:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Fetch, Clean and transform the data: you can use SageMaker notebook instances to manipulate and analyze your data, then you can clean and transform it to the requiered format for your algorithm. And you can use Pipelines functionality to serve the data to your model during training.&lt;/li&gt;
&lt;li&gt;Train and evaluate the model: There are many different posibilities to train your model. You can use built-in algorithm, models provided by SageMaker, or you can use custom code to train in the most popular deep learning framewors (Tensorflow, Pytorch, Apache MXNet,..) or even use Apache Spark. Finally, you can use your own custom algorithm and build a Docker container then training the model on SageMaker. You can keep track of your model metrics to evaluate the performance.&lt;/li&gt;
&lt;li&gt;Deploy your model: Once your model is trained, you can deploy it in and endpoint service in SageMaker and make prediction one at a time or in batch mode.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/ml-concepts-10.png&quot; alt=&quot;Alt&quot; title=&quot;Machine Learning Lifecycle work flow&quot; /&gt;&lt;/p&gt;
&lt;p&gt;A simple and popular way to get started and work with SageMaker is to use the Amazon SageMaker Python SDK. It provides  Python APIs and containers that make it easy to train and deploy models in SageMaker, as well as examples for use with several different machine learning and deep learning frameworks.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Problem-description&quot;&gt;Problem description&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-description&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;For this project we will develope notebooks and scripts to train a Transformer Tensorflow 2 model to solve a neural machine translation problem, traslating simple sentences from English to Spanish. This problem and the model is extensively described in my Mdeium post &lt;a href=&quot;https://towardsdatascience.com/attention-is-all-you-need-discovering-the-transformer-paper-73e5ff5e0634&quot;&gt;&quot;Attention is all you need: Discovering the Transformer paper&quot;&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Data-description&quot;&gt;Data description&lt;a class=&quot;anchor-link&quot; href=&quot;#Data-description&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;For this exercise, we’ll use pairs of simple sentences. The source text will be in English, and the target text will be in Spanish, from the Tatoeba project where people contribute, adding translations every day. This is the &lt;a href=&quot;http://www.manythings.org/anki/&quot;&gt;link&lt;/a&gt; to some translations in different languages. There you can download the Spanish/English &lt;code&gt;spa_eng.zip&lt;/code&gt; file; it contains 124,457 pairs of sentences.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Set-up-the-environment&quot;&gt;Set up the environment&lt;a class=&quot;anchor-link&quot; href=&quot;#Set-up-the-environment&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Let's start by setting up the environment:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;First, we will import and load the libraries to use in our project.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;load_ext&lt;/span&gt; autoreload
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;autoreload&lt;/span&gt; 2
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_execution_role&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create a SageMaker session to work with&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the role of our user and the region&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;role&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;get_execution_role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;region&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;boto_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;region_name&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;region&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;arn:aws:iam::223817798831:role/service-role/AmazonSageMaker-ExecutionRole-20200708T194212
us-east-1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Define-global-variables-and-parameters&quot;&gt;Define global variables and parameters&lt;a class=&quot;anchor-link&quot; href=&quot;#Define-global-variables-and-parameters&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the variables for data locations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;spa.txt&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_en&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nonbreaking_prefix.en&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_es&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nonbreaking_prefix.es&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the directories for our nodel output&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trainedmodel_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;trained_model&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_data_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;output_data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the name of the artifacts that our model generate (model not included) &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_info_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;model_info.pth&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_vocab_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;in_vocab.pkl&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_vocab_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;out_vocab.pkl&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the absolute path of the train data &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_en_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_en&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_es_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_es&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;When working with Amazon SageMaker training jobs that will run on containers in a new instance or &quot;vm&quot;, the data has to be share using a S3 Storage folder. For this purpose we define the bucket name and the folder names where our inputs and outputs will be stored. In our case we define:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;training data&lt;/strong&gt; URI: where our input data is located&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;output folder&lt;/strong&gt;: where our training saves the outputs fron our model&lt;/li&gt;
&lt;li&gt;The &lt;strong&gt;checkpoint folder&lt;/strong&gt;: where our model uploads the checkpoints&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Specify your bucket name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;edumunozsala-ml-sagemaker&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the training data folder in S3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;transformer-nmt/train&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the output folder in S3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;transformer-nmt&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the checkpoint in S3 folder for our model &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ckpt_folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;transformer-nmt/ckpt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;training_data_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;s3://&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training_folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;s3://&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output_folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ckpt_data_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;s3://&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_folder&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ckpt_data_uri&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(&amp;#39;s3://edumunozsala-ml-sagemaker/transformer-nmt/train&amp;#39;,
 &amp;#39;s3://edumunozsala-ml-sagemaker/transformer-nmt&amp;#39;,
 &amp;#39;s3://edumunozsala-ml-sagemaker/transformer-nmt/ckpt&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Then we can upload to the training data folder in S3 the files necessary for training: training data, non breaking prefixes for the inputs (English) and the non breaking prefixes for the outputs (Spanish). Once uploaded they can be loaded for training in the SageMaker container.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upload_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                              &lt;span class=&quot;n&quot;&gt;key_prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upload_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;non_breaking_en_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                              &lt;span class=&quot;n&quot;&gt;key_prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upload_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;non_breaking_es_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                              &lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                              &lt;span class=&quot;n&quot;&gt;key_prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;s3://edumunozsala-ml-sagemaker/transformer-nmt/train/nonbreaking_prefix.es&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Create-an-experiment-and-trial&quot;&gt;Create an experiment and trial&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-an-experiment-and-trial&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;em&gt;Amazon SageMaker Experiments&lt;/em&gt; is a capability of Amazon SageMaker that lets you organize, track, compare, and evaluate your machine learning experiments.&lt;/p&gt;
&lt;p&gt;Machine learning is an iterative process. You need to experiment with multiple combinations of data, algorithm and parameters, all the while observing the impact of incremental changes on model accuracy. Over time this iterative experimentation can result in thousands of model training runs and model versions. This makes it hard to track the best performing models and their input configurations. It’s also difficult to compare active experiments with past experiments to identify opportunities for further incremental improvements.&lt;/p&gt;
&lt;p&gt;Experiments will help us to organize and manage all executions, metrics and results of a ML project.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Install the library necessary to handle experiments&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install sagemaker-experiments
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Collecting sagemaker-experiments
  Using cached sagemaker_experiments-0.1.24-py3-none-any.whl (36 kB)
Requirement already satisfied: boto3&amp;gt;=1.12.8 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from sagemaker-experiments) (1.16.9)
Requirement already satisfied: s3transfer&amp;lt;0.4.0,&amp;gt;=0.3.0 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from boto3&amp;gt;=1.12.8-&amp;gt;sagemaker-experiments) (0.3.3)
Requirement already satisfied: jmespath&amp;lt;1.0.0,&amp;gt;=0.7.1 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from boto3&amp;gt;=1.12.8-&amp;gt;sagemaker-experiments) (0.10.0)
Requirement already satisfied: botocore&amp;lt;1.20.0,&amp;gt;=1.19.9 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from boto3&amp;gt;=1.12.8-&amp;gt;sagemaker-experiments) (1.19.9)
Requirement already satisfied: python-dateutil&amp;lt;3.0.0,&amp;gt;=2.1 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from botocore&amp;lt;1.20.0,&amp;gt;=1.19.9-&amp;gt;boto3&amp;gt;=1.12.8-&amp;gt;sagemaker-experiments) (2.8.1)
Requirement already satisfied: urllib3&amp;lt;1.26,&amp;gt;=1.25.4; python_version != &amp;#34;3.4&amp;#34; in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from botocore&amp;lt;1.20.0,&amp;gt;=1.19.9-&amp;gt;boto3&amp;gt;=1.12.8-&amp;gt;sagemaker-experiments) (1.25.10)
Requirement already satisfied: six&amp;gt;=1.5 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from python-dateutil&amp;lt;3.0.0,&amp;gt;=2.1-&amp;gt;botocore&amp;lt;1.20.0,&amp;gt;=1.19.9-&amp;gt;boto3&amp;gt;=1.12.8-&amp;gt;sagemaker-experiments) (1.14.0)
Installing collected packages: sagemaker-experiments
Successfully installed sagemaker-experiments-0.1.24
&lt;span class=&quot;ansi-yellow-fg&quot;&gt;WARNING: You are using pip version 20.0.2; however, version 20.2.4 is available.
You should consider upgrading via the &amp;#39;/home/ec2-user/anaconda3/envs/tensorflow2_p36/bin/python -m pip install --upgrade pip&amp;#39; command.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Load the libraries to handle experiments&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Import the libraries to work with Experiments in SageMaker&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;smexperiments.experiment&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experiment&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;smexperiments.trial&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Trial&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;smexperiments.trial_component&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrialComponent&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Set the experiment and trial name and one tag to help us to identify the reason for this items.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the experiment name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tf-transformer&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the trial name &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;single-gpu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Key&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;my-experiments&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;transformerEngSpa1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You can create an experiment to track all the model training iterations. Experiments are a great way to organize your data science work. You can create experiments to organize all your model development work for : a business use case you are addressing (e.g. create experiment named “customer churn prediction”), or a data science team that owns the experiment (e.g. create experiment named “marketing analytics experiment”), or a specific data science and ML project. Think of it as a “folder” for organizing your “files”.&lt;/p&gt;
&lt;p&gt;We will create a Trial to track each training job run. But this is just a simple example, not intented to explore all the capabilities of the product.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# create the experiment if it doesn&amp;#39;t exist&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;training_experiment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Loaded experiment &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ResourceNotFound&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;training_experiment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                      &lt;span class=&quot;n&quot;&gt;description&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Experiment to track trainings on my tensorflow Transformer Eng-Spa&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                      &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Created experiment &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# create the trial if it doesn&amp;#39;t exist&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;single_gpu_trial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Loaded trial &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ResourceNotFound&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;single_gpu_trial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                             &lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                             &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Created trial &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Loaded experiment  tf-transformer
Loaded trial  tf-transformer-single-gpu
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Trackers&quot;&gt;Trackers&lt;a class=&quot;anchor-link&quot; href=&quot;#Trackers&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another interesting tool to mention, is Tracker objects. They can store information about different types of topics or objects in our model or training process like inputs, parameters, artifacts or metrics. The tracker is attached to a trial, associating the object to the training job. We can record that information and analyze it later on the experiment. &lt;strong&gt;Note&lt;/strong&gt; that only parameters, input artifacts, and output artifacts are saved to SageMaker. Metrics are saved to file.&lt;/p&gt;
&lt;p&gt;As an example, we create a Tracker to register the input data and two parameters about how that data is processed in our project.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;smexperiments.tracker&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tracker&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the tracker for the inout data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tracker_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;TextPreprocessing&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trial_comp_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Change to a an exsting TrialComponent to load it&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tracker&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tracker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_component_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_comp_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Loaded Tracker &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tracker_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tracker&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tracker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;display_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tracker_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tracker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;EngtoSpa Translations&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;media_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;s3/uri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tracker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;log_parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&amp;quot;Tokenizer&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Subword&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s2&quot;&gt;&amp;quot;Max Length&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Created Tracker &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tracker_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Atach the Tracker to the trial&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;single_gpu_trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_trial_component&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tracker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_component&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Created Tracker  TextPreprocessing
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Our last step consist in create the experiment configuration, a dictionary that contains the experiment name, the trial name and the trial component and it will be used to label our training job.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a configuration definition for our experiment and trial&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trial_comp_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;single-gpu-components&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the configuration parameters for the experiment&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;experiment_config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ExperimentName&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training_experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                       &lt;span class=&quot;s1&quot;&gt;&amp;#39;TrialName&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;single_gpu_trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;s1&quot;&gt;&amp;#39;TrialComponentDisplayName&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trial_comp_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Check and show information about the experiment and trial&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Experiment: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Show the trials in the experiment&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#for trial in training_experiment.list_trials():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Trial: &amp;#39;,trial.trial_name)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trial_comp&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TrialComponent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;single_gpu_trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Trial Components: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_comp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Experiment:  tf-transformer
Trial Components:  TrialComponentSummary(trial_component_name=&amp;#39;TrialComponent-2020-11-12-115920-sbov&amp;#39;,trial_component_arn=&amp;#39;arn:aws:sagemaker:us-east-1:223817798831:experiment-trial-component/trialcomponent-2020-11-12-115920-sbov&amp;#39;,display_name=&amp;#39;TextPreprocessing&amp;#39;,creation_time=datetime.datetime(2020, 11, 12, 11, 59, 20, 739000, tzinfo=tzlocal()),created_by={},last_modified_time=datetime.datetime(2020, 11, 12, 11, 59, 20, 739000, tzinfo=tzlocal()),last_modified_by={})
Trial Components:  TrialComponentSummary(trial_component_name=&amp;#39;tf-transformer-single-gpu-2020-11-12-11-44-28-aws-training-job&amp;#39;,trial_component_arn=&amp;#39;arn:aws:sagemaker:us-east-1:223817798831:experiment-trial-component/tf-transformer-single-gpu-2020-11-12-11-44-28-aws-training-job&amp;#39;,display_name=&amp;#39;single-gpu-components&amp;#39;,trial_component_source={&amp;#39;SourceArn&amp;#39;: &amp;#39;arn:aws:sagemaker:us-east-1:223817798831:training-job/tf-transformer-single-gpu-2020-11-12-11-44-28&amp;#39;, &amp;#39;SourceType&amp;#39;: &amp;#39;SageMakerTrainingJob&amp;#39;},status=TrialComponentStatus(primary_status=&amp;#39;Failed&amp;#39;,message=&amp;#39;Status: Failed, secondary status: Failed, failure reason: AlgorithmError: ExecuteUserScriptError:\nCommand &amp;#34;/usr/bin/python3 train.py --epochs 8 --model_dir s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-11-44-28/model --non_breaking_in nonbreaking_prefix.en --non_breaking_out nonbreaking_prefix.es --nsamples 60000 --resume False --train_file spa.txt&amp;#34;.&amp;#39;),creation_time=datetime.datetime(2020, 11, 12, 11, 44, 32, 948000, tzinfo=tzlocal()),created_by={},last_modified_time=datetime.datetime(2020, 11, 12, 11, 50, 27, 732000, tzinfo=tzlocal()),last_modified_by={})
Trial Components:  TrialComponentSummary(trial_component_name=&amp;#39;TrialComponent-2020-11-12-113905-rpfc&amp;#39;,trial_component_arn=&amp;#39;arn:aws:sagemaker:us-east-1:223817798831:experiment-trial-component/trialcomponent-2020-11-12-113905-rpfc&amp;#39;,display_name=&amp;#39;TextPreprocessing&amp;#39;,creation_time=datetime.datetime(2020, 11, 12, 11, 39, 5, 995000, tzinfo=tzlocal()),created_by={},last_modified_time=datetime.datetime(2020, 11, 12, 11, 39, 5, 995000, tzinfo=tzlocal()),last_modified_by={})
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Construct-a-script-for-training&quot;&gt;Construct a script for training&lt;a class=&quot;anchor-link&quot; href=&quot;#Construct-a-script-for-training&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Script mode is a training script format for TensorFlow that lets you execute any TensorFlow training script in SageMaker with minimal modification. The SageMaker Python SDK handles transferring your script to a SageMaker training instance. On the training instance, SageMaker's native TensorFlow support sets up training-related environment variables and executes your training script. In this tutorial, we use the SageMaker Python SDK to launch a training job.&lt;/p&gt;
&lt;p&gt;Script mode supports training with a Python script, a Python module, or a shell script.&lt;/p&gt;
&lt;p&gt;This project's training script was adapted from the Tensorflow model of a Transformer, we develop in a previous post (mentioned previously). We have modified it to handle:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;train_file&lt;/code&gt;, &lt;code&gt;non_breaking_in&lt;/code&gt;and &lt;code&gt;non_breaking_out&lt;/code&gt; parameters passed in with the values of the training data-set, the non breaking prefixes for the input data and the non breaking prefixes for the output data.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;data_dir&lt;/code&gt; parameter passed in by SageMaker with the value of the enviroment variable &lt;code&gt;SM_CHANNEL_TRAINING&lt;/code&gt;. This is an S3 path used for input data sharing during training.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;model_dir&lt;/code&gt; parameter passed in by SageMaker. This is an S3 path which can be used for data sharing during distributed training and checkpointing and/or model persistence. We have also added an argument-parsing function to handle processing training-related variables.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the local checkpoint path to store the model checkpoints during training. We use the default value &lt;code&gt;/opt/ml/checkpoints&lt;/code&gt; that will be uploaded to S3. We comment this behavior later when defining our estimator.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;At the end of the training job we have added a step to export the trained model, only the weights, to the path stored in the environment variable &lt;code&gt;SM_MODEL_DIR&lt;/code&gt;, which always points to &lt;code&gt;/opt/ml/model&lt;/code&gt;. This is critical because SageMaker uploads all the model artifacts in this folder to S3 at end of training.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;the &lt;code&gt;output_data_dir&lt;/code&gt; parameter passed in by SageMaker with the value of the enviroment variable &lt;code&gt;SM_OUTPUT_DATA_DIR&lt;/code&gt;. This is a folder path used to save output data from our model. This folder will be uploaded to S3 to store the output.tar.zip. In our case we need to save the tokenizer for the input texts, the tokenizer for the outputs, the input and output vocab size and the tokens for &lt;code&gt;eos&lt;/code&gt; and &lt;code&gt;sos&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In addition to the train.py file, our source code folder includes the files:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;model.py: Tensorflow model definition&lt;/li&gt;
&lt;li&gt;utils.py: utility functions to process the text data &lt;/li&gt;
&lt;li&gt;utils_train.py: contains functions to calculate the loss and learning rate scheduler.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here is the entire script for the train.py file:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pygmentize &lt;span class=&quot;s1&quot;&gt;&amp;#39;train/train.py&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;argparse&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;json&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;ansi-white-fg&quot;&gt;#import sagemaker_containers&lt;/span&gt;

&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;math&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;gc&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;pickle&lt;/span&gt;

&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;tf&lt;/span&gt;

&lt;span class=&quot;ansi-white-fg&quot;&gt;# To install tensorflow_datasets&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;subprocess&lt;/span&gt;

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;install&lt;/span&gt;(package):
    subprocess.check_call([sys.executable, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;-q&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;-m&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;pip&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;install&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, package])

&lt;span class=&quot;ansi-white-fg&quot;&gt;# Install the library tensorflow_datasets&lt;/span&gt;
install(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;tensorflow_datasets&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)

&lt;span class=&quot;ansi-blue-fg&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;utils&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; preprocess_text_nonbreaking, subword_tokenize
&lt;span class=&quot;ansi-white-fg&quot;&gt;#from utils_train import loss_function, CustomSchedule&lt;/span&gt;

&lt;span class=&quot;ansi-blue-fg&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; Transformer

INPUT_COLUMN = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;
TARGET_COLUMN = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;
&lt;span class=&quot;ansi-white-fg&quot;&gt;#NUM_SAMPLES = 80000 #40000&lt;/span&gt;
&lt;span class=&quot;ansi-white-fg&quot;&gt;#MAX_VOCAB_SIZE = 2**14&lt;/span&gt;

&lt;span class=&quot;ansi-white-fg&quot;&gt;#BATCH_SIZE = 64  # Batch size for training.&lt;/span&gt;
&lt;span class=&quot;ansi-white-fg&quot;&gt;#EPOCHS = 10  # Number of epochs to train for.&lt;/span&gt;
&lt;span class=&quot;ansi-white-fg&quot;&gt;#MAX_LENGTH = 15&lt;/span&gt;

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;get_train_data&lt;/span&gt;(training_dir, nonbreaking_in, nonbreaking_out, train_file, nsamples):
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Load the nonbreaking files&lt;/span&gt;
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(os.path.join(training_dir, nonbreaking_in), 
        mode = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, encoding = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;utf-8&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        non_breaking_prefix_en = f.read()
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(os.path.join(training_dir, nonbreaking_out), 
        mode = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, encoding = &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;utf-8&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        non_breaking_prefix_es = f.read()

    non_breaking_prefix_en = non_breaking_prefix_en.split(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    non_breaking_prefix_en = [&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt; + pref + &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; pref &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; non_breaking_prefix_en]
    non_breaking_prefix_es = non_breaking_prefix_es.split(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    non_breaking_prefix_es = [&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt; &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt; + pref + &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; pref &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; non_breaking_prefix_es]
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Load the training data&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Load the dataset: sentence in english, sentence in spanish &lt;/span&gt;
    df=pd.read_csv(os.path.join(training_dir, train_file), sep=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;, header=&lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;, names=[INPUT_COLUMN,TARGET_COLUMN], usecols=[&lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;], 
               nrows=nsamples)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Preprocess the input data&lt;/span&gt;
    input_data=df[INPUT_COLUMN].apply(&lt;span class=&quot;ansi-blue-fg&quot;&gt;lambda&lt;/span&gt; x : preprocess_text_nonbreaking(x, non_breaking_prefix_en)).tolist()
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Preprocess and include the end of sentence token to the target text&lt;/span&gt;
    target_data=df[TARGET_COLUMN].apply(&lt;span class=&quot;ansi-blue-fg&quot;&gt;lambda&lt;/span&gt; x : preprocess_text_nonbreaking(x, non_breaking_prefix_es)).tolist()

    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; input_data, target_data

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;main_train&lt;/span&gt;(dataset, transformer, n_epochs, print_every=&lt;span class=&quot;ansi-blue-fg&quot;&gt;50&lt;/span&gt;):
  &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Train the transformer model for n_epochs using the data generator dataset&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
  losses = []
  accuracies = []
  &lt;span class=&quot;ansi-white-fg&quot;&gt;# In every epoch&lt;/span&gt;
  &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; epoch &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;range&lt;/span&gt;(n_epochs):
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Starting epoch &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;.format(epoch+&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;))
    start = time.time()
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Reset the losss and accuracy calculations&lt;/span&gt;
    train_loss.reset_states()
    train_accuracy.reset_states()
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Get a batch of inputs and targets&lt;/span&gt;
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; (batch, (enc_inputs, targets)) &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;enumerate&lt;/span&gt;(dataset):
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Set the decoder inputs&lt;/span&gt;
        dec_inputs = targets[:, :-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;]
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Set the target outputs, right shifted&lt;/span&gt;
        dec_outputs_real = targets[:, &lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;:]
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; tf.GradientTape() &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; tape:
            &lt;span class=&quot;ansi-white-fg&quot;&gt;# Call the transformer and get the predicted output&lt;/span&gt;
            predictions = transformer(enc_inputs, dec_inputs, &lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;)
            &lt;span class=&quot;ansi-white-fg&quot;&gt;# Calculate the loss&lt;/span&gt;
            loss = loss_function(dec_outputs_real, predictions)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Update the weights and optimizer&lt;/span&gt;
        gradients = tape.gradient(loss, transformer.trainable_variables)
        optimizer.apply_gradients(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;zip&lt;/span&gt;(gradients, transformer.trainable_variables))
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Save and store the metrics&lt;/span&gt;
        train_loss(loss)
        train_accuracy(dec_outputs_real, predictions)
        
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; batch % print_every == &lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;:
            losses.append(train_loss.result())
            accuracies.append(train_accuracy.result())
            &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Epoch &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt; Batch &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt; Loss &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt; Accuracy &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;.format(
                epoch+&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;, batch, train_loss.result(), train_accuracy.result()))
            
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Checkpoint the model on every epoch        &lt;/span&gt;
    ckpt_save_path = ckpt_manager.save()
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Saving checkpoint for epoch &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt; in &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;.format(epoch+&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;,
                                                        ckpt_save_path))
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(&amp;#34;Time for 1 epoch: {} secs\n&amp;#34;.format(time.time() - start))&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Save the model&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#transformer.save(args.sm_model_dir, overwrite=True, save_format=&amp;#39;tf&amp;#39;)&lt;/span&gt;
    
  &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; losses, accuracies


&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;loss_function&lt;/span&gt;(target, pred):
    mask = tf.math.logical_not(tf.math.equal(target, &lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;))
    loss_ = loss_object(target, pred)
    
    mask = tf.cast(mask, dtype=loss_.dtype)
    loss_ *= mask
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; tf.reduce_mean(loss_)

&lt;span class=&quot;ansi-blue-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-green-fg ansi-underline&quot;&gt;CustomSchedule&lt;/span&gt;(tf.keras.optimizers.schedules.LearningRateSchedule):
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;__init__&lt;/span&gt;(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;, d_model, warmup_steps=&lt;span class=&quot;ansi-blue-fg&quot;&gt;4000&lt;/span&gt;):
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;super&lt;/span&gt;(CustomSchedule, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;).&lt;span class=&quot;ansi-green-fg&quot;&gt;__init__&lt;/span&gt;()
        
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.d_model = tf.cast(d_model, tf.float32)
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.warmup_steps = warmup_steps
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;__call__&lt;/span&gt;(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;, step):
        arg1 = tf.math.rsqrt(step)
        arg2 = step * (&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.warmup_steps**-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1.5&lt;/span&gt;)
        
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; tf.math.rsqrt(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.d_model) * tf.math.minimum(arg1, arg2)


&lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ansi-red-fg&quot;&gt;__name__&lt;/span&gt; == &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;__main__&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;:
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Install tensorflow_datasets&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#install(&amp;#39;tensorflow_datasets&amp;#39;)&lt;/span&gt;

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# All of the model parameters and training parameters are sent as arguments when the script&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# is executed. Here we set up an argument parser to easily access the parameters.&lt;/span&gt;

    parser = argparse.ArgumentParser()

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Training Parameters&lt;/span&gt;
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--batch-size&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;64&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;input batch size for training (default: 64)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--max-len&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;15&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;input max sequence length for training (default: 60)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--epochs&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;2&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;number of epochs to train (default: 2)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--nsamples&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;10000&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;number of samples to train (default: 20000)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--resume&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;bool&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;False&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Resume training from the latest checkpoint (default: False)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Data parameters                    &lt;/span&gt;
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--train_file&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Training data file name&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--non_breaking_in&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Non breaking prefixes for input vocabulary&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--non_breaking_out&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Non breaking prefixes for output vocabulary&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--seed&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;S&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;random seed (default: 1)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Model Parameters&lt;/span&gt;
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--d_model&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;64&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Model dimension (default: 64)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--ffn_dim&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;128&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;size of the FFN layer (default: 128)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--vocab_size&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;10000&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;size of the vocabulary (default: 10000)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--n_layers&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;4&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;number of layers (default: 4)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--n_heads&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;8&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;number of heads (default: 8)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--dropout_rate&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;float&lt;/span&gt;, default=&lt;span class=&quot;ansi-blue-fg&quot;&gt;0.1&lt;/span&gt;, metavar=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,
                        help=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Dropout rate (default: 0.1)&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# SageMaker Parameters&lt;/span&gt;
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--hosts&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;list&lt;/span&gt;, default=json.loads(os.environ[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;SM_HOSTS&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;]))
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--current-host&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=os.environ[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;SM_CURRENT_HOST&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;])
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--sm-model-dir&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=os.environ[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;SM_MODEL_DIR&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;])
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--model_dir&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;)
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--data-dir&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=os.environ[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;SM_CHANNEL_TRAINING&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;])
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--num-gpus&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;, default=os.environ[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;SM_NUM_GPUS&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;])
    parser.add_argument(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;--output-data-dir&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;, default=os.environ[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;SM_OUTPUT_DATA_DIR&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;])

    args = parser.parse_args()

    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(args.sm_model_dir, args.model_dir)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Load the training data.&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Get the train data&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    input_data, target_data = get_train_data(args.data_dir, args.non_breaking_in, args.non_breaking_out, args.train_file, args.nsamples)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Tokenize and pad the input sequences&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Tokenize the input and output data and create the vocabularies&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;) 
    encoder_inputs, tokenizer_inputs, num_words_inputs, sos_token_input, eos_token_input, del_idx_inputs= subword_tokenize(input_data, 
                                                                                                        args.vocab_size, args.max_len)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Tokenize and pad the outputs sequences&lt;/span&gt;
    decoder_outputs, tokenizer_outputs, num_words_output, sos_token_output, eos_token_output, del_idx_outputs = subword_tokenize(target_data,                                                                                                       args.vocab_size, args.max_len)
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Input vocab: &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,num_words_inputs)
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Output vocab: &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;,num_words_output)
    
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Define a dataset &lt;/span&gt;
    dataset = tf.data.Dataset.from_tensor_slices(
                    (encoder_inputs, decoder_outputs))
    dataset = dataset.shuffle(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;len&lt;/span&gt;(input_data), reshuffle_each_iteration=&lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;).batch(
                    args.batch_size, drop_remainder=&lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;)
    dataset = dataset.prefetch(tf.data.experimental.AUTOTUNE)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Clean the session&lt;/span&gt;
    tf.keras.backend.clear_session()
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Create the Transformer model&lt;/span&gt;
    transformer = Transformer(vocab_size_enc=num_words_inputs,
                          vocab_size_dec=num_words_output,
                          d_model=args.d_model,
                          n_layers=args.n_layers,
                          FFN_units=args.ffn_dim,
                          n_heads=args.n_heads,
                          dropout_rate=args.dropout_rate)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Define a categorical cross entropy loss&lt;/span&gt;
    loss_object = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=&lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;,
                                                            reduction=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;none&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Define a metric to store the mean loss of every epoch&lt;/span&gt;
    train_loss = tf.keras.metrics.Mean(name=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Define a matric to save the accuracy in every epoch&lt;/span&gt;
    train_accuracy = tf.keras.metrics.SparseCategoricalAccuracy(name=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;train_accuracy&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Create the scheduler for learning rate decay&lt;/span&gt;
    leaning_rate = CustomSchedule(args.d_model)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Create the Adam optimizer&lt;/span&gt;
    optimizer = tf.keras.optimizers.Adam(leaning_rate,
                                     beta_1=&lt;span class=&quot;ansi-blue-fg&quot;&gt;0.9&lt;/span&gt;,
                                     beta_2=&lt;span class=&quot;ansi-blue-fg&quot;&gt;0.98&lt;/span&gt;,
                                     epsilon=&lt;span class=&quot;ansi-blue-fg&quot;&gt;1e-9&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;#Create the Checkpoint &lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Creating the checkpoint ...&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    ckpt = tf.train.Checkpoint(transformer=transformer,
                           optimizer=optimizer)

    ckpt_manager = tf.train.CheckpointManager(ckpt, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;/opt/ml/checkpoints/&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;, max_to_keep=&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Restore from the latest checkpoint if requiered&lt;/span&gt;
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; ckpt_manager.latest_checkpoint &lt;span class=&quot;ansi-magenta-fg&quot;&gt;and&lt;/span&gt; args.resume:
        ckpt.restore(ckpt_manager.latest_checkpoint)
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Last checkpoint restored.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# to save the model in tf 2.1.0&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(&amp;#39;Preparing the model to be saved....&amp;#39;)&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#for enc_inputs, targets in dataset.take(1):&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#    dec_inputs = targets[:, :-1]&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#    print (enc_inputs.shape, dec_inputs.shape)&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#    transformer._set_inputs(enc_inputs, dec_inputs, True)&lt;/span&gt;

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Train the model&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Training the model ....&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    losses, accuracies = main_train(dataset, transformer, args.epochs, &lt;span class=&quot;ansi-blue-fg&quot;&gt;100&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Save the while model&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Save the entire model to a HDF5 file&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Saving the model ....&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    transformer.save_weights(os.path.join(args.sm_model_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;), overwrite=&lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;, save_format=&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#transformer.save_weights(args.sm_model_dir, overwrite=True, save_format=&amp;#39;tf&amp;#39;)&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Save the parameters used to construct the model&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Saving the model parameters&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    model_info_path = os.path.join(args.output_data_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;model_info.pth&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(model_info_path, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;wb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        model_info = {
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;vocab_size_enc&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: num_words_inputs,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;vocab_size_dec&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: num_words_output,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;sos_token_input&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: sos_token_input,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;eos_token_input&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: eos_token_input,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;sos_token_output&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: sos_token_output,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;eos_token_output&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: eos_token_output,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: args.n_layers,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: args.d_model,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;ffn_dim&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: args.ffn_dim,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: args.n_heads,
            &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;drop_rate&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;: args.dropout_rate
        }
        pickle.dump(model_info, f)
          
	&lt;span class=&quot;ansi-white-fg&quot;&gt;# Save the tokenizers with the vocabularies&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Saving the dictionaries ....&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    vocabulary_in = os.path.join(args.output_data_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;in_vocab.pkl&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(vocabulary_in, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;wb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        pickle.dump(tokenizer_inputs, f)

    vocabulary_out = os.path.join(args.output_data_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;out_vocab.pkl&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(vocabulary_out, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;wb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        pickle.dump(tokenizer_outputs, f)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Our source code needs the tensorflow_dataset library and it is not include in the Tensorflow 2.1. container image provided by SageMaker. To solve this issue we explicitly install it in our train.py file using the command &lt;code&gt;subprocess.check_call([sys.executable, &quot;-q&quot;, &quot;-m&quot;, &quot;pip&quot;, &quot;install&quot;, package])&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Create-a-training-job-using-the-TensorFlow-estimator&quot;&gt;Create a training job using the &lt;code&gt;TensorFlow&lt;/code&gt; estimator&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-a-training-job-using-the-TensorFlow-estimator&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The &lt;code&gt;sagemaker.tensorflow.TensorFlow&lt;/code&gt; estimator handles locating the script mode container where the model will run, uploading your script or source code to a S3 location and creating a SageMaker training job. Let's call out a couple important parameters here:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;source_dir&lt;/code&gt;and &lt;code&gt;entry_point&lt;/code&gt;, the folder with the source code and the file to run the training.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;framework_version&lt;/code&gt; is the tensorflow version we want to run our code.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;py_version&lt;/code&gt; is set to &lt;code&gt;'py3'&lt;/code&gt; to indicate that we are using script mode since legacy mode supports only Python 2. Though Python 2 will be deprecated soon, you can use script mode with Python 2 by setting &lt;code&gt;py_version&lt;/code&gt; to &lt;code&gt;'py2'&lt;/code&gt; and &lt;code&gt;script_mode&lt;/code&gt; to &lt;code&gt;True&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;code_location&lt;/code&gt; is a S3 folder URI where the &lt;code&gt;source_dir&lt;/code&gt; will be upload. When the instace starts the content of that folder will be downloaded to a local path, &lt;code&gt;opt/ml/code&lt;/code&gt;. The &lt;code&gt;entry_point&lt;/code&gt;, our main code or function, has to be included in that folder.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;output_path&lt;/code&gt; is the S3 path where all the outputs of our training job will be uploaded when the training ends. In our example we will upload to this S3 folder the local content in the folders &lt;code&gt;SM_MODEL_DIR&lt;/code&gt; and &lt;code&gt;SM_OUTPUT_DATA_DIR&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;the &lt;code&gt;checkpoint_local_path&lt;/code&gt;and &lt;code&gt;checkpoint_s3_uri&lt;/code&gt; parameters will be explained in the next section &lt;strong&gt;&quot;Resume training from a checkpoint&quot;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;script_mode = True&lt;/code&gt; to set script mode. &lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker.tensorflow&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TensorFlow&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Uncomment the type of instance to use&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;ml.m4.4xlarge&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ml.p2.xlarge&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;local&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Another important parameter of our Tensorflow estimator is the &lt;code&gt;instance_type&lt;/code&gt; that is the type of &quot;virtual machine&quot; where the container will run. The values we play around in this project are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;local: The container will run locally on the notebook instance. this is very useful to debug or verify that our estimator definition is correct and the train.py runs successfully. It is much more faster to run the container locally, the start up time for a remote instance is too long when you are coding and debugging.&lt;/li&gt;
&lt;li&gt;ml.mX.Yxlarge: It is a CPU instance, when you are running your code for a short train, maybe for validation purposes. Check AWS documentation for a list of alternative instance.&lt;/li&gt;
&lt;li&gt;ml.p2.xlarge: This instance use a GPU and it is the preferred one when you want to launch a long running training.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When running in local mode, some estimator functionalities are not available like uploading the checkpoints to S3 and its parameters should not be defined.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Finally we want to mention the definition of metrics. Using a dictionary, we can define a metric name and the regular expression to extract its value from the messages the training script writes on the logs or the stdout during training. Later we can see those metrics in the SageMaker console. We show you how to do it in a following section.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define the metrics to search for&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;metric_definitions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Regex&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Loss ([0-9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.]+)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Regex&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Accuracy ([0-9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.]+)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, we can define the estimator:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the Tensorflow estimator using a Tensorflow 2.1 container&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TensorFlow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train.py&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;source_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;instance_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;framework_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;2.1.0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;py_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;py3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;output_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;code_location&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;base_job_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tf-transformer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;script_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;c1&quot;&gt;#checkpoint_local_path = &amp;#39;ckpt&amp;#39;, #Use default value /opt/ml/checkpoint&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;checkpoint_s3_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;metric_definitions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metric_definitions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                       &lt;span class=&quot;n&quot;&gt;hyperparameters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;epochs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;nsamples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;resume&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;train_file&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;spa.txt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;non_breaking_in&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nonbreaking_prefix.en&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;non_breaking_out&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nonbreaking_prefix.es&amp;#39;&lt;/span&gt;
                       &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Start-the-training-job:-fit&quot;&gt;Start the training job: &lt;code&gt;fit&lt;/code&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Start-the-training-job:-fit&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;To start a training job, we call &lt;code&gt;estimator.fit&lt;/code&gt; method with the a few parameter values.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;An S3 location is used here as the input. &lt;code&gt;fit&lt;/code&gt; creates a default channel named &lt;code&gt;'training'&lt;/code&gt;, which points to this S3 location. In the training script we can access the training data from the local location stored in &lt;code&gt;SM_CHANNEL_TRAINING&lt;/code&gt;. &lt;code&gt;fit&lt;/code&gt; accepts a couple other types of input as well. See the API doc &lt;a href=&quot;https://sagemaker.readthedocs.io/en/stable/estimators.html#sagemaker.estimator.EstimatorBase.fit&quot;&gt;here&lt;/a&gt; for details.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;job_name&lt;/code&gt; the name for the training job.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;experiment_config&lt;/code&gt; the dictionary with the name of the experiment and trial to attach this job to.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;When training starts, the TensorFlow container executes &lt;code&gt;train.py&lt;/code&gt;, passing &lt;code&gt;hyperparameters&lt;/code&gt; and &lt;code&gt;model_dir&lt;/code&gt; from the estimator as script arguments. Because we didn't explicitly define it, &lt;code&gt;model_dir&lt;/code&gt; defaults to &lt;code&gt;s3://&amp;lt;DEFAULT_BUCKET&amp;gt;/&amp;lt;TRAINING_JOB_NAME&amp;gt;/model&lt;/code&gt;, so the script execution is as follows:&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;python train.py --model_dir s3://&amp;lt;DEFAULT_BUCKET&amp;gt;/&amp;lt;TRAINING_JOB_NAME&amp;gt;/model --epochs&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt; --nsamples&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5000&lt;/span&gt; ...
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When training is complete, the training job will upload the saved model and other output artifacts to S3.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the job name and show it&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;%Y-%m-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-%H-%M-%S&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gmtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;tf-transformer-single-gpu-2020-11-12-12-25-30
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Calling fit to train a model with TensorFlow 2.1 scroipt.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Call the fit method to launch the training job&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;experiment_config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiment_config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;INFO:sagemaker:Creating training-job with name: tf-transformer-single-gpu-2020-11-12-12-25-30
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;2020-11-12 12:25:33 Starting - Starting the training job...
2020-11-12 12:25:39 Starting - Launching requested ML instances......
2020-11-12 12:26:52 Starting - Preparing the instances for training.........
2020-11-12 12:28:30 Downloading - Downloading input data
2020-11-12 12:28:30 Training - Downloading the training image...........&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 12:30:19,406 sagemaker-containers INFO     Imported framework sagemaker_tensorflow_container.training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 12:30:19,885 sagemaker-containers INFO     Invoking user script
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Training Env:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;{
    &amp;#34;additional_framework_parameters&amp;#34;: {},
    &amp;#34;channel_input_dirs&amp;#34;: {
        &amp;#34;training&amp;#34;: &amp;#34;/opt/ml/input/data/training&amp;#34;
    },
    &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;,
    &amp;#34;framework_module&amp;#34;: &amp;#34;sagemaker_tensorflow_container.training:main&amp;#34;,
    &amp;#34;hosts&amp;#34;: [
        &amp;#34;algo-1&amp;#34;
    ],
    &amp;#34;hyperparameters&amp;#34;: {
        &amp;#34;resume&amp;#34;: false,
        &amp;#34;non_breaking_out&amp;#34;: &amp;#34;nonbreaking_prefix.es&amp;#34;,
        &amp;#34;nsamples&amp;#34;: 60000,
        &amp;#34;train_file&amp;#34;: &amp;#34;spa.txt&amp;#34;,
        &amp;#34;model_dir&amp;#34;: &amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model&amp;#34;,
        &amp;#34;non_breaking_in&amp;#34;: &amp;#34;nonbreaking_prefix.en&amp;#34;,
        &amp;#34;epochs&amp;#34;: 8
    },
    &amp;#34;input_config_dir&amp;#34;: &amp;#34;/opt/ml/input/config&amp;#34;,
    &amp;#34;input_data_config&amp;#34;: {
        &amp;#34;training&amp;#34;: {
            &amp;#34;TrainingInputMode&amp;#34;: &amp;#34;File&amp;#34;,
            &amp;#34;S3DistributionType&amp;#34;: &amp;#34;FullyReplicated&amp;#34;,
            &amp;#34;RecordWrapperType&amp;#34;: &amp;#34;None&amp;#34;
        }
    },
    &amp;#34;input_dir&amp;#34;: &amp;#34;/opt/ml/input&amp;#34;,
    &amp;#34;is_master&amp;#34;: true,
    &amp;#34;job_name&amp;#34;: &amp;#34;tf-transformer-single-gpu-2020-11-12-12-25-30&amp;#34;,
    &amp;#34;log_level&amp;#34;: 20,
    &amp;#34;master_hostname&amp;#34;: &amp;#34;algo-1&amp;#34;,
    &amp;#34;model_dir&amp;#34;: &amp;#34;/opt/ml/model&amp;#34;,
    &amp;#34;module_dir&amp;#34;: &amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/source/sourcedir.tar.gz&amp;#34;,
    &amp;#34;module_name&amp;#34;: &amp;#34;train&amp;#34;,
    &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;,
    &amp;#34;num_cpus&amp;#34;: 4,
    &amp;#34;num_gpus&amp;#34;: 1,
    &amp;#34;output_data_dir&amp;#34;: &amp;#34;/opt/ml/output/data&amp;#34;,
    &amp;#34;output_dir&amp;#34;: &amp;#34;/opt/ml/output&amp;#34;,
    &amp;#34;output_intermediate_dir&amp;#34;: &amp;#34;/opt/ml/output/intermediate&amp;#34;,
    &amp;#34;resource_config&amp;#34;: {
        &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;,
        &amp;#34;hosts&amp;#34;: [
            &amp;#34;algo-1&amp;#34;
        ],
        &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;
    },
    &amp;#34;user_entry_point&amp;#34;: &amp;#34;train.py&amp;#34;&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;}
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Environment variables:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HOSTS=[&amp;#34;algo-1&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NETWORK_INTERFACE_NAME=eth0&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HPS={&amp;#34;epochs&amp;#34;:8,&amp;#34;model_dir&amp;#34;:&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model&amp;#34;,&amp;#34;non_breaking_in&amp;#34;:&amp;#34;nonbreaking_prefix.en&amp;#34;,&amp;#34;non_breaking_out&amp;#34;:&amp;#34;nonbreaking_prefix.es&amp;#34;,&amp;#34;nsamples&amp;#34;:60000,&amp;#34;resume&amp;#34;:false,&amp;#34;train_file&amp;#34;:&amp;#34;spa.txt&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ENTRY_POINT=train.py&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_PARAMS={}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_RESOURCE_CONFIG={&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DATA_CONFIG={&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DATA_DIR=/opt/ml/output/data&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNELS=[&amp;#34;training&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CURRENT_HOST=algo-1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_NAME=train&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_LOG_LEVEL=20&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_MODULE=sagemaker_tensorflow_container.training:main&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DIR=/opt/ml/input&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_CONFIG_DIR=/opt/ml/input/config&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DIR=/opt/ml/output&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_CPUS=4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_GPUS=1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODEL_DIR=/opt/ml/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_DIR=s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/source/sourcedir.tar.gz&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_TRAINING_ENV={&amp;#34;additional_framework_parameters&amp;#34;:{},&amp;#34;channel_input_dirs&amp;#34;:{&amp;#34;training&amp;#34;:&amp;#34;/opt/ml/input/data/training&amp;#34;},&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;framework_module&amp;#34;:&amp;#34;sagemaker_tensorflow_container.training:main&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;hyperparameters&amp;#34;:{&amp;#34;epochs&amp;#34;:8,&amp;#34;model_dir&amp;#34;:&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model&amp;#34;,&amp;#34;non_breaking_in&amp;#34;:&amp;#34;nonbreaking_prefix.en&amp;#34;,&amp;#34;non_breaking_out&amp;#34;:&amp;#34;nonbreaking_prefix.es&amp;#34;,&amp;#34;nsamples&amp;#34;:60000,&amp;#34;resume&amp;#34;:false,&amp;#34;train_file&amp;#34;:&amp;#34;spa.txt&amp;#34;},&amp;#34;input_config_dir&amp;#34;:&amp;#34;/opt/ml/input/config&amp;#34;,&amp;#34;input_data_config&amp;#34;:{&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}},&amp;#34;input_dir&amp;#34;:&amp;#34;/opt/ml/input&amp;#34;,&amp;#34;is_master&amp;#34;:true,&amp;#34;job_name&amp;#34;:&amp;#34;tf-transformer-single-gpu-2020-11-12-12-25-30&amp;#34;,&amp;#34;log_level&amp;#34;:20,&amp;#34;master_hostname&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;model_dir&amp;#34;:&amp;#34;/opt/ml/model&amp;#34;,&amp;#34;module_dir&amp;#34;:&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/source/sourcedir.tar.gz&amp;#34;,&amp;#34;module_name&amp;#34;:&amp;#34;train&amp;#34;,&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;,&amp;#34;num_cpus&amp;#34;:4,&amp;#34;num_gpus&amp;#34;:1,&amp;#34;output_data_dir&amp;#34;:&amp;#34;/opt/ml/output/data&amp;#34;,&amp;#34;output_dir&amp;#34;:&amp;#34;/opt/ml/output&amp;#34;,&amp;#34;output_intermediate_dir&amp;#34;:&amp;#34;/opt/ml/output/intermediate&amp;#34;,&amp;#34;resource_config&amp;#34;:{&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;},&amp;#34;user_entry_point&amp;#34;:&amp;#34;train.py&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ARGS=[&amp;#34;--epochs&amp;#34;,&amp;#34;8&amp;#34;,&amp;#34;--model_dir&amp;#34;,&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model&amp;#34;,&amp;#34;--non_breaking_in&amp;#34;,&amp;#34;nonbreaking_prefix.en&amp;#34;,&amp;#34;--non_breaking_out&amp;#34;,&amp;#34;nonbreaking_prefix.es&amp;#34;,&amp;#34;--nsamples&amp;#34;,&amp;#34;60000&amp;#34;,&amp;#34;--resume&amp;#34;,&amp;#34;False&amp;#34;,&amp;#34;--train_file&amp;#34;,&amp;#34;spa.txt&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNEL_TRAINING=/opt/ml/input/data/training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_RESUME=false&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_NON_BREAKING_OUT=nonbreaking_prefix.es&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_NSAMPLES=60000&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_TRAIN_FILE=spa.txt&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_MODEL_DIR=s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_NON_BREAKING_IN=nonbreaking_prefix.en&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_EPOCHS=8&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;PYTHONPATH=/opt/ml/code:/usr/local/bin:/usr/lib/python36.zip:/usr/lib/python3.6:/usr/lib/python3.6/lib-dynload:/usr/local/lib/python3.6/dist-packages:/usr/lib/python3/dist-packages
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Invoking script with the following command:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/usr/bin/python3 train.py --epochs 8 --model_dir s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model --non_breaking_in nonbreaking_prefix.en --non_breaking_out nonbreaking_prefix.es --nsamples 60000 --resume False --train_file spa.txt

&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting tensorflow_datasets
  Downloading tensorflow_datasets-4.1.0-py3-none-any.whl (3.6 MB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: absl-py in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (0.9.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting importlib-resources; python_version &amp;lt; &amp;#34;3.9&amp;#34;
  Downloading importlib_resources-3.3.0-py2.py3-none-any.whl (26 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting tensorflow-metadata
  Downloading tensorflow_metadata-0.25.0-py3-none-any.whl (44 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.14.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.18.1)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting typing-extensions; python_version &amp;lt; &amp;#34;3.8&amp;#34;
  Downloading typing_extensions-3.7.4.3-py3-none-any.whl (22 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting tqdm
  Downloading tqdm-4.51.0-py2.py3-none-any.whl (70 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting dill
  Downloading dill-0.3.3-py2.py3-none-any.whl (81 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: requests&amp;gt;=2.19.0 in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (2.22.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting promise
  Downloading promise-2.3.tar.gz (19 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting future
  Downloading future-0.18.2.tar.gz (829 kB)&lt;/span&gt;

2020-11-12 12:30:13 Training - Training image download completed. Training in progress.&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: termcolor in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.1.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting dataclasses; python_version &amp;lt; &amp;#34;3.7&amp;#34;
  Downloading dataclasses-0.7-py3-none-any.whl (18 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: protobuf&amp;gt;=3.6.1 in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (3.11.3)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting attrs&amp;gt;=18.1.0
  Downloading attrs-20.3.0-py2.py3-none-any.whl (49 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: zipp&amp;gt;=0.4; python_version &amp;lt; &amp;#34;3.8&amp;#34; in /usr/local/lib/python3.6/dist-packages (from importlib-resources; python_version &amp;lt; &amp;#34;3.9&amp;#34;-&amp;gt;tensorflow_datasets) (3.1.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting googleapis-common-protos&amp;lt;2,&amp;gt;=1.52.0
  Downloading googleapis_common_protos-1.52.0-py2.py3-none-any.whl (100 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&amp;lt;1.26,&amp;gt;=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (1.25.9)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: certifi&amp;gt;=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (2020.4.5.1)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: chardet&amp;lt;3.1.0,&amp;gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (3.0.4)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: idna&amp;lt;2.9,&amp;gt;=2.5 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (2.8)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: setuptools in /usr/local/lib/python3.6/dist-packages (from protobuf&amp;gt;=3.6.1-&amp;gt;tensorflow_datasets) (46.1.3)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Building wheels for collected packages: promise, future
  Building wheel for promise (setup.py): started
  Building wheel for promise (setup.py): finished with status &amp;#39;done&amp;#39;
  Created wheel for promise: filename=promise-2.3-py3-none-any.whl size=21495 sha256=5bfcc52cd449f0f077404e249a0252f083de1fc5a2950e1eede78546f1c0db75
  Stored in directory: /root/.cache/pip/wheels/59/9a/1d/3f1afbbb5122d0410547bf9eb50955f4a7a98e53a6d8b99bd1
  Building wheel for future (setup.py): started&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Building wheel for future (setup.py): finished with status &amp;#39;done&amp;#39;
  Created wheel for future: filename=future-0.18.2-py3-none-any.whl size=491058 sha256=3897bdb5f59ddb7663519e2e63bce2390ad30686d73d2202d0e0a5b80c16db55
  Stored in directory: /root/.cache/pip/wheels/6e/9c/ed/4499c9865ac1002697793e0ae05ba6be33553d098f3347fb94&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully built promise future&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Installing collected packages: importlib-resources, googleapis-common-protos, tensorflow-metadata, typing-extensions, tqdm, dill, promise, future, dataclasses, attrs, tensorflow-datasets&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully installed attrs-20.3.0 dataclasses-0.7 dill-0.3.3 future-0.18.2 googleapis-common-protos-1.52.0 importlib-resources-3.3.0 promise-2.3 tensorflow-datasets-4.1.0 tensorflow-metadata-0.25.0 tqdm-4.51.0 typing-extensions-3.7.4.3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;WARNING: You are using pip version 20.0.2; however, version 20.2.4 is available.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;You should consider upgrading via the &amp;#39;/usr/bin/python3 -m pip install --upgrade pip&amp;#39; command.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/opt/ml/model s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-12-25-30/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Get the train data&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Tokenize the input and output data and create the vocabularies&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Input vocab:  11460&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Output vocab:  9383&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Creating the checkpoint ...&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Training the model ....&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 0 Loss 4.2718 Accuracy 0.0000&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 100 Loss 4.4878 Accuracy 0.0394&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 200 Loss 4.4102 Accuracy 0.0553&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 300 Loss 4.2828 Accuracy 0.0607&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 400 Loss 4.1153 Accuracy 0.0634&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 500 Loss 3.9366 Accuracy 0.0683&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 600 Loss 3.7706 Accuracy 0.0784&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 700 Loss 3.6183 Accuracy 0.0863&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 800 Loss 3.4776 Accuracy 0.0956&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 900 Loss 3.3528 Accuracy 0.1038&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 1 in /opt/ml/checkpoints/ckpt-1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 2&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 0 Loss 2.1816 Accuracy 0.1741&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 100 Loss 2.2265 Accuracy 0.1770&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 200 Loss 2.2128 Accuracy 0.1801&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 300 Loss 2.1806 Accuracy 0.1838&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 400 Loss 2.1546 Accuracy 0.1871&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 500 Loss 2.1287 Accuracy 0.1900&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 600 Loss 2.1031 Accuracy 0.1930&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 700 Loss 2.0789 Accuracy 0.1955&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 800 Loss 2.0580 Accuracy 0.1981&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 900 Loss 2.0352 Accuracy 0.2006&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 2 in /opt/ml/checkpoints/ckpt-2&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 0 Loss 1.7447 Accuracy 0.2243&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 100 Loss 1.7695 Accuracy 0.2276&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 200 Loss 1.7488 Accuracy 0.2286&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 300 Loss 1.7416 Accuracy 0.2300&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 400 Loss 1.7318 Accuracy 0.2310&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 500 Loss 1.7194 Accuracy 0.2320&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 600 Loss 1.7094 Accuracy 0.2330&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 700 Loss 1.6998 Accuracy 0.2340&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 800 Loss 1.6888 Accuracy 0.2351&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 900 Loss 1.6789 Accuracy 0.2361&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 3 in /opt/ml/checkpoints/ckpt-3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 0 Loss 1.5789 Accuracy 0.2511&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 100 Loss 1.5092 Accuracy 0.2525&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 200 Loss 1.5019 Accuracy 0.2533&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 300 Loss 1.4967 Accuracy 0.2539&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 400 Loss 1.4913 Accuracy 0.2550&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 500 Loss 1.4852 Accuracy 0.2563&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 600 Loss 1.4726 Accuracy 0.2577&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 700 Loss 1.4652 Accuracy 0.2592&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 800 Loss 1.4583 Accuracy 0.2604&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 900 Loss 1.4501 Accuracy 0.2620&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 4 in /opt/ml/checkpoints/ckpt-4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 5&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 0 Loss 1.3142 Accuracy 0.2902&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 100 Loss 1.2605 Accuracy 0.2823&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 200 Loss 1.2688 Accuracy 0.2834&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 300 Loss 1.2683 Accuracy 0.2847&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 400 Loss 1.2640 Accuracy 0.2859&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 500 Loss 1.2610 Accuracy 0.2869&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 600 Loss 1.2564 Accuracy 0.2884&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 700 Loss 1.2507 Accuracy 0.2897&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 800 Loss 1.2449 Accuracy 0.2912&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 900 Loss 1.2371 Accuracy 0.2925&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 5 in /opt/ml/checkpoints/ckpt-5&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 6&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 0 Loss 0.9893 Accuracy 0.3114&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 100 Loss 1.0413 Accuracy 0.3140&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 200 Loss 1.0532 Accuracy 0.3141&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 300 Loss 1.0536 Accuracy 0.3152&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 400 Loss 1.0589 Accuracy 0.3157&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 500 Loss 1.0589 Accuracy 0.3163&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 600 Loss 1.0593 Accuracy 0.3168&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 700 Loss 1.0561 Accuracy 0.3173&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 800 Loss 1.0541 Accuracy 0.3180&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 6 Batch 900 Loss 1.0528 Accuracy 0.3186&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 6 in /opt/ml/checkpoints/ckpt-6&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 7&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 0 Loss 1.0120 Accuracy 0.3504&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 100 Loss 0.9046 Accuracy 0.3345&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 200 Loss 0.9157 Accuracy 0.3350&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 300 Loss 0.9213 Accuracy 0.3342&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 400 Loss 0.9231 Accuracy 0.3343&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 500 Loss 0.9272 Accuracy 0.3341&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 600 Loss 0.9302 Accuracy 0.3342&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 700 Loss 0.9300 Accuracy 0.3343&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 800 Loss 0.9303 Accuracy 0.3346&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 7 Batch 900 Loss 0.9315 Accuracy 0.3348&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 7 in /opt/ml/checkpoints/ckpt-7&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 8&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 0 Loss 0.8039 Accuracy 0.3315&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 100 Loss 0.8109 Accuracy 0.3457&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 200 Loss 0.8154 Accuracy 0.3461&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 300 Loss 0.8282 Accuracy 0.3454&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 400 Loss 0.8360 Accuracy 0.3459&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 500 Loss 0.8395 Accuracy 0.3456&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 600 Loss 0.8426 Accuracy 0.3453&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 700 Loss 0.8456 Accuracy 0.3451&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 800 Loss 0.8459 Accuracy 0.3451&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 8 Batch 900 Loss 0.8486 Accuracy 0.3448&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 8 in /opt/ml/checkpoints/ckpt-8&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving the model ....&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving the model parameters&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving the dictionaries ....&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 13:15:31,672 sagemaker_tensorflow_container.training WARNING  Your model will NOT be servable with SageMaker TensorFlow Serving container. The model artifact was not saved in the TensorFlow SavedModel directory structure:&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;https://www.tensorflow.org/guide/saved_model#structure_of_a_savedmodel_directory&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 13:15:31,672 sagemaker-containers INFO     Reporting training SUCCESS&lt;/span&gt;

2020-11-12 13:15:47 Uploading - Uploading generated training model
2020-11-12 13:15:55 Completed - Training job completed
Training seconds: 2867
Billable seconds: 2867
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Save the experiment, then you can view it and its trials from SageMaker Studio&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Save the trial&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;single_gpu_trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Save the experiment&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Experiment(sagemaker_boto_client=&amp;lt;botocore.client.SageMaker object at 0x7f3f90c75d68&amp;gt;,experiment_name=&amp;#39;tf-transformer&amp;#39;,experiment_arn=&amp;#39;arn:aws:sagemaker:us-east-1:223817798831:experiment/tf-transformer&amp;#39;,display_name=&amp;#39;tf-transformer&amp;#39;,description=&amp;#39;Experiment to track trainings on my tensorflow Transformer Eng-Spa&amp;#39;,creation_time=datetime.datetime(2020, 11, 8, 17, 0, 49, 116000, tzinfo=tzlocal()),created_by={},last_modified_time=datetime.datetime(2020, 11, 12, 11, 50, 27, 732000, tzinfo=tzlocal()),last_modified_by={},response_metadata={&amp;#39;RequestId&amp;#39;: &amp;#39;862d03a0-abf6-4215-a759-2ddcc4f622fd&amp;#39;, &amp;#39;HTTPStatusCode&amp;#39;: 200, &amp;#39;HTTPHeaders&amp;#39;: {&amp;#39;x-amzn-requestid&amp;#39;: &amp;#39;862d03a0-abf6-4215-a759-2ddcc4f622fd&amp;#39;, &amp;#39;content-type&amp;#39;: &amp;#39;application/x-amz-json-1.1&amp;#39;, &amp;#39;content-length&amp;#39;: &amp;#39;86&amp;#39;, &amp;#39;date&amp;#39;: &amp;#39;Thu, 12 Nov 2020 13:17:51 GMT&amp;#39;}, &amp;#39;RetryAttempts&amp;#39;: 0})&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Show-metrics-from-SageMaker-Console&quot;&gt;Show metrics from SageMaker Console&lt;a class=&quot;anchor-link&quot; href=&quot;#Show-metrics-from-SageMaker-Console&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;You can monitor the metrics that a training job emits in real time in the &lt;strong&gt;CloudWatch console&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Open the CloudWatch console at &lt;a href=&quot;https://console.aws.amazon.com/cloudwatch/&quot;&gt;https://console.aws.amazon.com/cloudwatch/&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Choose Metrics, then choose /aws/sagemaker/TrainingJobs.&lt;/li&gt;
&lt;li&gt;Choose TrainingJobName.&lt;/li&gt;
&lt;li&gt;On the All metrics tab, choose the names of the training metrics that you want to monitor.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Another option is to monitor the metrics by using the &lt;strong&gt;SageMaker console&lt;/strong&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Open the SageMaker console at &lt;a href=&quot;https://console.aws.amazon.com/sagemaker/&quot;&gt;https://console.aws.amazon.com/sagemaker/&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Choose Training jobs, then choose the training job whose metrics you want to see.&lt;/li&gt;
&lt;li&gt;Choose TrainingJobName.&lt;/li&gt;
&lt;li&gt;In the Monitor section, you can review the graphs of instance utilization and algorithm metrics&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;It is a simple way to check how your model is &quot;learning&quot; during the training stage.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Restore-a-training-job-and-download-the-trained-model&quot;&gt;Restore a training job and download the trained model&lt;a class=&quot;anchor-link&quot; href=&quot;#Restore-a-training-job-and-download-the-trained-model&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;At this point, we have a trained model stored in S3. But we are interested in making some predictions with it.&lt;/p&gt;
&lt;p&gt;After you train your model, you can deploy it using Amazon SageMaker to get predictions in any of the following ways:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;To set up a persistent endpoint to get one prediction at a time, use SageMaker hosting services.&lt;/li&gt;
&lt;li&gt;To get predictions for an entire dataset, use SageMaker batch transform.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But in this notebook we do not cover this feature because sometimes we are more interested in reloading our model in a new notebook to apply an evaluation method or study its parameters or gradients. So, here we are going to download the model artifacts from S3 and load them to an &quot;empty&quot; model instance.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Attach-a-previous-training-job&quot;&gt;Attach a previous training job&lt;a class=&quot;anchor-link&quot; href=&quot;#Attach-a-previous-training-job&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;If we have just trained a model using our estimator variable in this notebook execution, we can skip this step. But probably you trained your model for hours and now you need to restore your estimator variable from a previous training job. Check for the training job you want to restore the model in SageMaker console, copy the name and paste it in the next section of code. And then you call the &lt;code&gt;attach&lt;/code&gt; method of the estimator object and now you can continue to work with our training job.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can skip the next cell if the previous estimator.fit command was executed&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker.tensorflow&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TensorFlow&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set the training job you want to attach to the estimator object&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Use this option if the training job was not trained in this execution&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;my_training_job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tf-transformer-single-gpu-2020-11-12-18-36-15&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# In case, when the training job have been trained in this execution, we can retrive the data from the job_name variable&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#my_training_job_name = job_name&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Attach the estimator to the selected training job&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TensorFlow&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_training_job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;
2020-11-12 19:13:13 Starting - Preparing the instances for training
2020-11-12 19:13:13 Downloading - Downloading input data
2020-11-12 19:13:13 Training - Training image download completed. Training in progress.
2020-11-12 19:13:13 Uploading - Uploading generated training model
2020-11-12 19:13:13 Completed - Training job completed
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the job_name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_training_job&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Job name where the model will be restored: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_training_job&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Job name where the model will be restored:  tf-transformer-single-gpu-2020-11-12-18-36-15
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Dir of model data: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Dir of output data: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Buck name: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Dir of model data:  s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/output/model.tar.gz
Dir of output data:  s3://edumunozsala-ml-sagemaker/transformer-nmt
Buck name:  edumunozsala-ml-sagemaker
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Download-the-trained-model&quot;&gt;Download the trained model&lt;a class=&quot;anchor-link&quot; href=&quot;#Download-the-trained-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The estimator object variable &lt;code&gt;model_data&lt;/code&gt; points to the &lt;code&gt;model.tar.gz&lt;/code&gt; file which contains the saved model. And the other output files from our model that we need to rebuild and tokenize or detokenize the sentences can be found in the S3 folder &lt;code&gt;output_path/output/output.tar.gz&lt;/code&gt;. We can download both files and unzip them.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the model and the output path in S3 to download the data &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;init_model_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;s3://&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_model_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_model_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s3_output_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_model_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/output/output.tar.gz&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Dir to download traned model: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3_model_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Dir to download model outputs: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s3_output_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Dir to download traned model:  transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/output/model.tar.gz
Dir to download model outputs:  transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/output/output.tar.gz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainedmodel_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_model_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s3_output_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, extract the information out from the model.tar.gz file return by the training job in SageMaker:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;tar -zxvf &lt;span class=&quot;nv&quot;&gt;$trainedmodel_path&lt;/span&gt;/model.tar.gz
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;transformer.data-00000-of-00002
transformer.index
transformer.data-00001-of-00002
checkpoint
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Extract the files from output.tar.gz without recreating the directory structure, all files will be extracted to the working directory&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;tar -xvzf &lt;span class=&quot;nv&quot;&gt;$output_data_path&lt;/span&gt;/output.tar.gz #--strip-components&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;out_vocab.pkl
model_info.pth
in_vocab.pkl
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Import-the-tensorflow-model-and-load-the-model&quot;&gt;Import the tensorflow model and load the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Import-the-tensorflow-model-and-load-the-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We import the &lt;code&gt;model.py&lt;/code&gt; file with our model definition but we only have the weights of the model, so we need to rebuild it. The model parameters where saved during training in the &lt;code&gt;model_info.pth&lt;/code&gt;, we just need to read that file and use the parameters to initiate an empty instance of the model. And then we can load the weights, &lt;code&gt;load_weights()&lt;/code&gt; into that instance.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;train.model&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Transformer&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Read the parameters from a dictionary&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Model parameters&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#Create an instance of the Transforer model and load the saved model to th&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size_enc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;vocab_size_enc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;vocab_size_dec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;vocab_size_dec&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;d_model&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;n_layers&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ffn_dim&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;n_heads&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;drop_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#Load the saved model&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# To do: Use variable to store the model name and pass it in as a hyperparameter of the estimator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;transformer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Model parameters {&amp;#39;vocab_size_enc&amp;#39;: 11460, &amp;#39;vocab_size_dec&amp;#39;: 9383, &amp;#39;sos_token_input&amp;#39;: [11458], &amp;#39;eos_token_input&amp;#39;: [11459], &amp;#39;sos_token_output&amp;#39;: [9381], &amp;#39;eos_token_output&amp;#39;: [9382], &amp;#39;n_layers&amp;#39;: 4, &amp;#39;d_model&amp;#39;: 64, &amp;#39;ffn_dim&amp;#39;: 128, &amp;#39;n_heads&amp;#39;: 8, &amp;#39;drop_rate&amp;#39;: 0.1}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;tensorflow.python.training.tracking.util.CheckpointLoadStatus at 0x7f00f7b045f8&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Make-some-predictions&quot;&gt;Make some predictions&lt;a class=&quot;anchor-link&quot; href=&quot;#Make-some-predictions&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;And now everything is ready to make prediction with our trained model:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Import the &lt;code&gt;predict.py&lt;/code&gt; file with the functions to make a prediction and to translate a sentence. The code was described in the original post.&lt;/li&gt;
&lt;li&gt;Read the files and load the tokenizer for the input and output sentences&lt;/li&gt;
&lt;li&gt;Call to &lt;code&gt;traslate&lt;/code&gt; function with the model, the tokenizers, the &lt;code&gt;sos&lt;/code&gt;and &lt;code&gt;eos&lt;/code&gt; tokens, the sentence to translate and the max length of the output. It returns the predicted sentence detokenize, a plain text, with the translation. &lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Install the library necessary to tokenize the sentences&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install tensorflow-datasets
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Collecting tensorflow-datasets
  Downloading tensorflow_datasets-4.1.0-py3-none-any.whl (3.6 MB)
     |████████████████████████████████| 3.6 MB 13.8 MB/s eta 0:00:01
Requirement already satisfied: tqdm in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (4.42.1)
Collecting dataclasses; python_version &amp;lt; &amp;#34;3.7&amp;#34;
  Downloading dataclasses-0.8-py3-none-any.whl (19 kB)
Collecting importlib-resources; python_version &amp;lt; &amp;#34;3.9&amp;#34;
  Downloading importlib_resources-3.3.0-py2.py3-none-any.whl (26 kB)
Requirement already satisfied: attrs&amp;gt;=18.1.0 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (19.3.0)
Requirement already satisfied: protobuf&amp;gt;=3.6.1 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (3.8.0)
Collecting tensorflow-metadata
  Downloading tensorflow_metadata-0.25.0-py3-none-any.whl (44 kB)
     |████████████████████████████████| 44 kB 5.6 MB/s  eta 0:00:01
Requirement already satisfied: termcolor in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (1.1.0)
Requirement already satisfied: absl-py in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (0.11.0)
Collecting promise
  Downloading promise-2.3.tar.gz (19 kB)
Collecting dill
  Downloading dill-0.3.3-py2.py3-none-any.whl (81 kB)
     |████████████████████████████████| 81 kB 17.5 MB/s eta 0:00:01
Requirement already satisfied: future in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (0.18.2)
Requirement already satisfied: numpy in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (1.18.1)
Requirement already satisfied: requests&amp;gt;=2.19.0 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (2.22.0)
Requirement already satisfied: six in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from tensorflow-datasets) (1.14.0)
Collecting typing-extensions; python_version &amp;lt; &amp;#34;3.8&amp;#34;
  Downloading typing_extensions-3.7.4.3-py3-none-any.whl (22 kB)
Requirement already satisfied: zipp&amp;gt;=0.4; python_version &amp;lt; &amp;#34;3.8&amp;#34; in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from importlib-resources; python_version &amp;lt; &amp;#34;3.9&amp;#34;-&amp;gt;tensorflow-datasets) (2.2.0)
Requirement already satisfied: setuptools in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from protobuf&amp;gt;=3.6.1-&amp;gt;tensorflow-datasets) (45.2.0.post20200210)
Collecting googleapis-common-protos&amp;lt;2,&amp;gt;=1.52.0
  Downloading googleapis_common_protos-1.52.0-py2.py3-none-any.whl (100 kB)
     |████████████████████████████████| 100 kB 18.2 MB/s ta 0:00:01
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&amp;lt;1.26,&amp;gt;=1.21.1 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow-datasets) (1.25.10)
Requirement already satisfied: idna&amp;lt;2.9,&amp;gt;=2.5 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow-datasets) (2.8)
Requirement already satisfied: chardet&amp;lt;3.1.0,&amp;gt;=3.0.2 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow-datasets) (3.0.4)
Requirement already satisfied: certifi&amp;gt;=2017.4.17 in /home/ec2-user/anaconda3/envs/tensorflow2_p36/lib/python3.6/site-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow-datasets) (2020.6.20)
Building wheels for collected packages: promise
  Building wheel for promise (setup.py) ... done
  Created wheel for promise: filename=promise-2.3-py3-none-any.whl size=21495 sha256=1eeea3a689d00d6a15f97c89d4bd92ce7c63d62bbca77357f5aa7be67b44d3af
  Stored in directory: /home/ec2-user/.cache/pip/wheels/59/9a/1d/3f1afbbb5122d0410547bf9eb50955f4a7a98e53a6d8b99bd1
Successfully built promise
&lt;span class=&quot;ansi-red-fg&quot;&gt;ERROR: tensorflow-metadata 0.25.0 has requirement absl-py&amp;lt;0.11,&amp;gt;=0.9, but you&amp;#39;ll have absl-py 0.11.0 which is incompatible.&lt;/span&gt;
Installing collected packages: dataclasses, importlib-resources, googleapis-common-protos, tensorflow-metadata, promise, dill, typing-extensions, tensorflow-datasets
Successfully installed dataclasses-0.8 dill-0.3.3 googleapis-common-protos-1.52.0 importlib-resources-3.3.0 promise-2.3 tensorflow-datasets-4.1.0 tensorflow-metadata-0.25.0 typing-extensions-3.7.4.3
&lt;span class=&quot;ansi-yellow-fg&quot;&gt;WARNING: You are using pip version 20.0.2; however, version 20.2.4 is available.
You should consider upgrading via the &amp;#39;/home/ec2-user/anaconda3/envs/tensorflow2_p36/bin/python -m pip install --upgrade pip&amp;#39; command.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;serve.predict&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow_datasets&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tfds&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Load the input and output tokenizer or vocabularis used in the training. We need them to encode and decode the sentences&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Read the parameters from a dictionary&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#model_info_path = os.path.join(model_dir, &amp;#39;model_info.pth&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_vocab_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_vocab_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;you should pay for it.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sos_token_input&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;eos_token_input&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sos_token_output&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;eos_token_output&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: you should pay for it.
Output sentence: Deberías pagar por ello.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;This is a really powerful method!&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sos_token_input&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;eos_token_input&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sos_token_output&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;eos_token_output&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: This is a really powerful method!
Output sentence: ¡Esto es un montón de las carreras de las ocho!
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Resume-training-from-a-checkpoint&quot;&gt;Resume training from a checkpoint&lt;a class=&quot;anchor-link&quot; href=&quot;#Resume-training-from-a-checkpoint&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Sometimes we need to stop our training, and maybe do some research in the performance or reallocate more resources to continue with the project. But when it is done, we need to resume the training, restoring the model and the optimizer states and continue for some more epochs to achieve a final trained model with a better performance.&lt;/p&gt;
&lt;p&gt;To help with that scenario, the &lt;code&gt;checkpoint_local_path&lt;/code&gt;and &lt;code&gt;checkpoint_s3_uri&lt;/code&gt; estimator parameters are much relevant. The first one is the local path, inside the container, that the algorithm writes its checkpoints to. SageMaker will persist all files under this path to &lt;code&gt;checkpoint_s3_uri&lt;/code&gt; continually during training. On job startup the reverse happens - data from the s3 location is downloaded to this path before the algorithm is started. If the path is unset then SageMaker assumes the checkpoints will be provided under &lt;code&gt;/opt/ml/checkpoints/&lt;/code&gt;. Using this feature we can resume training from the last checkpoint (or a previous one).&lt;/p&gt;
&lt;p&gt;For this purpose, we set the model parameter &lt;code&gt;resume = True&lt;/code&gt; and &lt;code&gt;fit&lt;/code&gt; the estimator to execute another training.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Load the experiment and trial created in a previous run or create a new one:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the experiment name&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tf-transformer&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the trial name &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;single-gpu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;trial_comp_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;single-gpu-training-job&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;tags&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Key&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;my-experiments&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Value&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;transformerEngSpa1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# create the experiment if it doesn&amp;#39;t exist&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Load the experiment&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ResourceNotFound&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Create the experiment&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;c1&quot;&gt;# create the trial if it doesn&amp;#39;t exist&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;trial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Load the trial&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;Exception&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ResourceNotFound&amp;quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ex&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;trial&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Create the trial&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Load the experiment
Load the trial
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the configuration parameters for the experiment&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;experiment_config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ExperimentName&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experiment_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                       &lt;span class=&quot;s1&quot;&gt;&amp;#39;TrialName&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;s1&quot;&gt;&amp;#39;TrialComponentDisplayName&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;trial_comp_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Create an Estimator for a TensorFlow 2.1 model and set the parameter &lt;code&gt;--resume&lt;/code&gt; to True to force the model to restore the latest checkpoint and resume training for the number of epochs selected&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;ml.m5.xlarge&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;ml.m4.4xlarge&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ml.p2.xlarge&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;local&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define the metrics to search for&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;metric_definitions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Regex&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Loss ([0-9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.]+)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Name&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Regex&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Accuracy ([0-9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.]+)&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create an estimator with the hyperparameter resume = True&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TensorFlow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train.py&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;source_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;instance_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;framework_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;2.1.0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;py_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;py3&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;output_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;code_location&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;base_job_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tf-transformer&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;script_mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;checkpoint_s3_uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                       &lt;span class=&quot;n&quot;&gt;metric_definitions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metric_definitions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                       &lt;span class=&quot;n&quot;&gt;hyperparameters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;epochs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;nsamples&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;60000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;resume&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;train_file&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;spa.txt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;non_breaking_in&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nonbreaking_prefix.en&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;non_breaking_out&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nonbreaking_prefix.es&amp;#39;&lt;/span&gt;
                       &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the job name and show it&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trial_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strftime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;%Y-%m-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%d&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-%H-%M-%S&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gmtime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;tf-transformer-single-gpu-2020-11-12-18-36-15
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Fit or train the model from the latest checkpoint&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_data_uri&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
              &lt;span class=&quot;n&quot;&gt;experiment_config&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;experiment_config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;INFO:sagemaker:Creating training-job with name: tf-transformer-single-gpu-2020-11-12-18-36-15
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;2020-11-12 18:36:34 Starting - Starting the training job...
2020-11-12 18:36:39 Starting - Launching requested ML instances......
2020-11-12 18:37:59 Starting - Preparing the instances for training.........
2020-11-12 18:39:13 Downloading - Downloading input data......
2020-11-12 18:40:24 Training - Downloading the training image......
2020-11-12 18:41:37 Training - Training image download completed. Training in progress...&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 18:41:43,057 sagemaker-containers INFO     Imported framework sagemaker_tensorflow_container.training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 18:41:43,563 sagemaker-containers INFO     Invoking user script
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Training Env:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;{
    &amp;#34;additional_framework_parameters&amp;#34;: {},
    &amp;#34;channel_input_dirs&amp;#34;: {
        &amp;#34;training&amp;#34;: &amp;#34;/opt/ml/input/data/training&amp;#34;
    },
    &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;,
    &amp;#34;framework_module&amp;#34;: &amp;#34;sagemaker_tensorflow_container.training:main&amp;#34;,
    &amp;#34;hosts&amp;#34;: [
        &amp;#34;algo-1&amp;#34;
    ],
    &amp;#34;hyperparameters&amp;#34;: {
        &amp;#34;resume&amp;#34;: true,
        &amp;#34;non_breaking_out&amp;#34;: &amp;#34;nonbreaking_prefix.es&amp;#34;,
        &amp;#34;nsamples&amp;#34;: 60000,
        &amp;#34;train_file&amp;#34;: &amp;#34;spa.txt&amp;#34;,
        &amp;#34;model_dir&amp;#34;: &amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model&amp;#34;,
        &amp;#34;non_breaking_in&amp;#34;: &amp;#34;nonbreaking_prefix.en&amp;#34;,
        &amp;#34;epochs&amp;#34;: 5
    },
    &amp;#34;input_config_dir&amp;#34;: &amp;#34;/opt/ml/input/config&amp;#34;,
    &amp;#34;input_data_config&amp;#34;: {
        &amp;#34;training&amp;#34;: {
            &amp;#34;TrainingInputMode&amp;#34;: &amp;#34;File&amp;#34;,
            &amp;#34;S3DistributionType&amp;#34;: &amp;#34;FullyReplicated&amp;#34;,
            &amp;#34;RecordWrapperType&amp;#34;: &amp;#34;None&amp;#34;
        }
    },
    &amp;#34;input_dir&amp;#34;: &amp;#34;/opt/ml/input&amp;#34;,
    &amp;#34;is_master&amp;#34;: true,
    &amp;#34;job_name&amp;#34;: &amp;#34;tf-transformer-single-gpu-2020-11-12-18-36-15&amp;#34;,
    &amp;#34;log_level&amp;#34;: 20,
    &amp;#34;master_hostname&amp;#34;: &amp;#34;algo-1&amp;#34;,
    &amp;#34;model_dir&amp;#34;: &amp;#34;/opt/ml/model&amp;#34;,
    &amp;#34;module_dir&amp;#34;: &amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/source/sourcedir.tar.gz&amp;#34;,
    &amp;#34;module_name&amp;#34;: &amp;#34;train&amp;#34;,
    &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;,
    &amp;#34;num_cpus&amp;#34;: 4,
    &amp;#34;num_gpus&amp;#34;: 1,
    &amp;#34;output_data_dir&amp;#34;: &amp;#34;/opt/ml/output/data&amp;#34;,
    &amp;#34;output_dir&amp;#34;: &amp;#34;/opt/ml/output&amp;#34;,
    &amp;#34;output_intermediate_dir&amp;#34;: &amp;#34;/opt/ml/output/intermediate&amp;#34;,
    &amp;#34;resource_config&amp;#34;: {
        &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;,
        &amp;#34;hosts&amp;#34;: [
            &amp;#34;algo-1&amp;#34;
        ],
        &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;
    },
    &amp;#34;user_entry_point&amp;#34;: &amp;#34;train.py&amp;#34;&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;}
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Environment variables:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HOSTS=[&amp;#34;algo-1&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NETWORK_INTERFACE_NAME=eth0&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HPS={&amp;#34;epochs&amp;#34;:5,&amp;#34;model_dir&amp;#34;:&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model&amp;#34;,&amp;#34;non_breaking_in&amp;#34;:&amp;#34;nonbreaking_prefix.en&amp;#34;,&amp;#34;non_breaking_out&amp;#34;:&amp;#34;nonbreaking_prefix.es&amp;#34;,&amp;#34;nsamples&amp;#34;:60000,&amp;#34;resume&amp;#34;:true,&amp;#34;train_file&amp;#34;:&amp;#34;spa.txt&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ENTRY_POINT=train.py&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_PARAMS={}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_RESOURCE_CONFIG={&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DATA_CONFIG={&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DATA_DIR=/opt/ml/output/data&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNELS=[&amp;#34;training&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CURRENT_HOST=algo-1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_NAME=train&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_LOG_LEVEL=20&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_MODULE=sagemaker_tensorflow_container.training:main&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DIR=/opt/ml/input&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_CONFIG_DIR=/opt/ml/input/config&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DIR=/opt/ml/output&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_CPUS=4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_GPUS=1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODEL_DIR=/opt/ml/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_DIR=s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/source/sourcedir.tar.gz&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_TRAINING_ENV={&amp;#34;additional_framework_parameters&amp;#34;:{},&amp;#34;channel_input_dirs&amp;#34;:{&amp;#34;training&amp;#34;:&amp;#34;/opt/ml/input/data/training&amp;#34;},&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;framework_module&amp;#34;:&amp;#34;sagemaker_tensorflow_container.training:main&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;hyperparameters&amp;#34;:{&amp;#34;epochs&amp;#34;:5,&amp;#34;model_dir&amp;#34;:&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model&amp;#34;,&amp;#34;non_breaking_in&amp;#34;:&amp;#34;nonbreaking_prefix.en&amp;#34;,&amp;#34;non_breaking_out&amp;#34;:&amp;#34;nonbreaking_prefix.es&amp;#34;,&amp;#34;nsamples&amp;#34;:60000,&amp;#34;resume&amp;#34;:true,&amp;#34;train_file&amp;#34;:&amp;#34;spa.txt&amp;#34;},&amp;#34;input_config_dir&amp;#34;:&amp;#34;/opt/ml/input/config&amp;#34;,&amp;#34;input_data_config&amp;#34;:{&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}},&amp;#34;input_dir&amp;#34;:&amp;#34;/opt/ml/input&amp;#34;,&amp;#34;is_master&amp;#34;:true,&amp;#34;job_name&amp;#34;:&amp;#34;tf-transformer-single-gpu-2020-11-12-18-36-15&amp;#34;,&amp;#34;log_level&amp;#34;:20,&amp;#34;master_hostname&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;model_dir&amp;#34;:&amp;#34;/opt/ml/model&amp;#34;,&amp;#34;module_dir&amp;#34;:&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/source/sourcedir.tar.gz&amp;#34;,&amp;#34;module_name&amp;#34;:&amp;#34;train&amp;#34;,&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;,&amp;#34;num_cpus&amp;#34;:4,&amp;#34;num_gpus&amp;#34;:1,&amp;#34;output_data_dir&amp;#34;:&amp;#34;/opt/ml/output/data&amp;#34;,&amp;#34;output_dir&amp;#34;:&amp;#34;/opt/ml/output&amp;#34;,&amp;#34;output_intermediate_dir&amp;#34;:&amp;#34;/opt/ml/output/intermediate&amp;#34;,&amp;#34;resource_config&amp;#34;:{&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;},&amp;#34;user_entry_point&amp;#34;:&amp;#34;train.py&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ARGS=[&amp;#34;--epochs&amp;#34;,&amp;#34;5&amp;#34;,&amp;#34;--model_dir&amp;#34;,&amp;#34;s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model&amp;#34;,&amp;#34;--non_breaking_in&amp;#34;,&amp;#34;nonbreaking_prefix.en&amp;#34;,&amp;#34;--non_breaking_out&amp;#34;,&amp;#34;nonbreaking_prefix.es&amp;#34;,&amp;#34;--nsamples&amp;#34;,&amp;#34;60000&amp;#34;,&amp;#34;--resume&amp;#34;,&amp;#34;True&amp;#34;,&amp;#34;--train_file&amp;#34;,&amp;#34;spa.txt&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNEL_TRAINING=/opt/ml/input/data/training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_RESUME=true&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_NON_BREAKING_OUT=nonbreaking_prefix.es&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_NSAMPLES=60000&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_TRAIN_FILE=spa.txt&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_MODEL_DIR=s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_NON_BREAKING_IN=nonbreaking_prefix.en&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_EPOCHS=5&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;PYTHONPATH=/opt/ml/code:/usr/local/bin:/usr/lib/python36.zip:/usr/lib/python3.6:/usr/lib/python3.6/lib-dynload:/usr/local/lib/python3.6/dist-packages:/usr/lib/python3/dist-packages
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Invoking script with the following command:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/usr/bin/python3 train.py --epochs 5 --model_dir s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model --non_breaking_in nonbreaking_prefix.en --non_breaking_out nonbreaking_prefix.es --nsamples 60000 --resume True --train_file spa.txt

&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting tensorflow_datasets
  Downloading tensorflow_datasets-4.1.0-py3-none-any.whl (3.6 MB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: termcolor in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.1.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting future
  Downloading future-0.18.2.tar.gz (829 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting dill
  Downloading dill-0.3.3-py2.py3-none-any.whl (81 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.18.1)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: requests&amp;gt;=2.19.0 in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (2.22.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting tensorflow-metadata
  Downloading tensorflow_metadata-0.25.0-py3-none-any.whl (44 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.14.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: protobuf&amp;gt;=3.6.1 in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (3.11.3)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting attrs&amp;gt;=18.1.0
  Downloading attrs-20.3.0-py2.py3-none-any.whl (49 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting tqdm
  Downloading tqdm-4.51.0-py2.py3-none-any.whl (70 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting importlib-resources; python_version &amp;lt; &amp;#34;3.9&amp;#34;
  Downloading importlib_resources-3.3.0-py2.py3-none-any.whl (26 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting typing-extensions; python_version &amp;lt; &amp;#34;3.8&amp;#34;
  Downloading typing_extensions-3.7.4.3-py3-none-any.whl (22 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting promise
  Downloading promise-2.3.tar.gz (19 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting dataclasses; python_version &amp;lt; &amp;#34;3.7&amp;#34;
  Downloading dataclasses-0.7-py3-none-any.whl (18 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: absl-py in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (0.9.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: certifi&amp;gt;=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (2020.4.5.1)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&amp;lt;1.26,&amp;gt;=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (1.25.9)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: chardet&amp;lt;3.1.0,&amp;gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (3.0.4)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: idna&amp;lt;2.9,&amp;gt;=2.5 in /usr/local/lib/python3.6/dist-packages (from requests&amp;gt;=2.19.0-&amp;gt;tensorflow_datasets) (2.8)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting googleapis-common-protos&amp;lt;2,&amp;gt;=1.52.0
  Downloading googleapis_common_protos-1.52.0-py2.py3-none-any.whl (100 kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: setuptools in /usr/local/lib/python3.6/dist-packages (from protobuf&amp;gt;=3.6.1-&amp;gt;tensorflow_datasets) (46.1.3)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied: zipp&amp;gt;=0.4; python_version &amp;lt; &amp;#34;3.8&amp;#34; in /usr/local/lib/python3.6/dist-packages (from importlib-resources; python_version &amp;lt; &amp;#34;3.9&amp;#34;-&amp;gt;tensorflow_datasets) (3.1.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Building wheels for collected packages: future, promise
  Building wheel for future (setup.py): started&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Building wheel for future (setup.py): finished with status &amp;#39;done&amp;#39;
  Created wheel for future: filename=future-0.18.2-py3-none-any.whl size=491058 sha256=8ee2ee7f64812eaeae88dab477913a1a102478229062751714d6baea811887ea
  Stored in directory: /root/.cache/pip/wheels/6e/9c/ed/4499c9865ac1002697793e0ae05ba6be33553d098f3347fb94
  Building wheel for promise (setup.py): started&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Building wheel for promise (setup.py): finished with status &amp;#39;done&amp;#39;
  Created wheel for promise: filename=promise-2.3-py3-none-any.whl size=21495 sha256=6a50141ea6170764a8fea8f42c9875da12c21f0528a4b72678a6a683e10860ce
  Stored in directory: /root/.cache/pip/wheels/59/9a/1d/3f1afbbb5122d0410547bf9eb50955f4a7a98e53a6d8b99bd1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully built future promise&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Installing collected packages: future, dill, googleapis-common-protos, tensorflow-metadata, attrs, tqdm, importlib-resources, typing-extensions, promise, dataclasses, tensorflow-datasets&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully installed attrs-20.3.0 dataclasses-0.7 dill-0.3.3 future-0.18.2 googleapis-common-protos-1.52.0 importlib-resources-3.3.0 promise-2.3 tensorflow-datasets-4.1.0 tensorflow-metadata-0.25.0 tqdm-4.51.0 typing-extensions-3.7.4.3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;WARNING: You are using pip version 20.0.2; however, version 20.2.4 is available.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;You should consider upgrading via the &amp;#39;/usr/bin/python3 -m pip install --upgrade pip&amp;#39; command.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/opt/ml/model s3://edumunozsala-ml-sagemaker/transformer-nmt/tf-transformer-single-gpu-2020-11-12-18-36-15/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Get the train data&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Tokenize the input and output data and create the vocabularies&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Input vocab:  11460&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Output vocab:  9383&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Creating the checkpoint ...&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Last checkpoint restored.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Training the model ....&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 0 Loss 0.7465 Accuracy 0.3560&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 100 Loss 0.7395 Accuracy 0.3574&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 200 Loss 0.7495 Accuracy 0.3559&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 300 Loss 0.7552 Accuracy 0.3551&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 400 Loss 0.7641 Accuracy 0.3543&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 500 Loss 0.7689 Accuracy 0.3541&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 600 Loss 0.7754 Accuracy 0.3538&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 700 Loss 0.7815 Accuracy 0.3535&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 800 Loss 0.7849 Accuracy 0.3531&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 1 Batch 900 Loss 0.7891 Accuracy 0.3530&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 1 in /opt/ml/checkpoints/ckpt-9&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 2&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 0 Loss 0.7752 Accuracy 0.3616&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 100 Loss 0.6931 Accuracy 0.3643&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 200 Loss 0.7000 Accuracy 0.3629&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 300 Loss 0.7107 Accuracy 0.3621&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 400 Loss 0.7174 Accuracy 0.3610&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 500 Loss 0.7233 Accuracy 0.3607&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 600 Loss 0.7292 Accuracy 0.3600&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 700 Loss 0.7342 Accuracy 0.3596&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 800 Loss 0.7372 Accuracy 0.3593&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 2 Batch 900 Loss 0.7408 Accuracy 0.3589&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 2 in /opt/ml/checkpoints/ckpt-10&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 0 Loss 0.6146 Accuracy 0.3627&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 100 Loss 0.6685 Accuracy 0.3686&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 200 Loss 0.6670 Accuracy 0.3673&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 300 Loss 0.6770 Accuracy 0.3664&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 400 Loss 0.6802 Accuracy 0.3660&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 500 Loss 0.6862 Accuracy 0.3653&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 600 Loss 0.6914 Accuracy 0.3650&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 700 Loss 0.6965 Accuracy 0.3646&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 800 Loss 0.7007 Accuracy 0.3640&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 3 Batch 900 Loss 0.7036 Accuracy 0.3641&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 3 in /opt/ml/checkpoints/ckpt-11&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 0 Loss 0.6168 Accuracy 0.3884&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 100 Loss 0.6127 Accuracy 0.3745&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 200 Loss 0.6317 Accuracy 0.3719&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 300 Loss 0.6400 Accuracy 0.3723&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 400 Loss 0.6493 Accuracy 0.3705&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 500 Loss 0.6558 Accuracy 0.3700&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 600 Loss 0.6614 Accuracy 0.3694&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 700 Loss 0.6638 Accuracy 0.3692&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 800 Loss 0.6702 Accuracy 0.3686&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 4 Batch 900 Loss 0.6730 Accuracy 0.3683&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 4 in /opt/ml/checkpoints/ckpt-12&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Starting epoch 5&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 0 Loss 0.6213 Accuracy 0.3940&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 100 Loss 0.5858 Accuracy 0.3795&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 200 Loss 0.6030 Accuracy 0.3767&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 300 Loss 0.6117 Accuracy 0.3760&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 400 Loss 0.6194 Accuracy 0.3754&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 500 Loss 0.6277 Accuracy 0.3743&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 600 Loss 0.6322 Accuracy 0.3742&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 700 Loss 0.6369 Accuracy 0.3733&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 800 Loss 0.6421 Accuracy 0.3726&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch 5 Batch 900 Loss 0.6467 Accuracy 0.3722&lt;/span&gt;

2020-11-12 19:13:13 Uploading - Uploading generated training model
2020-11-12 19:13:13 Completed - Training job completed
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving checkpoint for epoch 5 in /opt/ml/checkpoints/ckpt-13&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving the model ....&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving the model parameters&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Saving the dictionaries ....&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 19:13:02,312 sagemaker_tensorflow_container.training WARNING  Your model will NOT be servable with SageMaker TensorFlow Serving container. The model artifact was not saved in the TensorFlow SavedModel directory structure:&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;https://www.tensorflow.org/guide/saved_model#structure_of_a_savedmodel_directory&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-11-12 19:13:02,312 sagemaker-containers INFO     Reporting training SUCCESS&lt;/span&gt;
Training seconds: 2040
Billable seconds: 2040
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;And this training job will return a new trained model, you can download to make prediction as we describe in a former section.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Delete-the-experiment&quot;&gt;Delete the experiment&lt;a class=&quot;anchor-link&quot; href=&quot;#Delete-the-experiment&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_experiment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delete_all&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;--force&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;References&quot;&gt;References&lt;a class=&quot;anchor-link&quot; href=&quot;#References&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;Referencias for experiment and trial
&lt;a href=&quot;https://github.com/shashankprasanna/sagemaker-training-tutorial/blob/master/sagemaker-training-tutorial.ipynb&quot;&gt;https://github.com/shashankprasanna/sagemaker-training-tutorial/blob/master/sagemaker-training-tutorial.ipynb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Attention is all you need: Discovering the Transformer model</title><link href="https://edumunozsala.github.io/BlogEms/transformer/attention/encoder-decoder/tensorflow%202/2020/10/29/Transformer-NMT-en-es.html" rel="alternate" type="text/html" title="Attention is all you need: Discovering the Transformer model" /><published>2020-10-29T00:00:00-05:00</published><updated>2020-10-29T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/transformer/attention/encoder-decoder/tensorflow%202/2020/10/29/Transformer-NMT-en-es</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/transformer/attention/encoder-decoder/tensorflow%202/2020/10/29/Transformer-NMT-en-es.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-29-Transformer-NMT-en-es.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Neural-machine-traslation-using-a-Transformer-model&quot;&gt;Neural machine traslation using a Transformer model&lt;a class=&quot;anchor-link&quot; href=&quot;#Neural-machine-traslation-using-a-Transformer-model&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this notebook we will describe and demystify the relevant artifacts in the paper &quot;Attention is all you need&quot; (Vaswani, Ashish &amp;amp; Shazeer, Noam &amp;amp; Parmar, Niki &amp;amp; Uszkoreit, Jakob &amp;amp; Jones, Llion &amp;amp; Gomez, Aidan &amp;amp; Kaiser, Lukasz &amp;amp; Polosukhin, Illia. (2017)). This paper was a more advanced step in the use of the attention mechanism being the main basis for a model called Transformer. The most famous current models that are emerging in NLP tasks consist of dozens of transformers or some of their variants, for example, GPT-3 or BERT.&lt;/p&gt;
&lt;p&gt;Attention is all you need: &lt;a href=&quot;https://arxiv.org/pdf/1706.03762.pdf&quot;&gt;https://arxiv.org/pdf/1706.03762.pdf&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We will describe the components of this model, analyze their operation and build a simple model that we will apply to a small-scale NMT problem (Neural Machine Translation). To read more about the problem that we will address and to know how the basic attention mechanism works, I recommend you to read my previous  post &lt;a href=&quot;https://medium.com/better-programming/a-guide-on-the-encoder-decoder-model-and-the-attention-mechanism-401c836e2cdb&quot;&gt; &quot;A Guide on the Encoder-Decoder Model and the Attention Mechanism&quot;&lt;/a&gt; and check the &lt;a href=&quot;https://github.com/edumunozsala/NMT-encoder-decoder-Attention&quot;&gt; repository&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/transformer.jpg&quot; alt=&quot;Alt&quot; title=&quot;title Picture by Vinson Tan from Pixabay&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;Why-we-need-Transformer?&quot;&gt;Why we need Transformer?&lt;a class=&quot;anchor-link&quot; href=&quot;#Why-we-need-Transformer?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In sequence-to-sequence treatment problems such as the neural machine translation, the initial proposals were based on the use of RNNs in an encoder-decoder architecture. These architectures presented a great limitation when working with long sequences, their ability to retain information from the first elements was lost when new elements were incorporated into the sequence. In the encoder, the hidden state in every step is associated with a certain word in the input sentence, the more recent. Therefore, if the decoder only accesses the last hidden state of the decoder, it will lose relevant information about the first elements of the sequence. Then to deal with this limitation, a new concept were introduced &lt;strong&gt;the attention mechanism&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Instead of paying attention to the last state of the encoder as is usually done with the RNNs, in each step of the decoder we look at all the states of the encoder, being able to access information about all the elements of the input sequence. This is what attention does, it extracts information from the whole sequence, a weighted sum of all the past encoder states. This allows the decoder to assign greater weight or importance to a certain element of the input for each element of the output. Learning in every step to focus in the right element of the input to predict the next output element.&lt;/p&gt;
&lt;p&gt;But this approach continues to have an important limitation, each sequence must be treated one at a time. Both the encoder and the decoder have to wait till the completion of t-1 steps to process at 't'th step. So when dealing with huge corpus &lt;strong&gt;it is very time consuming and computationally inefficient&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Loading-the-libraries&quot;&gt;Loading the libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-libraries&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Load and install, if necessary, the python libraries we will use along this notebook. We force to import Tensorflow version 2, if it is available.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;math&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gc&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline 

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;google.colab&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drive&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;tensorflow_version&lt;/span&gt; 2.x
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow_datasets&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tfds&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.text&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.sequence&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Setting some parameters and hyperparameters for our model&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Parameters for our model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;INPUT_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;input&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NUM_SAMPLES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80000&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#40000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MAX_VOCAB_SIZE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;BATCH_SIZE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Batch size for training.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Number of epochs to train for.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MAX_LENGTH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Global parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/content/drive&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;My Drive/datasets/eng_spa_translations&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_folder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;My Drive/Projects/Transformer_NMT/ckpt/&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;spa.txt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variable for data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_filenamepath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Both train and test set are in the root data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;The-dataset-and-text-processing&quot;&gt;The dataset and text processing&lt;a class=&quot;anchor-link&quot; href=&quot;#The-dataset-and-text-processing&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;For this exercise we will use pairs of simple sentences, the source in English and target in Spanish, from the Tatoeba project where people contribute adding translations every day. This is the &lt;a href=&quot;http://www.manythings.org/anki/&quot;&gt;link&lt;/a&gt; to some traslations in different languages. There you can download the Spanish - English spa_eng.zip file, it contains 124457 pairs of sentences.&lt;/p&gt;
&lt;p&gt;We use a list of &lt;strong&gt;non breaking prefixes&lt;/strong&gt; to avoid the tokenizer to split or break words including that prefixes. Inm our example we do not want to remove some the dot for some well-konw words.You can find non breaking prefixes for many languages in the Kaggle website:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.kaggle.com/nltkdata/nonbreaking-prefixes/activity&quot;&gt;https://www.kaggle.com/nltkdata/nonbreaking-prefixes/activity&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;The text sentences are almost clean, they are simple plain text, so we only need to remove dots that are not a end of sentence symbol and duplicated white spaces.&lt;/p&gt;
&lt;p&gt;The following functions will apply the cleaning mentioned previously:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;preprocess_text_nonbreaking&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corpus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefixes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Add the string $$$ before the non breaking prefixes&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# To avoid remove dots from some words&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefixes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;replace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;$$$&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Remove dots not at the end of a sentence&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;\.(?=[0-9]|[a-z]|[A-Z])&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.$$$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Remove the $$$ mark&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;\.\$\$\$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Rmove multiple white spaces&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;  +&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus_cleaned&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Loading-the-dataset&quot;&gt;Loading the dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-dataset&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Mount our Google Drive unit to access the datafiles from the notebook&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/content/drive&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Mounted at /content/drive
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Loading the list of non breaking prefixes for the english and the spanish sentences&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/nonbreaking_prefix.en&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
          &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_en&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/nonbreaking_prefix.es&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
          &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_es&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;non_breaking_prefix_en&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_en&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_prefix_en&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pref&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_en&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_prefix_es&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_es&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;non_breaking_prefix_es&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pref&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_es&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Load the dataset into a pandas dataframe and apply the preprocess function to the input and target columns.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Load the dataset: sentence in english, sentence in spanish &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_filenamepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;INPUT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usecols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
               &lt;span class=&quot;n&quot;&gt;nrows&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NUM_SAMPLES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Preprocess the input data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;INPUT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preprocess_text_nonbreaking&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_en&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Preprocess and include the end of sentence token to the target text&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preprocess_text_nonbreaking&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;non_breaking_prefix_es&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of sentences: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of sentences:  80000
[&amp;#39;Go.&amp;#39;, &amp;#39;Go.&amp;#39;, &amp;#39;Go.&amp;#39;, &amp;#39;Go.&amp;#39;, &amp;#39;Hi.&amp;#39;]
[&amp;#39;Ve.&amp;#39;, &amp;#39;Vete.&amp;#39;, &amp;#39;Vaya.&amp;#39;, &amp;#39;Váyase.&amp;#39;, &amp;#39;Hola.&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Delete the dataframe and release the memory (if it is possible)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Tokenize-the-text-data&quot;&gt;Tokenize the text data&lt;a class=&quot;anchor-link&quot; href=&quot;#Tokenize-the-text-data&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Next, let's see how to prepare the data for our model. It is very simple and the steps are the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Create the vocabulary from the corpus using Subword tokenization, breaking words into “subword units” - strings of characters like ing or eau - that allow the downstream model to make intelligent decisions on words it doesn’t recognize.&lt;/li&gt;
&lt;li&gt;Calculate the maximum length of the input and output sequences.&lt;/li&gt;
&lt;li&gt;Tokenize the data, convert the raw text into a sequence of integers. Once we define the vocabulary, we use the encode method to get the token for every word in the corpus.&lt;/li&gt;
&lt;li&gt;Remove sentences longer that the max length defined.&lt;/li&gt;
&lt;li&gt;Padding the sentences: we need to pad zeros at the end of the sequences so that all sequences have the same length. Otherwise, we won't be able train the model on batches&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;subword_tokenize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corpus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Create the vocabulary using Subword tokenization&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;tokenizer_corpus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tfds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deprecated&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SubwordTextEncoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;build_from_corpus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;corpus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_vocab_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Get the final vocab size, adding the eos and sos tokens&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_corpus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Set eos and sos token&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sos_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Tokenize the corpus&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sos_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_corpus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;corpus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Identify the index of the sentences longer than max length&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;idx_to_remove&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sent&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                 &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;#Pad the sentences&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preprocessing&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                       &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                       &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                       &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_corpus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx_to_remove&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Tokenize and pad the input sequences&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del_idx_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subword_tokenize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                                                                        &lt;span class=&quot;n&quot;&gt;MAX_VOCAB_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_LENGTH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tokenize and pad the outputs sequences&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;del_idx_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subword_tokenize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                                                                        &lt;span class=&quot;n&quot;&gt;MAX_VOCAB_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_LENGTH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Check the tokenize function&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[[14050  5483 13840 14051     0     0     0     0     0     0     0     0
      0     0     0]
 [14050  5483 13840 14051     0     0     0     0     0     0     0     0
      0     0     0]
 [14050  5483 13840 14051     0     0     0     0     0     0     0     0
      0     0     0]
 [14050  5483 13840 14051     0     0     0     0     0     0     0     0
      0     0     0]
 [14050  2180 13840 14051     0     0     0     0     0     0     0     0
      0     0     0]] [14050] [14051]
[[15568 10468 15358 15569     0     0     0     0     0     0     0     0
      0     0     0]
 [15568 10468   263 15358 15569     0     0     0     0     0     0     0
      0     0     0]
 [15568 10469 15358 15569     0     0     0     0     0     0     0     0
      0     0     0]
 [15568 14581 15358 15569     0     0     0     0     0     0     0     0
      0     0     0]
 [15568  2976 15358 15569     0     0     0     0     0     0     0     0
      0     0     0]] [15568] [15569]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Size of Input Vocabulary: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Size of Output Vocabulary: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Size of Input Vocabulary:  14052
Size of Output Vocabulary:  15570
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Create-the-batch-data-generator&quot;&gt;Create the batch data generator&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-batch-data-generator&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;Create a batch data generator: we want to train the model on batches, group of sentences, so we need to create a Dataset using the tf.data library and the function batch_on_slices on the input and output sequences.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define a dataset &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_tensor_slices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reshuffle_each_iteration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BATCH_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_remainder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefetch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;experimental&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AUTOTUNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Building-a-Transformer&quot;&gt;Building a Transformer&lt;a class=&quot;anchor-link&quot; href=&quot;#Building-a-Transformer&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;What-is-Transformer?&quot;&gt;What is Transformer?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-Transformer?&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;&quot;In this work we propose the Transformer, a model architecture eschewing recurrence and instead relying entirely on an attention mechanism to draw global dependencies between input and output. The Transformer allows for significantly more parallelization … the Transformer is the first transduction model relying entirely on self-attention to compute representations of its input and output without using sequence-aligned RNNs or convolution.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&quot;Attention is all you need&quot; paper&lt;/p&gt;
&lt;p&gt;The Transformer model extract  features for each word using a self-attention mechanism to figure out how important all the other words in the sentence are w.r.t. to the aforementioned word. And no recurrent units are used to obtain this features, they are just weighted sum and activations, so they can be very parallelizable and efficient.&lt;/p&gt;
&lt;p&gt;But We will dive deeper to understand what all this means.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Self-attention:-the-fundamental-operation&quot;&gt;Self-attention: the fundamental operation&lt;a class=&quot;anchor-link&quot; href=&quot;#Self-attention:-the-fundamental-operation&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;&lt;em&gt;&quot;Self-attention is a sequence-to-sequence operation: a sequence of vectors goes in, and a sequence of vectors comes out. Let's call the input vectors 𝐱1,𝐱2,…𝐱t and the corresponding output vectors 𝐲1,𝐲2,…,𝐲t. The vectors all have dimension k. To produce output vector 𝐲i, the self attention operation simply takes a weighted average over all the input vectors, the simplest option is the dot product.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Transformers from scratch by Peter Bloem&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;In the self-attention mechanism of our model we need to introduce three elements: Queries, Values and Keys&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Queries,-Keys-and-Values&quot;&gt;Queries, Keys and Values&lt;a class=&quot;anchor-link&quot; href=&quot;#Queries,-Keys-and-Values&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Every input vector is used in three different ways in the self-attention mechanism: the Query, the Key and the Value. In every role, it is compared to the others vectors to get its own output yi (Query), to get the j-th output yj (Key) and to compute each output vector once the weights have been established (Value).&lt;/p&gt;
&lt;p&gt;To obtain this roles, we need three weight matrices of dimensions k x k and compute three linear transformation for each xi:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/query_key_value.png&quot; alt=&quot;Alt&quot; title=&quot;title Transformers from scratch by Peter Bloem&quot; /&gt;&lt;/p&gt;
&lt;p&gt;These three matrices are usually known as K, Q and V, three learnable weight layers that are applied to the same encoded input. Consequently, as each of these three matrices come from the same input, we can apply the attention mechanism of the input vector with itself, a &quot;self-attention&quot;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Scale-dot-product-Attention&quot;&gt;Scale dot-product Attention&lt;a class=&quot;anchor-link&quot; href=&quot;#Scale-dot-product-Attention&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;The input consists of queries and keys of dimension dk, and values of dimension dv. We compute the dot products of the query with all keys, divide each by the square root of dk, and apply a softmax function to obtain the weights on the values.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&quot;Attention is all you need&quot; paper&lt;/p&gt;
&lt;p&gt;Then we use the Q, K and V matrices to calculate the attention scores. &lt;strong&gt;The scores measure how much focus to place on other places or words of the input sequence w.r.t a word at a certain position&lt;/strong&gt;. That is, the dot product of the query vector with the key vector of the respective word we're scoring. So, for position 1 we calculate the dot product (.) of q1 and k1, then q1 . k2, q1 . k3,… &lt;/p&gt;
&lt;p&gt;Next we apply the &quot;scaled&quot; factor to have more stable gradients. The softmax function can not work properly with large values, resulting in vanishing the gradient and slow down the learning. After &quot;softmaxing&quot; we multiply by the Value matrix to keep the values of the words we want to focus on and minimizing or removing the values for the irrelevant words (its value in V matrix should be very small).&lt;/p&gt;
&lt;p&gt;The formula for these operations is:&lt;/p&gt;
&lt;p&gt;$Attention(Q, K, V ) = \text{softmax}\left(\dfrac{QK^T}{\sqrt{d_k}}\right)V $&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;scaled_dot_product_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Calculate the dot product, QK_transpose&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;product&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transpose_b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Get the scale factor&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;keys_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Apply the scale factor to the dot product&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;scaled_product&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;product&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Apply masking when it is requiered&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;scaled_product&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# dot product with Values&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scaled_product&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Multi-Head-Attention&quot;&gt;Multi-Head Attention&lt;a class=&quot;anchor-link&quot; href=&quot;#Multi-Head-Attention&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;In the previous description the attention scores are focused on the whole sentence at a time, this would produce the same results even if two sentences contain the same words in a different order. Instead, we would like to attend to different segments of the words. We can give the self attention greater power of discrimination, &lt;strong&gt;by combining several self attention heads&lt;/strong&gt;, dividing the words vectors into a fixed number (h, number of heads) of chunks, and then self-attention is applied on the corresponding chunks, using Q, K and V sub-matrices.&lt;/p&gt;
&lt;p&gt;This produce h different output matrices of scores.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/dor_product_multihead.PNG&quot; alt=&quot;Alt&quot; title=&quot;title From Attention is all you need paper by Vaswani, et al., 2017&quot; /&gt;&lt;/p&gt;
&lt;p&gt;But the next layer (the Feed-Forward layer) is expecting just one matrix, a vector for each word, so after calculating the dot product of every head, we concat the output matrices and multiply them by an additional weights matrix $W_O$. This final matrix captures information from all the attention heads.&lt;/p&gt;
&lt;p&gt;$MultihHead(Q, K, V ) = \text{Concat}(head_1,...,head_n)W^O$&lt;/p&gt;
&lt;p&gt;where $head_i=Attention(QW_i^Q,QW_i^K,QW_i^V)$ and $i$ is the head index.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;assert&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Calculate the dimension of every head or projection&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the weight matrices for Q, K and V&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query_lin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_lin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_lin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the weight matrix for the output of the multi-head attention W0&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;final_lin&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;split_proj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# inputs: (batch_size, seq_length, d_model)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the dimension of the projections&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Split the input vectors&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;splited_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (batch_size, seq_length, nb_proj, d_proj)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;splited_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;perm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (batch_size, nb_proj, seq_length, d_proj)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the batch size&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the Query, Key and Value matrices&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;query_lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key_lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value_lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Split Q, K y V between the heads or projections&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_proj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_proj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split_proj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Apply the scaled dot product&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scaled_dot_product_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;queries&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the attention scores&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;perm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Concat the h heads or projections&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;concat_attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                      &lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Apply W0 to get the output of the multi-head attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;final_lin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Positional-Encoding&quot;&gt;Positional Encoding&lt;a class=&quot;anchor-link&quot; href=&quot;#Positional-Encoding&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We mentioned briefly that the order of the words in the sentence is an issue to solve in this model, because the network and the self-attention mechanism is permutation invariant. If we shuffle up the words in the input sentence, we get the same solutions. We need to create a representation of the position of the word in the sentence and add it to the word embedding.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;To this end, we add &quot;positional encodings&quot; to the input embeddings at the bottoms of the encoder and decoder stacks. The positional encodings have the same dimension as the embeddings, so that the two can be summed. There are many choices of positional encodings.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&quot;Attention is all you need&quot; paper&lt;/p&gt;
&lt;p&gt;So, we apply a function to map the position in the sentence to real valued vector. The network will learn how to use this information. Another approach would be to use a position embedding, similar to word embedding, coding every known position with a vector. It would requiere sentences of all accepted positions during training but positional encoding allow the model to extrapolate to sequence lengths longer than the ones encountered.&lt;/p&gt;
&lt;p&gt;In the paper a sinusoidal function is applied:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;$PE_{(pos,2i)} =\sin(pos/10000^{2i/dmodel})$&lt;/p&gt;
&lt;p&gt;$PE_{(pos,2i+1)} =\cos(pos/10000^{2i/dmodel})$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;get_angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# pos: (seq_length, 1) i: (1, d_model)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;power&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;10000.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;//&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (seq_length, d_model)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# input shape batch_size, seq_length, d_model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;seq_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;as_list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Calculate the angles given the input&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Calculate the positional encodings&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Expand the encodings with a new dimension&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pos_encoding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;angles&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;The-Encoder&quot;&gt;The Encoder&lt;a class=&quot;anchor-link&quot; href=&quot;#The-Encoder&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Now that all the main pieces of the model have been described we can introduce the encoder components. &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Positional encoding: Add the position encoding to the input embedding (our input words are transformed to embedding vectors). &lt;em&gt;&quot;The same weight matrix is shared between the two embedding layers (encoder and decoder) and the pre-softmax linear transformation. In the embedding layers, we multiply those weights by square root of the model dimension&quot;&lt;/em&gt; [1], ${\sqrt{d_{model}}}$.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;N = 6, identical layers, containing two sub-layers: a &lt;strong&gt;multi-head self-attention mechanism&lt;/strong&gt;, and a &lt;strong&gt;fully connected feed-forward network&lt;/strong&gt;. This FC layer is applied to each position separately and identically and consists of two linear transformations with a ReLU activation in between. But it is applied position-wise to the input, which means that the same neural network is applied to every single &quot;token&quot; vector belonging to the sentence sequence.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$FFN(x)= max(0,xW_1+b_1)W_2+b_2$$
&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;There is a residual connection around each sub-layer (attention and FC network) followed by a layer normalization.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;Normalization and residual connections are standard tricks used to help deep neural networks train faster and more accurately. The layer normalization is applied over the embedding dimension only.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Peter Bloem, &quot;Transformers from scratch&quot;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;The next figure will show the components detailed:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/encoder.PNG&quot; alt=&quot;Alt&quot; title=&quot;title The Ilustrated Transformer by Jay Alammar&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Keep in mind that &lt;strong&gt;only the vector from the last layer (6-th) is sent to the decoder&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;EncoderLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EncoderLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Hidden units of the feed forward component&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the number of projectios or heads&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Dropout rate&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Build the multihead layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_head_attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Layer Normalization&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNormalization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Fully connected feed forward layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn1_relu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;relu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Layer normalization&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNormalization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Forward pass of the multi-head attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_head_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                              &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                              &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                              &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call to the residual connection and layer normalization&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call to the FC layer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn1_relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call to residual connection and the layer normalization&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;encoder&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# The embedding layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Positional encoding layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_encoding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Stack of n layers of multi-head attention and FC&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EncoderLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
                           &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the embedding vectors&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Scale the embeddings by sqrt of d_model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Positional encodding&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the stacked layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;The-Decoder&quot;&gt;The Decoder&lt;a class=&quot;anchor-link&quot; href=&quot;#The-Decoder&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;The decoder share some components with the encoder but they are used in a different way to take into account the encoder output.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Positional encoding: Similar that the one in the encoder&lt;/li&gt;
&lt;li&gt;&lt;p&gt;N=6 identical layers, containing 3 three sublayers. First, the Masked Multi-head attention or &lt;strong&gt;masked causal attention&lt;/strong&gt; to prevent positions from attending to subsequent positions, hiding those features that belong to future states of the sequence. &quot;This masking, combined with fact that the output embeddings are offset by one position, ensures that the predictions for position i can depend only on the known outputs at positions less than i&quot; [1]. It is implemented setting to −∞ the values corresponding to the forbidden states in the softmax layer of the dot-product attention modules. The second component or &lt;strong&gt;&quot;encoder-decoder attention&quot;&lt;/strong&gt; performs multi-head attention over the output of the decoder, the Key and Value vectors come from the output of the encoder but the queries come from the previous decoder layer. &lt;em&gt;This allows every position in the decoder to attend over all positions in the input sequence&lt;/em&gt; [1]. And finally the fully-connected network.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The residual connection and layer normalization around each sub-layer, similar to the encoder.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/decoder.PNG&quot; alt=&quot;Alt&quot; title=&quot;title The Ilustrated Transformer by Jay Alammar&quot; /&gt;&lt;/p&gt;
&lt;p&gt;At the end of the N stacked decoders, the &lt;strong&gt;linear layer&lt;/strong&gt;, a fully-connected network, transforms the stacked outputs to a much larger vector, the &lt;em&gt;logits&lt;/em&gt;. The &lt;strong&gt;softmax layer&lt;/strong&gt; then turns those scores (logits) into probabilities (all positive, all add up to 1.0). The cell with the highest probability is chosen, and the word associated with it is produced as the output for this time step.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;DecoderLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DecoderLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Self multi head attention, causal attention&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_head_causal_attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNormalization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Multi head attention, encoder-decoder attention &lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_head_enc_dec_attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultiHeadAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNormalization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# Feed foward&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn1_relu&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;relu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LayerNormalization&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the masked causal attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_head_causal_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                &lt;span class=&quot;n&quot;&gt;mask_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Residual connection and layer normalization&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the encoder-decoder attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_head_enc_dec_attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                  &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                  &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                  &lt;span class=&quot;n&quot;&gt;mask_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Residual connection and layer normalization&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the Feed forward&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn1_relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ffn2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Residual connection and layer normalization&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;norm_3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;decoder&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Embedding layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Positional encoding layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_encoding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PositionalEncoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Stacked layers of multi-head attention and feed forward&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DecoderLayer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                        &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; 
                           &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the embedding vectors&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Scale by sqrt of d_model&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Positional encodding&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos_encoding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the stacked layers&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;](&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                         &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                         &lt;span class=&quot;n&quot;&gt;mask_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                         &lt;span class=&quot;n&quot;&gt;mask_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                         &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Transformer&quot;&gt;Transformer&lt;a class=&quot;anchor-link&quot; href=&quot;#Transformer&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Once we have defined our components and created the encoder, the decoder and the linear-softmax final layer, we join the pieces to form our model, the Transformer.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/transformer_architecture.PNG&quot; alt=&quot;Alt&quot; title=&quot;title Attention is all you need paper&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;vocab_size_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;vocab_size_dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;transformer&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Build the encoder&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;vocab_size_enc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Build the decoder&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;vocab_size_dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                               &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# build the linear transformation and softmax function&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_linear&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size_dec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;lin_ouput&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create_padding_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#seq: (batch_size, seq_length)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Create the mask for padding&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;newaxis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;create_look_ahead_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Create the mask for the causal attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;look_ahead_mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linalg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;band_part&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;look_ahead_mask&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dec_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Create the padding mask for the encoder&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;enc_mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_padding_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Create the mask for the causal attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dec_mask_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maximum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_padding_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_look_ahead_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Create the mask for the encoder-decoder attention&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dec_mask_2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_padding_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the encoder&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enc_mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the decoder&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dec_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;enc_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;dec_mask_1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;dec_mask_2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                   &lt;span class=&quot;n&quot;&gt;training&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the Linear and Softmax functions&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;last_linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It is worth mentioning that we create 3 masks, each of which will allow us:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Encoder mask: It is a padding mask to discard the pad tokens from the attention calculation.&lt;/li&gt;
&lt;li&gt;Decoder mask 1: this mask is a union of the padding mask and the look ahead mask which will help the causal attention to discard the tokens &quot;in the future&quot;. We take the maximum value between the padding mask and the look ahead one.&lt;/li&gt;
&lt;li&gt;Decoder mask 2: it is the padding mask and is applied in the encoder-decoder attention layer.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As you can see then we call the encoder, the decoder and the final linear-softmax layer to get the predicted output from our Transformer model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Training-the-Transformer-model&quot;&gt;Training the Transformer model&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-the-Transformer-model&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;Now that we have described in detail the components in the paper we are ready to implement them and train a transformer model on a NMT problem. It is a toy problem for educational purposes.&lt;/p&gt;
&lt;p&gt;We need to create a custom loss function to mask the padding tokens and we define the Adam optimizer described in the paper, with beta1 = 0.9, beta2 = 0.98 and epsilon= 10e-9. And then we create a scheduler to vary the learning rate over the training process according to:&lt;/p&gt;
&lt;p&gt;$lrate = d_{model}^{-0.5}*min(step\_num^{-0.5}, step\_num*warmup\_steps^{-1.5})$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loss_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logical_not&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loss_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_object&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loss_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CustomSchedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;schedules&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LearningRateSchedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;warmup_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CustomSchedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warmup_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;warmup_steps&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;arg1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;arg2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;step&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;warmup_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsqrt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arg1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;arg2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;And that's all, we have all the necessary elements to train our model using an usual loop for sequence-to-sequence tasks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;For every iteration on the batch generator that produce batch size inputs and outputs&lt;/li&gt;
&lt;li&gt;Get the input sequence from 0 to length-1 and the actual outputs from 1 to length, the next word expected at every sequence step.&lt;/li&gt;
&lt;li&gt;Call the transformer to get the predictions&lt;/li&gt;
&lt;li&gt;Calculate the loss function between the real outputs and the predictions&lt;/li&gt;
&lt;li&gt;Apply the gradients to update the weights in the model&lt;/li&gt;
&lt;li&gt;Calculate the mean loss and the accuracy for the batch data&lt;/li&gt;
&lt;li&gt;Show some results and save the model in every epoch&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;print_every&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Train the transformer model for n_epochs using the data generator dataset&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# In every epoch&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Starting epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reset the losss and accuracy calculations&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;train_accuracy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Get a batch of inputs and targets&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the decoder inputs&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dec_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the target outputs, right shifted&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dec_outputs_real&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GradientTape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Call the transformer and get the predicted output&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dec_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Calculate the loss&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_outputs_real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Update the weights and optimizer&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;gradients&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gradient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply_gradients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gradients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Save and store the metrics&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;train_accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dec_outputs_real&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;print_every&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_accuracy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Batch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Loss &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Accuracy &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_accuracy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
            
    &lt;span class=&quot;c1&quot;&gt;# Checkpoint the model on every epoch        &lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ckpt_save_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_manager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Saving checkpoint for epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; in &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                        &lt;span class=&quot;n&quot;&gt;ckpt_save_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time for 1 epoch: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; secs&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Setting the hyperparameters and parameters of the model and training process:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set hyperparamters for the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;D_MODEL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 512&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_LAYERS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 6&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;FFN_UNITS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 2048&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;N_HEADS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 8&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DROPOUT_RATE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# 0.1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now we define and create all the elements to train the model and evaluate it.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Clean the session&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clear_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the Transformer model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size_enc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;vocab_size_dec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;d_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D_MODEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_LAYERS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;FFN_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FFN_UNITS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;n_heads&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_HEADS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                          &lt;span class=&quot;n&quot;&gt;dropout_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DROPOUT_RATE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define a categorical cross entropy loss&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss_object&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SparseCategoricalCrossentropy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_logits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                            &lt;span class=&quot;n&quot;&gt;reduction&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;none&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Define a metric to store the mean loss of every epoch&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train_loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Define a matric to save the accuracy in every epoch&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_accuracy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SparseCategoricalAccuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train_accuracy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the scheduler for learning rate decay&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;leaning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CustomSchedule&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D_MODEL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the Adam optimizer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;leaning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                     &lt;span class=&quot;n&quot;&gt;beta_1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                     &lt;span class=&quot;n&quot;&gt;beta_2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.98&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                     &lt;span class=&quot;n&quot;&gt;epsilon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It is very useful to checkpoint and save our model during training. Training can take a lot of time and we can restore the model for future training or use.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Create the Checkpoint &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ckpt&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ckpt_manager&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CheckpointManager&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ckpt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_to_keep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ckpt_manager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ckpt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ckpt_manager&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Last checkpoint restored.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Train the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Starting epoch 1
Epoch 1 Batch 0 Loss 4.7359 Accuracy 0.0000
Epoch 1 Batch 100 Loss 4.6680 Accuracy 0.0530
Epoch 1 Batch 200 Loss 4.3400 Accuracy 0.0824
Epoch 1 Batch 300 Loss 3.9776 Accuracy 0.1032
Epoch 1 Batch 400 Loss 3.6847 Accuracy 0.1182
Epoch 1 Batch 500 Loss 3.4673 Accuracy 0.1302
Epoch 1 Batch 600 Loss 3.2969 Accuracy 0.1401
Epoch 1 Batch 700 Loss 3.1606 Accuracy 0.1487
Epoch 1 Batch 800 Loss 3.0452 Accuracy 0.1566
Epoch 1 Batch 900 Loss 2.9457 Accuracy 0.1637
Epoch 1 Batch 1000 Loss 2.8575 Accuracy 0.1702
Epoch 1 Batch 1100 Loss 2.7813 Accuracy 0.1757
Epoch 1 Batch 1200 Loss 2.7106 Accuracy 0.1810
Saving checkpoint for epoch 1 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-1
Time for 1 epoch: 508.13360619544983 secs

Starting epoch 2
Epoch 2 Batch 0 Loss 1.8356 Accuracy 0.2533
Epoch 2 Batch 100 Loss 1.8220 Accuracy 0.2488
Epoch 2 Batch 200 Loss 1.7898 Accuracy 0.2517
Epoch 2 Batch 300 Loss 1.7732 Accuracy 0.2539
Epoch 2 Batch 400 Loss 1.7554 Accuracy 0.2555
Epoch 2 Batch 500 Loss 1.7384 Accuracy 0.2574
Epoch 2 Batch 600 Loss 1.7187 Accuracy 0.2592
Epoch 2 Batch 700 Loss 1.7027 Accuracy 0.2615
Epoch 2 Batch 800 Loss 1.6836 Accuracy 0.2641
Epoch 2 Batch 900 Loss 1.6639 Accuracy 0.2665
Epoch 2 Batch 1000 Loss 1.6464 Accuracy 0.2686
Epoch 2 Batch 1100 Loss 1.6307 Accuracy 0.2706
Epoch 2 Batch 1200 Loss 1.6130 Accuracy 0.2728
Saving checkpoint for epoch 2 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-2
Time for 1 epoch: 496.16912508010864 secs

Starting epoch 3
Epoch 3 Batch 0 Loss 1.2504 Accuracy 0.3158
Epoch 3 Batch 100 Loss 1.3001 Accuracy 0.3075
Epoch 3 Batch 200 Loss 1.2939 Accuracy 0.3085
Epoch 3 Batch 300 Loss 1.2985 Accuracy 0.3088
Epoch 3 Batch 400 Loss 1.2915 Accuracy 0.3096
Epoch 3 Batch 500 Loss 1.2868 Accuracy 0.3103
Epoch 3 Batch 600 Loss 1.2827 Accuracy 0.3107
Epoch 3 Batch 700 Loss 1.2791 Accuracy 0.3117
Epoch 3 Batch 800 Loss 1.2731 Accuracy 0.3121
Epoch 3 Batch 900 Loss 1.2675 Accuracy 0.3128
Epoch 3 Batch 1000 Loss 1.2633 Accuracy 0.3134
Epoch 3 Batch 1100 Loss 1.2607 Accuracy 0.3138
Epoch 3 Batch 1200 Loss 1.2589 Accuracy 0.3141
Saving checkpoint for epoch 3 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-3
Time for 1 epoch: 488.9535298347473 secs

Starting epoch 4
Epoch 4 Batch 0 Loss 1.3869 Accuracy 0.3181
Epoch 4 Batch 100 Loss 1.0897 Accuracy 0.3291
Epoch 4 Batch 200 Loss 1.1142 Accuracy 0.3268
Epoch 4 Batch 300 Loss 1.1265 Accuracy 0.3261
Epoch 4 Batch 400 Loss 1.1285 Accuracy 0.3256
Epoch 4 Batch 500 Loss 1.1347 Accuracy 0.3255
Epoch 4 Batch 600 Loss 1.1360 Accuracy 0.3253
Epoch 4 Batch 700 Loss 1.1365 Accuracy 0.3254
Epoch 4 Batch 800 Loss 1.1362 Accuracy 0.3258
Epoch 4 Batch 900 Loss 1.1368 Accuracy 0.3260
Epoch 4 Batch 1000 Loss 1.1357 Accuracy 0.3264
Epoch 4 Batch 1100 Loss 1.1346 Accuracy 0.3266
Epoch 4 Batch 1200 Loss 1.1334 Accuracy 0.3269
Saving checkpoint for epoch 4 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-4
Time for 1 epoch: 479.5311484336853 secs

Starting epoch 5
Epoch 5 Batch 0 Loss 1.1191 Accuracy 0.3214
Epoch 5 Batch 100 Loss 0.9881 Accuracy 0.3438
Epoch 5 Batch 200 Loss 0.9997 Accuracy 0.3424
Epoch 5 Batch 300 Loss 1.0053 Accuracy 0.3421
Epoch 5 Batch 400 Loss 1.0054 Accuracy 0.3424
Epoch 5 Batch 500 Loss 1.0052 Accuracy 0.3422
Epoch 5 Batch 600 Loss 1.0092 Accuracy 0.3417
Epoch 5 Batch 700 Loss 1.0098 Accuracy 0.3419
Epoch 5 Batch 800 Loss 1.0125 Accuracy 0.3417
Epoch 5 Batch 900 Loss 1.0134 Accuracy 0.3417
Epoch 5 Batch 1000 Loss 1.0121 Accuracy 0.3417
Epoch 5 Batch 1100 Loss 1.0120 Accuracy 0.3420
Epoch 5 Batch 1200 Loss 1.0117 Accuracy 0.3420
Saving checkpoint for epoch 5 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-5
Time for 1 epoch: 476.9857404232025 secs

Starting epoch 6
Epoch 6 Batch 0 Loss 0.9588 Accuracy 0.3538
Epoch 6 Batch 100 Loss 0.8943 Accuracy 0.3525
Epoch 6 Batch 200 Loss 0.8968 Accuracy 0.3547
Epoch 6 Batch 300 Loss 0.9077 Accuracy 0.3546
Epoch 6 Batch 400 Loss 0.9101 Accuracy 0.3543
Epoch 6 Batch 500 Loss 0.9142 Accuracy 0.3540
Epoch 6 Batch 600 Loss 0.9183 Accuracy 0.3535
Epoch 6 Batch 700 Loss 0.9226 Accuracy 0.3533
Epoch 6 Batch 800 Loss 0.9242 Accuracy 0.3532
Epoch 6 Batch 900 Loss 0.9246 Accuracy 0.3532
Epoch 6 Batch 1000 Loss 0.9250 Accuracy 0.3531
Epoch 6 Batch 1100 Loss 0.9268 Accuracy 0.3531
Epoch 6 Batch 1200 Loss 0.9281 Accuracy 0.3531
Saving checkpoint for epoch 6 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-6
Time for 1 epoch: 476.99894547462463 secs

Starting epoch 7
Epoch 7 Batch 0 Loss 0.9244 Accuracy 0.3571
Epoch 7 Batch 100 Loss 0.8027 Accuracy 0.3686
Epoch 7 Batch 200 Loss 0.8253 Accuracy 0.3665
Epoch 7 Batch 300 Loss 0.8329 Accuracy 0.3649
Epoch 7 Batch 400 Loss 0.8385 Accuracy 0.3641
Epoch 7 Batch 500 Loss 0.8436 Accuracy 0.3632
Epoch 7 Batch 600 Loss 0.8465 Accuracy 0.3625
Epoch 7 Batch 700 Loss 0.8498 Accuracy 0.3623
Epoch 7 Batch 800 Loss 0.8531 Accuracy 0.3621
Epoch 7 Batch 900 Loss 0.8529 Accuracy 0.3618
Epoch 7 Batch 1000 Loss 0.8545 Accuracy 0.3618
Epoch 7 Batch 1100 Loss 0.8575 Accuracy 0.3616
Epoch 7 Batch 1200 Loss 0.8604 Accuracy 0.3616
Saving checkpoint for epoch 7 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-7
Time for 1 epoch: 476.37826561927795 secs

Starting epoch 8
Epoch 8 Batch 0 Loss 0.6250 Accuracy 0.3906
Epoch 8 Batch 100 Loss 0.7504 Accuracy 0.3701
Epoch 8 Batch 200 Loss 0.7584 Accuracy 0.3705
Epoch 8 Batch 300 Loss 0.7593 Accuracy 0.3711
Epoch 8 Batch 400 Loss 0.7657 Accuracy 0.3713
Epoch 8 Batch 500 Loss 0.7724 Accuracy 0.3711
Epoch 8 Batch 600 Loss 0.7806 Accuracy 0.3708
Epoch 8 Batch 700 Loss 0.7855 Accuracy 0.3705
Epoch 8 Batch 800 Loss 0.7925 Accuracy 0.3701
Epoch 8 Batch 900 Loss 0.7977 Accuracy 0.3697
Epoch 8 Batch 1000 Loss 0.8015 Accuracy 0.3696
Epoch 8 Batch 1100 Loss 0.8062 Accuracy 0.3693
Epoch 8 Batch 1200 Loss 0.8082 Accuracy 0.3691
Saving checkpoint for epoch 8 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-8
Time for 1 epoch: 476.7389974594116 secs

Starting epoch 9
Epoch 9 Batch 0 Loss 0.7808 Accuracy 0.3571
Epoch 9 Batch 100 Loss 0.6965 Accuracy 0.3805
Epoch 9 Batch 200 Loss 0.7069 Accuracy 0.3792
Epoch 9 Batch 300 Loss 0.7119 Accuracy 0.3797
Epoch 9 Batch 400 Loss 0.7249 Accuracy 0.3789
Epoch 9 Batch 500 Loss 0.7307 Accuracy 0.3789
Epoch 9 Batch 600 Loss 0.7343 Accuracy 0.3782
Epoch 9 Batch 700 Loss 0.7381 Accuracy 0.3779
Epoch 9 Batch 800 Loss 0.7425 Accuracy 0.3773
Epoch 9 Batch 900 Loss 0.7465 Accuracy 0.3770
Epoch 9 Batch 1000 Loss 0.7512 Accuracy 0.3767
Epoch 9 Batch 1100 Loss 0.7553 Accuracy 0.3762
Epoch 9 Batch 1200 Loss 0.7588 Accuracy 0.3760
Saving checkpoint for epoch 9 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-9
Time for 1 epoch: 475.674427986145 secs

Starting epoch 10
Epoch 10 Batch 0 Loss 0.7109 Accuracy 0.3973
Epoch 10 Batch 100 Loss 0.6622 Accuracy 0.3855
Epoch 10 Batch 200 Loss 0.6659 Accuracy 0.3854
Epoch 10 Batch 300 Loss 0.6762 Accuracy 0.3844
Epoch 10 Batch 400 Loss 0.6849 Accuracy 0.3838
Epoch 10 Batch 500 Loss 0.6894 Accuracy 0.3835
Epoch 10 Batch 600 Loss 0.6959 Accuracy 0.3832
Epoch 10 Batch 700 Loss 0.7005 Accuracy 0.3827
Epoch 10 Batch 800 Loss 0.7048 Accuracy 0.3822
Epoch 10 Batch 900 Loss 0.7100 Accuracy 0.3817
Epoch 10 Batch 1000 Loss 0.7131 Accuracy 0.3815
Epoch 10 Batch 1100 Loss 0.7172 Accuracy 0.3814
Epoch 10 Batch 1200 Loss 0.7207 Accuracy 0.3812
Saving checkpoint for epoch 10 in /content/drive/My Drive/Projects/Transformer_NMT/ckpt/ckpt-10
Time for 1 epoch: 480.2911014556885 secs

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Show-some-results-from-training&quot;&gt;Show some results from training&lt;a class=&quot;anchor-link&quot; href=&quot;#Show-some-results-from-training&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# plot some data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#plt.plot(results.history[&amp;#39;val_loss&amp;#39;], label=&amp;#39;val_loss&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# accuracies&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#plt.plot(results.history[&amp;#39;val_accuracy_fn&amp;#39;], label=&amp;#39;val_acc&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2AAAAE/CAYAAAAg1aCvAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nOzdeXycZbn/8c81k1myNnuXpDttoXuhZREolbWA7C6geACVHj3i0eNy1KM/VDy4cY7HDZUexe2IoAKKWED2goC0dIO2dKdt0i1pkmadJDNz//6YaQmhadM0yTMz+b5fr7wy88zzzHynDHly5b6f6zbnHCIiIiIiIjLwfF4HEBERERERGSpUgImIiIiIiAwSFWAiIiIiIiKDRAWYiIiIiIjIIFEBJiIiIiIiMkhUgImIiIiIiAwSFWAyZJnZI2Z2Q3/vKyIikgp0nhNJTaZ1wCSdmFlzl7s5QDsQS97/Z+fcbwc/Vd+Z2QLg/5xzlV5nERER72Xaee4gMxsPbAHucs59zOs8Il7SCJikFedc3sEvYAdwWZdth05KZpblXUoREZG+yeDz3D8B9cD7zCw0mC9sZv7BfD2Ro1EBJhnBzBaYWZWZfd7M9gC/MLMiM3vYzGrMrD55u7LLMc+Y2UeSt280s+fN7L+S+24zs4v7uO94M1tqZk1m9oSZ3Wlm/9eH93RS8nUbzGytmV3e5bFLzGxd8jWqzeyzye2lyffZYGZ1Zvacmen/cxGRNJfO5zkzMxIF2JeBTuCybo9fYWarzKzRzLaY2cLk9mIz+4WZ7Urm+FPXfN2ew5nZCcnbvzSzn5jZEjNrAd5pZpea2crka+w0s692O/4sM3shef7cmXyNeWa2t2sBZ2ZXm9nqXv1HE+mBfjGTTDICKAbGAotIfL5/kbw/BmgDfnSE408DNgClwHeAnydPGse67z3Ay0AJ8FXgg8f6RswsAPwF+BtQDnwC+K2ZTUnu8nMSU1HygenAU8ntnwGqgDJgOPAfgOYZi4hkhnQ9z50FVAL3Ar8HDl1rZmanAr8GPgcUAvOBN5IP/4bENMxpJM6F/3OU1+nq/cDtQD7wPNBCoggsBC4FPmZmVyYzjAUeAX5I4vw5G1jlnFsG7Acu7PK8H0zmFekzFWCSSeLAV5xz7c65Nufcfufc/c65VudcE4kfxOcc4fjtzrn/dc7FgF8BI0kUMb3e18zGAPOAW51zHc6554GH+vBeTgfygG8ln+cp4GHguuTjncBUMytwztU751Z02T4SGOuc63TOPed0oaeISKZI1/PcDcAjzrl6EsXbQjMrTz72YeBu59zjzrm4c67aOfe6mY0ELgY+mjzPdTrnnj3aP1AXf3bO/T35nBHn3DPOuVeT99cAv+PNf6v3A084536XfJ39zrlVycd+BVwPiRE54KLkexDpMxVgkklqnHORg3fMLMfM7jKz7WbWCCwFCq3nueB7Dt5wzrUmb+Yd476jgLou2wB2HuP7IPk8O51z8S7btgMVydvXAJcA283sWTM7I7n9DmAz8Dcz22pmX+jDa4uISGpKu/OcmWUD7wF+m3yuF0lc2/b+5C6jSTTn6G508nXqe3ruo3hLJjM7zcyeTk7XPAB8lMTo3pEyAPwfcJmZ5QLvBZ5zzu3uYyYRQAWYZJbuIz2fAaYApznnCkhMawDoabpFf9gNFJtZTpdto/vwPLuA0d2u3xoDVAM455Y5564gMSXjTySmdOCca3LOfcY5NwG4HPi0mZ3Xh9cXEZHUk47nuauAAuDHZrYnef1aBW9OQ9wJTDzMcTuTr1N4mMdaSExNBMDMRhxmn+7/VveQGKkb7ZwbBvyUN/+desqAc64aeBG4msT0w98cbj+RY6ECTDJZPon58A3JaQNfGegXdM5tB5YDXzWzYHJk6rKjHIaZhbt+kZhb3wr8u5kFLNGu/jLg3uTzfsDMhjnnOoFGEtNSMLN3mdkJyXn6B0i0Lo4f9kVFRCTdpcN57gbgbmAGiWurZgNnArPMbAaJa5pvMrPzzMxnZhVmdmJylOkREoVbUfJceLDAXA1MM7PZyXPmV3sRPZ/EiFoked3Z+7s89lvgfDN7r5llmVmJmc3u8vivgX9PvocHevFaIkekAkwy2feAbKAWeAl4dJBe9wPAGSQu3P1P4D4S67j0pILECbTr12gSJ7SLSeT/MfBPzrnXk8d8EHgjOeXko8nXBJgEPAE0k/iL3Y+dc0/32zsTEZFUktLnOTOrAM4Dvuec29Pl65Vk1huccy8DN5FosHEAeJZEUxFInOs6gdeBfcCnAJxzG4HbSJzvNpFosnE0/wLcZmZNwK0kZ44kn28HiWn9nwHqgFXArC7HPpjM9GC3qZcifaKFmEUGmJndB7zunBvwv0yKiIgMtqFwnjOzLSS6Dz/hdRZJfxoBE+lnyXVDJianUiwEriBxnZaIiEjaG2rnOTO7hsQ1ZU8dbV+R3ki3VdRF0sEIEnPES0isyfUx59xKbyOJiIj0myFznjOzZ4CpwAe7dSYW6TNNQRQRERERERkkmoIoIiIiIiIySFSAiYiIiIiIDJIBuQastLTUjRs3biCeWkREUsgrr7xS65wr8zpHutD5UURk6OjpHDkgBdi4ceNYvnz5QDy1iIikEDPb7nWGdKLzo4jI0NHTOVJTEEVERERERAaJCjAREREREZFBogJMRERERERkkGghZhGRftTZ2UlVVRWRSMTrKP0qHA5TWVlJIBDwOkrGybTPjD4rIiJHpgJMRKQfVVVVkZ+fz7hx4zAzr+P0C+cc+/fvp6qqivHjx3sdJ+Nk0mdGnxURkaPTFEQRkX4UiUQoKSlJ+1+kuzIzSkpKMmaEpjszW2hmG8xss5l94Qj7XWNmzszmdtn2xeRxG8zsor68fiZ9ZjL9syIi0h80AiYi0s8y4Rfp7jLxPQGYmR+4E7gAqAKWmdlDzrl13fbLBz4J/KPLtqnAtcA0YBTwhJlNds7F+pCj728ixWTSexERGQgaARMRyTB5eXleR0gnpwKbnXNbnXMdwL3AFYfZ7+vAt4GuQztXAPc659qdc9uAzcnnExER6ZEKMBERGcoqgJ1d7lcltx1iZicDo51zfz3WY0VERLpLyQLs8XV7WbWzwesYIiJpzTnH5z73OaZPn86MGTO47777ANi9ezfz589n9uzZTJ8+neeee45YLMaNN954aN//+Z//8Th9ajAzH/Bd4DPH8RyLzGy5mS2vqanpv3D97Morr+SUU05h2rRpLF68GIBHH32Uk08+mVmzZnHeeecB0NzczE033cSMGTOYOXMm999/v5exRSTDVDe0sXbXAa9jDKiUuwYs0hnjK39+jZxQFn/917MIZfm9jiQikpYeeOABVq1axerVq6mtrWXevHnMnz+fe+65h4suuogvfelLxGIxWltbWbVqFdXV1bz22msANDQMmT+CVQOju9yvTG47KB+YDjyTvLZpBPCQmV3ei2MBcM4tBhYDzJ071/Vn+P509913U1xcTFtbG/PmzeOKK67g5ptvZunSpYwfP566ujoAvv71rzNs2DBeffVVAOrr672MLSIZ5ra/rOWlrXW8/KXzMrYOSLkCLBzwc/vVM7jpF8v44ZOb+exFU7yOJCLSJ1/7y1rW7Wrs1+ecOqqAr1w2rVf7Pv/881x33XX4/X6GDx/OOeecw7Jly5g3bx4f+tCH6Ozs5Morr2T27NlMmDCBrVu38olPfIJLL72UCy+8sF9zp7BlwCQzG0+ieLoWeP/BB51zB4DSg/fN7Bngs8655WbWBtxjZt8l0YRjEvDy8YTx8jPzgx/8gAcffBCAnTt3snjxYubPn3+onXxxcTEATzzxBPfee++h44qKivo1r4gMbat2NnCgrZOn1u/j4hkjvY4zIFJyCuI7p5RzzcmV/OTZLbxWndlDkCIig23+/PksXbqUiooKbrzxRn79619TVFTE6tWrWbBgAT/96U/5yEc+4nXMQeGciwK3AI8B64HfO+fWmtltyVGuIx27Fvg9sA54FPh4XzogpoJnnnmGJ554ghdffJHVq1czZ84cZs+e7XUsERli9jVG2NvYDsADK982oSBjpNwI2EG3vmsqSzfV8Nk/rOahW84imJWStaKISI96O1I1UM4++2zuuusubrjhBurq6li6dCl33HEH27dvp7Kykptvvpn29nZWrFjBJZdcQjAY5JprrmHKlClcf/31nmYfTM65JcCSbttu7WHfBd3u3w7c3l9ZvPrMHDhwgKKiInJycnj99dd56aWXiEQiLF26lG3bth2aglhcXMwFF1zAnXfeyfe+9z0gMQVRo2Aix845x64DESoKs72OkjJeTQ68zB5dyDMb9lHf0kFRbtDjVP0vZauaYTkBvnrZNF7f08SzG1P3omURkVR11VVXMXPmTGbNmsW5557Ld77zHUaMGMEzzzzDrFmzmDNnDvfddx+f/OQnqa6uZsGCBcyePZvrr7+eb37zm17Hl0G0cOFCotEoJ510El/4whc4/fTTKSsrY/HixVx99dXMmjWL973vfQB8+ctfpr6+nunTpzNr1iyefvppj9OLpKe/rdvL/O88zRu1LV5HSRlrqg5gBl++9CQ6Y46H1+zyOtKASNkRMICzTkhMu99W2wwM9zaMiEiaaG5uBhIL4t5xxx3ccccdb3n8hhtu4IYbbnjbcStWrBiUfJJ6QqEQjzzyyGEfu/jii99yPy8vj1/96leDEUsko62tPkAs7li+vZ5xpblex0kJr1Uf4ISyPOaOK+bEEfk8sLKaD54xzutY/S5lR8AgMQo2LDvAjrpWr6OIiIiIiPSbrcmRrzVVQ6br7BE551hTfYAZlcMAuGpOBSt3NLC1ptnjZP0vpUfAAMaW5LB9vwowEREREckc25IF2GqtfQvA3sZ2apramVmRKMCunFPBtx99nXP/+1myfEZO0M/0imGcMraImZWFjCvJYXRxDuFA+rWqT/kCbHRxjjohioiIiEjGcM6xrbYFM1i3u5H2aCxj17zqrYMjgTMqCwEYXhDmxx84mQ17mumIxWho7WR1VQN3Pr2ZeJcVFQtzAhTnBinJDVKcG6Q4N0Rp3sHbQYYXhKkozGZ4QThlmvqlfAE2tjiHx17bQzQWJ8ufGv9oIiJH4pwjuWhvxnAuZdcPzgiZ9JnRZ0Xk6PY1tdPaEeMdE0t4Yct+1u9uYvboQq9jeeq16gP4fcbUkQWHti2cPpKF09+6X0t7lI17m9hR18qO/a3sa2qnrqWD/S3tbKtt4ZXt9dS1dLylSAMwg/L8EKMKsynPD5ETzCIc8JMd8JMd9JEd8CfuBxPbLps1isAA1R6pX4CV5BCNO3YfiDC6OMfrOCIiRxQOh9m/fz8lJSUZ9Qv1/v37CYfDXkfJSJn0mdFnRaR3ttYkph9eOaeCF7bsZ/XOhpQpwD7z+9Ws3XWA804q55zJ5UTjcXY3RGjtjDGpPI+TRhQwLCfQ76+7pvoAk8rzyA4eeSQwN5TFnDFFzBnT8/IX8bjjQFsn+1va2dvYTnVDG7sOfUV4o7aVts4YbZ0xIh0xWjtjxLpVbJfOHLhFoFO+ABtTnOgKs31/qwowEUl5lZWVVFVVUVOTWctnhMNhKisrvY6RkTLtM6PPisjRHbz+68wTSinNC7E6RRpxxOKOJa/uJjfk56fPbuXOp7ccdr9wwIfPDL/PqCjM5oTyPMaX5lKYE6QgnEVZfohxJblUFGX3ahTJOcerVQc498TyfnkfPp9RlBukKDfICeX5vTqmMxZ/syDriBEcwJl3KV+AjS1JFF3b61o4i1KP04iIHFkgEGD8+PFex5A0os+MyNCzrbaZcMDHyIIws0cPS5lGHNv3t9DWGeNrl0/jwmnDeXlbHXmhLEYVZhMK+Niwp4n1u5uob+3AOUdnzLGjrpU1VQf466u76T4D2e8zinICFOUkiqGi5PVahTlBirtsA9jf0sHMZAdELwT8PgJ+HwXh/h/d6y7lC7ARyQvmdqgTooiIiIhkgG21LYwrycXnM2ZVFvLE+n00RjoH5Zf/I1m/uwmAqaMKKMwJcuG0EW95fOSwbBZMOfwoVSzuaI5EOdDWyd6mCG/UtrCjrpXa5g7qWzqob+1gW20LK3Y0UN/SQbT7RVrArBSZhjnQUr4A8/mM0UXZakUvIiIiIhlha00LJ45MTI07WHS8WnWAM0/wdrbX+t2N+H3GCeV5x3ys32eJNXxzAowpyWHeuOIe93XO0dQepaGlk7rWRIGGwYwK70bABlPKF2AAY4pztBiziIiIiKS9zlicHXWtXDwjMbp0cNrd6qqGtxRg8bijtrmd5vYorR0xnIOC7CwKwgHyw1kD0h183e5GJpblDvjaWmZGQThAQThRrA01aVGAjS3JZdkb9RnVpldEREREhp6q+jaiccf40sQoU2FOkHElOfxpZTU769qobW5nZ10r22pbaI/Ge3ye3KCfguwAw7IThcywnACleUFK80KHvopzg+SHs8gO+skNJr7nBP09NsZYv7uRU8f3PHIl/SMtCrAxxTk0t0epa+mgJC/kdRwRERERSXNba5p5ZkMNV59cQWFOcNBed1ttMwDjS3MPbTv/pOH84oU3qGvppCQ3SGVRNmdPKmVMcQ4F2QGykyNSTZEojZFOGtsOfu88dH9nXSsrdzRQ19L+tjWwugtl+SjIDlCSG+QH181h8vB8Glo72H0gwkld1uGSgZEWBdibnRBbVYCJiIiIyHH7xpLXeWL9Xr77+Eb+6Yyx3HTmeMryB/73zINrgE3oUoB9+V1T+dKlJ/XLTK9Y3FHf2kFtczt1zR00t0dp64zR0h6jtSMxnbG5PUpTpJMHVlTzfy9t57YrprNudyOACrBBkFYF2I79rZx8hEXXRERERESOpqapnac37OPyWaOIOcdPnt3CXUu3cs7kMq4+uYJTxxdTnj8wC4pvq22hMCdAUe5bR9366zIbv88OTUE8mqZIlL+s3sWXL516qAPiSSN7t26W9F1aFGCVRckCTI04REREROQ4/XlVNbG44xPnnsCk4flsqWnmj69U8eCKap56fR8ApXkhpo0qYOqoAqaOTHwfV5KL33d8hdK22pa3TD/00tUnV/Dwmt0s3VjD+t2NlOYFB6zwlDelRQEWDvgZURBWK3oREREROS7OOf74ShWzRhcyaXhitGdiWR6fX3gin71wCit31LOm6gDrdjeyblcjP3tuK52xxEVVOUE/k4fnU5oXJCeYRW7In/ge9BMO+gln+QkH/IQDPkJZfrKDPsIBP9mBNxtfbN7XzFmTvG03f9DZk8oozg3y4KpqttW0aPrhIEmLAgxgTEkOO+pavI4hIiIiImls7a5GXt/TxNevnP62x/w+Y+64YuZ2WcOqIxpn074m1u1qZO2uRjbsaWJXQ4TWjigtHTFa2xPfj8Xk4akxzS/g93HZzJH8btlOcHD2pHFeRxoS0qYAG1ucw7Mba7yOISIiIiJp7I+vVBH0+7h85qhe7R/M8jFt1DCmjRrGe3rYJx53tEfjtEdjRDrjRDpjRJK32zpiRDpjdMTiGJDlN86YkBojYABXnVzJr17cDqgBx2BJmwJsTHEO+5raiXTGBnxxOBERERHJPO3RGH9eVc0F04YzLCfQb8/r8xnZQT/ZwfT7HXVW5TDGl+ayrVZTEAdL/y+hPUAqi7MB2NXQ5nESEREREUk3kc4YH//tCupbO7lu3hiv46QMM+MDp42hPD/EhLLUaA6S6dJmBKyiMNEJsaq+jQlleR6nERGRTGFmC4HvA37gZ865b3V7/KPAx4EY0Awscs6tM7NxwHpgQ3LXl5xzHx2s3CLpZPXOBopzg4wuTvw+92rVAX741CbW7moky2/4fUZeKIth2QEKc4IUZgcozAlQmhdidHF2YkHicICA30cgy0fAbwR8Pny97EjY0h7l5l8v54Ut+/n6FdNSpglGqvjwWeO56czxx93hUXonbQqwyqLECFhVvUbARESkf5iZH7gTuACoApaZ2UPOuXVddrvHOffT5P6XA98FFiYf2+Kcmz2YmUXSzbbaFq788d9xDiYPz6M8P8zzm2spCGdx7onlAHTGHc2RKA1tneysa+VAWycH2jqJuyM/t88SjTPMDL8lCjmfJaYE+s3wJe9HOuM0RTr57/fM4ppTKgfhXaeXxL+f1ymGjrQpwIYXhMnyGdUNakUvIiL95lRgs3NuK4CZ3QtcARwqwJxzjV32zwWO8iuhiHT14IoqAD574WRe2LKfrTXNfOaCydxw5jgKwj1fhxWPO2pb2tlZ10ZVfSst7TE6Y3E6Y3Hao4nv0Zgj5hxx54jHHbE4idvOEYs74i7xPHHnuHTmSBZMKR+sty3So7QpwPw+Y2RhWCNgIiLSnyqAnV3uVwGndd/JzD4OfBoIAud2eWi8ma0EGoEvO+eeG8CsImknHnc8sLKas04o5ZZzJ3HLuZN6fazPZ5TnhynPD3PK2KIBTCkyuNKmCQdARWE21SrARERkkDnn7nTOTQQ+D3w5uXk3MMY5N4dEcXaPmb2thZiZLTKz5Wa2vKZGy6nI0LJ8ez1V9W1cNafC6ygiKSOtCrDKohyNgImISH+qBkZ3uV+Z3NaTe4ErAZxz7c65/cnbrwBbgMndD3DOLXbOzXXOzS0rK+u34CLp4IEVVeQE/Vw0bYTXUURSRloVYBWF2extitARjXsdRUREMsMyYJKZjTezIHAt8FDXHcys65ypS4FNye1lySYemNkEYBKwdVBSixyj5vYozg3u5YuRzhh/fXU3C6ePIDeUNle9iAy4tPq/obIoG+dg94E2xpZonQIRETk+zrmomd0CPEaiDf3dzrm1ZnYbsNw59xBwi5mdD3QC9cANycPnA7eZWScQBz7qnKsb/HchcmTrdzdyyQ+eY3xpLpdMH8lZk0opzg0yLDtA3Dla2qO0dsTw+4yg30duKIvy/BBZ/uP7O/0T6/fSFIlyzcnqOijSVVoVYBXJVvTV9SrARESkfzjnlgBLum27tcvtT/Zw3P3A/QObTuT4vbytDuegNDfEj5/ZzI+e3nzUY3yW6EAdDvhp74zREYvj9xkBv4+g35f4nuXD4eiIxumIxumMOdqjcTqiseTtGCMKwpw+oWQQ3qVI+kirAmx00ZuLMYuIiIjI0a3ddYDi3CD3/fPp1LV0sHZX46F1tvw+IzeURU7AT8wliqmmSJQ9B9qobojQEYsTykoUW/G4oyOWKLQ6ojE6onF8ZoeKsUNf/je/nzWpVIv7inSTVgXYiGFhfAZVDSrARERERHrjtepGpo0qwMwoyQsxf7KawYh4Ka2acAT8PkYUhKmq12LMIiIiIkfTEY2zaV8T00YN8zqKiCSlVQEGievANAVRRERE5Og27m2iM+aYNuptS9SJiEfSrgCrLMrRYswiIiIivbBuVyOACjCRFJJ2BVhFYTZ7GiNEY1oLTERERORIXtt1gNygn3HqHi2SMnpdgJmZ38xWmtnDAxnoaCqKsonFHXsaI17GEBEREUl5a3c1MnVUAT51IhRJGccyAvZJYP1ABemtyuRaYLoOTERERFJVfUsH5/7XM/zbfavYWedN87BY3LF+d6MacIikmF61oTezSuBS4Hbg0wOa6CgqCt9cjFlEREQkFT24spqttS1UNbTx8JpdvPuUSqZXDGNscS5jS3IYOSxMlv/YrwSJxx1NkSj7miLsa2qnobWT5vZOmiJRmiJRmtujTBmez3vnjeaN/S20dsSYquu/RFJKb9cB+x7w70D+AGbplVGFGgETERGR1OWc475lO5k1upC7rj+F7z+5kftXVPO7l3ce2ifLZ1QUZVOYHSA76Cc74CcnmEU44MdnEInGaeuIUd/awf7mdupaOohE43REj3wNfCjLR3s0jhkEsxIF3nSNgImklKMWYGb2LmCfc+4VM1twhP0WAYsAxowZ028BuwsH/JTlh7QWmIiIiKSkVTsb2LC3iW9ePYMRw8J88+qZ/OeVM9jTGGH7/hZ27G9le10rO+taaYpEaeuMUdvcQVtnG20dMeLOkR3wEwr4KcoJMLOykKKcANnBLEJZPvLDWZQXhCnPD1GUEyQvnEVeKPHlnOOGX7zMl/70GqdPKCHo9zFpeJ7X/yQi0kVvRsDOBC43s0uAMFBgZv/nnLu+607OucXAYoC5c+e6fk/axdjiHLbvVwEmIiIiqee+ZTvJCfq5bNaoQ9v8PqOiMJuKwmzeMXEgX9344XUnc9kPn2fpxhqmVxQQ6MNURxEZOEf9P9I590XnXKVzbhxwLfBU9+JrsE0oy2VrbbOXEURERETeprk9ykOrd/GumSPJC/X2So/+VZwb5KfXn0Iwy8esykJPMohIz7z5yXCcJpTl8fvlVRxo62RYdsDrOCIiIiIA/HXNLlo7Yrxv3sBdjtEbMyqH8egnz6YkL+RpDhF5u2Mak3bOPeOce9dAhemtCaWJxQS31mgUTERERFLDjv2t/PCpzUwqz+PkMd6PPE0oy9MfqkVSUFpOCp5QlriYdGtNi8dJRERExGtPvb6XHz65ydMM63c3cs1PX6C5Pcod75mFmRY+FpHDS8spiGOKc/D7TNeBiYiICPct28lja/dy1qRS5owpGrDXiXTG2Fbbwp7GCPUtHdQlv+pbO3h4zW7yQlnc85EzmDTc81V7RCSFpWUBFszyMaY4RyNgIiIiwt7GdgC++/hGfvPh047ruRpaO9hR18rexnb2NEbYVtPClppmttQ0U93QhuvW59nvM4pygkwbVcB/v3c2Fcn1SkVEepKWBRgkrgNTASYiIiI1Te1kB/w8t6mWl7fVcer44iPu75yjpqmdzfua2dMYYV9TO1trmnllez1buv1ukR3wM6Esl5PHFPGeU0YzsTyXkcOyKckNUpQbpCCcpemGInJM0rcAK8vluc21xOIOv08/+ERERIaieNyxrynCB04by19f3c1//W0D9y06Hefgjf0t1Ld20NDaye4DETbubWLDniY27m2ivrXzLc9TlBPg5DFFXH1yJZPK8xheEGZ4crFjn37PEJF+lMYFWB4d0Ti7GtoYXZzjdRwRERHxQH1rB50xx7iSHG555wl85aG1vP9//8HaXQdojETfsm9+KIvJI/JZOH0kJ47IZ1J5Hqnk/xYAACAASURBVCMLsynPD5Hr0ZpdIjL0pO1Pm4Ot6LfUNKsAExERGaL2NSWu/yovCHPeSeX87uUd7G2KcMmMkZw8tojhBWGGZQcozw8xclhY0wVFxHPpW4B1aUW/YIrHYUREJG2Z2ULg+4Af+Jlz7lvdHv8o8HEgBjQDi5xz65KPfRH4cPKxf3XOPTaY2QX2NkYAGF4QIpTl59FPzfc4kYjIkaXlOmAApXlB8sNZakUvIiJ9ZmZ+4E7gYmAqcJ2ZTe222z3OuRnOudnAd4DvJo+dClwLTAMWAj9OPp8Mon3JDojl+WGPk4iI9E7aFmBmxoSyPHVCFBGR43EqsNk5t9U51wHcC1zRdQfnXGOXu7nAwUbkVwD3OufanXPbgM3J55NBtK8pMQJWlh/yOImISO+kbQEGMFGt6EVE5PhUADu73K9KbnsLM/u4mW0hMQL2r8dyrAysvY3tFOYECAc0+Cgi6SGtC7AJZbnsaYzQ0h49+s4iIiJ95Jy70zk3Efg88OVjOdbMFpnZcjNbXlNTMzABh7C9jRGGa/qhiKSRNC/AEo04ttVqFExERPqkGhjd5X5lcltP7gWuPJZjnXOLnXNznXNzy8rKjjOudLevqZ3yAk0/FJH0kdYF2MRkAbZpX5PHSUREJE0tAyaZ2XgzC5JoqvFQ1x3MbFKXu5cCm5K3HwKuNbOQmY0HJgEvD0Jm6WJfY0QNOEQkraRtG3qAiWW5hLJ8vFbdyFVzvE4jIiLpxjkXNbNbgMdItKG/2zm31sxuA5Y75x4CbjGz84FOoB64IXnsWjP7PbAOiAIfd87FPHkjQ1Q87tjX1M5wjYCJSBpJ6wIsy+9j2qgC1lQ1eB1FRETSlHNuCbCk27Zbu9z+5BGOvR24feDSyZHUt3YQjTvK1QFRRNJIWk9BBJhZWchr1Y3E4u7oO4uIiEjG2JtcA2x4gaYgikj6yIACbBhtnTE279OCzCIiIkPJ3uQaYOUqwEQkjWRAAVYIoGmIIiIiQ0xNcgRMUxBFJJ2kfQE2oTSXvFAWa6oOeB1FREREBtHexoMjYCrARCR9pH0B5vMZ0ysKWFOtAkxERGQo2dsUoSgnQCjL73UUEZFeS/sCDBLTENfvaqQjGvc6ioiIiAySfY3tWgNMRNJOhhRgw+iIxdm4Vwsyi4iIDBV7m9o1/VBE0k5mFGAViUYcq9WIQ0REZMjY1xhRC3oRSTsZUYCNLs6mMCfAq2rEISIiMiTE446apnaGawRMRNJMRhRgZsaMimGsVgEmIiIyJNS1dhCNO10DJiJpJyMKMIBZlYVs3NtES3vU6ygiIiIywA62oNcImIikm4wpwE6bUEws7lj2Rp3XUURERGQAbd/fwo+f2QKga8BEJO1keR2gv8wdW0zQ7+Pvm2tZMKXc6zgiIiLSz7bWNPOjpzfz51W7yPIZN589nlmVhV7HEhE5JhlTgGUH/Zw8tpC/b97vdRQRERHpR5v2NvHDpzbz8JpdBLN83PSOcSyaP4FyjX6JSBrKmAIM4MyJpfz34xupa+mgODfodRwRERE5Dut3N/Kjpzaz5LXdZAf83Dx/AjefPYHSPF33JSLpK6MKsHeckCjAXtyyn0tnjvQ6joiIiPTBngMRvv3o6zy4spq8UBYfX3ACHzprvP64KiIZIaMKsFmVw8gLZfH3LbUqwERERNJMpDPGz57byp1PbyHmHP+yYCL/PH8iw3ICXkcTEek3GVWAZfl9nDa+mBc213odRURERHrJOcejr+3h9iXrqapvY+G0EfzHJScxpiTH62giIv0uowowSExDfPL1fVQ3tFFRmO11HBERETmCV7bX8e1HNvDyG3WcOCKfe24+jXdMLPU6lojIgMm4AuzME0oA+PvmWt47d7THaURERORwVu1s4EdPbeaJ9XspzQvxn1dO59p5o8nyZ8wSpSIih5VxBdiU4fmU5gVVgImIiKSYzlicR17bwy/+vo2VOxrID2fxuYumcNOZ48gJZtyvJCIih5VxP+3MjHMml/O3dXvoiMYJZukvaSIiIl7a39zOvct28psXt7OnMcK4khy+etlU3j13NHmhjPtVRETkiDLyp94lM0Zw/4oq/r6llndOKfc6joiIpCgzWwh8H/ADP3POfavb458GPgJEgRrgQ8657cnHYsCryV13OOcuH7TgaaA9GuPxdXt5cEU1z26sIRp3nHVCKd+4ejoLJpfj85nXEUVEPJGRBdhZk0rJC2XxyKu7VYCJiMhhmZkfuBO4AKgClpnZQ865dV12WwnMdc61mtnHgO8A70s+1uacmz2ooVPIc5tqWLx0K99972zK8t9cGLkjGuePr1Txo6c2setAhOEFIT581niuOaWSycPzPUwsIpIaMrIAC2X5Of+kcv62bi+3x+IEdEGviIi83anAZufcVgAzuxe4AjhUgDnnnu6y/0vA9YOaMIW9uGU/z22q5Z/ufpl7F53OsOwAL2yp5fP3r2FnXRuzRxdy+1UzmD+5DL9Gu0REDsnIAgzg4hkj+dOqXfxjax1nTVI7WxEReZsKYGeX+1XAaUfY/8PAI13uh81sOYnpid9yzv2p/yOmrqZIlKDfx+Z9TXzol8uYPbqQnz+/jQmlufzixnksmFKGmQovEZHuMrYAO2dyGTlBP0te260CTEREjouZXQ/MBc7psnmsc67azCYAT5nZq865LYc5dhGwCGDMmDGDkncwNEU6GTEszBcvPpGP37OCV7bX809njOWLF59EdtDvdTwRkZSVsQVYOODnnSeW87e1e/j6FdM1/UFERLqrBrquV1KZ3PYWZnY+8CXgHOdc+8Htzrnq5PetZvYMMAd4WwHmnFsMLAaYO3eu68f8nmqMRMkPZ3HxjJH86kOnkuXzccbEEq9jiYikvIy+OOqS6SOpbe7g5W11XkcREZHUswyYZGbjzSwIXAs81HUHM5sD3AVc7pzb12V7kZmFkrdLgTPpcu3YUNAU6SQ/nPg77tmTylR8iYj0UkYXYO88sYzcoJ8HVlR5HUVERFKMcy4K3AI8BqwHfu+cW2tmt5nZwZbydwB5wB/MbJWZHSzQTgKWm9lq4GkS14ANsQIsSkE44HUMEZG0k7FTEAFygllcNmsUf161i1svm0q+ThQiItKFc24JsKTbtlu73D6/h+NeAGYMbLrU1hSJ6rwqItIHGT0CBvDeeaNp64zx8JrdXkcRERHJGI1tb05BFBGR3sv4AmzO6EImledx37KdR99ZREREjioedzR3RClQASYicswyvgAzM943bzSrdjawcW+T13FERETSXnNHFOegIFtTEEVEjlXGF2AAV82pIOA3jYKJiIj0g6ZIFEBTEEVE+uCoBZiZhc3sZTNbbWZrzexrgxGsP5XkhTj/pOE8uLKa9mjM6zgiIiJprbGtE0BNOERE+qA3I2DtwLnOuVnAbGChmZ0+sLH63/tPG0NdSwcPrdrldRQREZG0phEwEZG+O2oB5hKak3cDyS83oKkGwFknlHLiiHx+/vw2nEu7+CIiIimjKZIYAdM6YCIix65X14CZmd/MVgH7gMedc/8Y2Fj9z8z48FnjeX1PE89tqvU6joiISNrSCJiISN/1qgBzzsWcc7OBSuBUM5vefR8zW2Rmy81seU1NTX/n7BeXzx5FWX6Inz2/zesoIiIiaasxomvARET66pi6IDrnGoCngYWHeWyxc26uc25uWVlZf+XrV6EsPzecMZalG2vYsEct6UVERPpCI2AiIn3Xmy6IZWZWmLydDVwAvD7QwQbKB04bSzjg43+f2+p1FBERkbTUGOkkmOUjHPB7HUVEJO30ZgRsJPC0ma0BlpG4BuzhgY01cIpyg1w7bwwPrqxm+/4Wr+OIiIiknca2KAUa/RIR6ZPedEFc45yb45yb6Zyb7py7bTCCDaSPLZhIls/44VObvY4iIiKSdpoinbr+S0Skj47pGrBMMbwgzAdOG8uDK6vZVqtRMBERkWPRFInq+i8RkT4akgUYwEcXTCDgN3745Cavo4iIiKSVpkin1gATEemjIVuAleeH+eDpY/nTqmq21DQf/QAREREBoFEjYCIifTZkCzCAfz5nIuGAn28uSdumjiIiIoMucQ2YCjARkb4Y0gVYaV6IT5w7iSfW7+XZjam5eLSIiEiqSVwDpimIIiJ9MaQLMIAPnTWOcSU5fO0va+mIxr2OIyIiktKisTitHTFdAyYi0kdDvgALZfm59bKpbK1p4dcvvuF1HBERkZTWFIkCaAqiiEgfDfkCDODcE4fzzillfP+JTexrjHgdR0REJGWpABMROT4qwJJuvWwa7bE4X/vLOq+jiIiIpKzGSCeArgETEekjFWBJ40tz+ddzT+Cvr+7myfV7vY4jIiKDxMwWmtkGM9tsZl84zOOfNrN1ZrbGzJ40s7FdHrvBzDYlv24Y3OTeODgCVpCtETARkb5QAdbFovkTmTw8j1v/vJaW9qjXcUREZICZmR+4E7gYmApcZ2ZTu+22EpjrnJsJ/BH4TvLYYuArwGnAqcBXzKxosLJ75eAImJpwiIj0jQqwLoJZPr559Ux2HWjj+09u8jqOiIgMvFOBzc65rc65DuBe4IquOzjnnnbOtSbvvgRUJm9fBDzunKtzztUDjwMLBym3Z3QNmIjI8VEB1s0pY4s4e1IZS7UumIjIUFAB7Oxyvyq5rScfBh7p47EZoUnXgImIHBcVYIdRnBOgpUNTEEVE5E1mdj0wF7jjGI9bZGbLzWx5TU36/3FPI2AiIsdHBdhh5IayaGmPeR1DREQGXjUwusv9yuS2tzCz84EvAZc759qP5Vjn3GLn3Fzn3NyysrJ+C+6VxrZOsgN+An79CiEi0hf66XkYeaEsmtWEQ0RkKFgGTDKz8WYWBK4FHuq6g5nNAe4iUXzt6/LQY8CFZlaUbL5xYXJbRmuKRDX6JSJyHPQT9DByQ1l0RON0xuL6C5+ISAZzzkXN7BYShZMfuNs5t9bMbgOWO+ceIjHlMA/4g5kB7HDOXe6cqzOzr5Mo4gBuc87VefA2BlVTe6cKMBGR46CfoIeRF0r8s7S0RynMCXqcRkREBpJzbgmwpNu2W7vcPv8Ix94N3D1w6VJPUyRKQbYacIiI9JWGdw7jYAGmaYgiIiJv1djWqQ6IIiLHQQXYYeQeGgFTIw4REZGudA2YiMjxUQF2GLkhP6ARMBERke4aI1EKVICJiPSZCrDD6HoNmIiIiLypKdJJgaYgioj0mQqww8hVASYiIvI27dEY7dG4piCKiBwHFWCHoSYcIiIib9cUSZwX1YRDRKTvVIAdhkbARERE3m53QwRAI2AiIsdBBdhhHGzC0dKhLogiIiIArR1RPvfH1QzLDvCOiaVexxERSVsqwA4jlOUn4DdNQRQREQGcc3zuj2vYuLeJH143hxHDwl5HEhFJWyrAepAbytIURBEREWDx0q38dc1uPnfRicyfXOZ1HBGRtKYCrAe5wSyaIyrARERkaHtuUw3ffvR1Lp0xko+eM8HrOCIiaU8FWA/yQlmagigiIkPazrpWPvG7lUwqz+c7756JmXkdSUQk7akA60FuyE9LhwowEREZmto6Yiz6zSvE4467PnjKoQ7BIiJyfFSA9SA3lEVzu7ogiojI0HTbw2t5fU8j379uDuNKc72OIyKSMVSA9SBPTThERGSIenZjDb97eSeL5k/gnVPKvY4jIpJRVID1QF0QRURkKGqMdPKF+9dwQnke/3b+ZK/jiIhkHE3o7oGacIiIyFB0+8Pr2dsY4YF/OZNwwO91HBGRjKMRsB7khvy0tEdxznkdRUREZFC8sLmW+5bvZNH8icweXeh1HBGRjKQCrAe5oSziDiKdca+jiIiIDLiOaJz/9+fXGFOcw6fOn+R1HBGRjKUCrAd5yXa7moYoIiJDwd1/38aWmha+dvk0TT0UERlAKsB6kBtMFGBqxCEiIpluV0Mb339iExdOHc47T1TXQxGRgaQCrAe5GgETEZEh4j//ug6H49bLpnodRUQk46kA68HBKYgaARMRyVxmttDMNpjZZjP7wmEen29mK8wsambv7vZYzMxWJb8eGrzU/WvZG3UseXUP/7LgBCqLcryOIyKS8dSGvge5ocT895YOFWAiIpnIzPzAncAFQBWwzMwecs6t67LbDuBG4LOHeYo259zsAQ86gJxzfGPJeoYXhLj57AlexxERGRI0AtaDN5twxDxOIiIiA+RUYLNzbqtzrgO4F7ii6w7OuTecc2uAjGyJu+TVPazc0cBnLphCdlCNN0REBoMKsB7kagqiiEimqwB2drlfldzWW2EzW25mL5nZlf0bbeB1RON8+9HXOXFEPtecUul1HBGRIUNTEHugAkxERI5irHOu2swmAE+Z2avOuS3ddzKzRcAigDFjxgx2xh799h/b2VHXyi9vmoffZ17HEREZMjQC1gOtAyYikvGqgdFd7lcmt/WKc646+X0r8Awwp4f9Fjvn5jrn5paVlfU9bT+KdMb48TNbOH1CMedMTo1MIiJDhQqwHvh9RnbArxEwEZHMtQyYZGbjzSwIXAv0qpuhmRWZWSh5uxQ4E1h35KNSxz3/2EFNUzufOn8yZhr9EhEZTCrAjiA3lKUmHCIiGco5FwVuAR4D1gO/d86tNbPbzOxyADObZ2ZVwHuAu8xsbfLwk4DlZrYaeBr4VrfuiSkr0hnjJ88mRr9On1DidRwRkSFH14AdQV5II2AiIpnMObcEWNJt261dbi8jMTWx+3EvADMGPOAA+N3LidGvH1x72BmTIiIywDQCdgS5oSwVYCIikjEinTF+8swWThtfzBkTNfolIuIFFWBHkJiCqAJMREQyw4Mrq9nX1M4nz5vkdRQRkSHrqAWYmY02s6fNbJ2ZrTWzTw5GsFSQF8qipUMFmIiIpD/nHHc/v41powo0+iUi4qHejIBFgc8456YCpwMfN7OpAxsrNSSmIKoJh4iIpL/nN9eyaV8zHzpzvDofioh46KgFmHNut3NuRfJ2E4lOURUDHSwV5IX8NEU0AiYiIunv7ue3UZoX4l2zRnodRURkSDuma8DMbByJhSb/MRBhUk1uUE04REQk/W2paebpDTV88PSxhLL8XscRERnSel2AmVkecD/wKedc42EeX2Rmy81seU1NTX9m9ExuKIu2zhixuPM6ioiISJ/98u9vEPT7+MDpY7yOIiIy5PWqADOzAIni67fOuQcOt49zbrFzbq5zbm5ZWVl/ZvRMXiixTJoacYiISLpq7Yhy/4oqLp89itK8kNdxRESGvN50QTTg58B659x3Bz5S6sg9WIBpGqKIiKSpv63dS2tHjPfOHe11FBERoXcjYGcCHwTONbNVya9LBjhXSsgNJebJqwATEZF09eDKaioKs5k7tsjrKCIiAmQdbQfn3PPAkOxXe3AKYrNa0YuISBqqaWrnuU01fGzBRHy+IXkqFxFJOcfUBXGo0RREERFJZ39ZvYu4gytnD4nVY0RE0oIKsCN4cwRMBZiIiKSfP62qZnpFAZOG53sdRUREklSAHYFGwEREJF1t3tfMmqoDGv0SEUkxKsCOQE04REQkXT20qhqfweWzRnkdRUREujhqE46hrCAcwAzufHoLW2tbWDhtBKdNKPE6loiIyFE9vn4f88YVU14Q9jqKiIh0oRGwIwgH/Pzg2jlMG1XAPf/YwfsWv8S/3beKpkin19FERER6tLcxwvrdjSyYUu51FBER6UYjYEdx2axRXDZrFK0dURYv3coPntzEK9vr+c67Z3La+GIS61SLiIikjmc31ACwYEqZx0lERKQ7jYD1Uk4wi0+dP5n7/vkMYnHHtYtf4qLvLeVnz21lf3O71/FEREQOeWbjPkYUhDlxhLofioikGhVgx2jeuGIe+7f5fOOqGeQEs/jPv67ntG88yUd/8wpPvb6XaCzudUQRERnCorE4z22q5ZzJZZqlISKSgjQFsQ/yQlm8/7QxvP+0MWzc28Qflu/kgRXVPLp2D8MLQlxzciXvnTuacaW5XkcVEZEhZsWOBpoiUd55oqYfioikIhVgx2ny8Hy+dOlUPnfRiTz1+j7+sHwnP312Cz95dgvnnVjOh84azxkTSvRXSBERGRRPb9hHls8484RSr6OIiMhhaApiPwlm+Vg4fQQ/v3EeL37xPD5x7iRW7Gjg/f/7D87772f5wZOb2LG/1euYIiLSjZktNLMNZrbZzL5wmMfnm9kKM4ua2bu7PXaDmW1Kft0weKl79syGGk4ZW0R+OOB1FBEROQwVYANgeEGYT18wmRe+cC7fuWYmZfkhvvv4Rubf8TQf/Pk/eGLdXmJx53VMEZEhz8z8wJ3AxcBU4Dozm9pttx3AjcA93Y4tBr4CnAacCnzFzIoGOvORqP28iEjq0xTEARQO+HnvvNG8d95oqhvauP+VKu75xw4+8uvlVBZlc/3pY3nf3NEU5Qa9jioiMlSdCmx2zm0FMLN7gSuAdQd3cM69kXyse5eli4DHnXN1yccfBxYCvxv42If30tb9AJw9SdMPRURSlUbABklFYTb/et4knvv8O/nxB06msiibbz3yOqd/80k++4fVvFp1wOuIIiJDUQWws8v9quS2gT52QKzeeYBwwKf28yIiKUwjYIMs4PdxyYyRXDJjJBv2NPHrF9/gwZXV/PGVKmaPLuTdp1RyyYyRFGtUTEQkI5jZImARwJgxYwb0tdZUNTBt1DCy/Pr7qohIqtJPaA9NGZHP7VfN4KX/OI+vXDaV5vYoX/7Ta5x6+xN8+JfLeHyd1hUTERlg1cDoLvcrk9v67Vjn3GLn3Fzn3NyysoFrDR+NxXlt1wFmVRYO2GuIiMjx0whYCigIB7jpzPHc+I5xrNvdyEOrdvHgymqe/PVyhheEuOPds5g/Weu5iIgMgGXAJDMbT6J4uhZ4fy+PfQz4RpfGGxcCX+z/iL2zcW8zkc44s0YP8yqCiIj0gkbAUoiZMW3UML54yUn8/QvnctcHT8E5+OULb3gdTUQkIznnosAtJIqp9cDvnXNrzew2M7scwMzmmVkV8B7gLjNbmzy2Dvg6iSJuGXDbwYYcXlhT1QDATI2AiYikNI2ApaiA38dF00Zw/ytVvLG/xes4IiIZyzm3BFjSbdutXW4vIzG98HDH3g3cPaABe2l11QEKwlmMK8nxOoqIiByBRsBSXEVRNtX1bTindcNERKRna6oamFlZiJl5HUVERI5ABViKqyzKoaUjRkNrp9dRREQkRUU6Y2zY08TMSl3/JSKS6lSApbiKwmwAqhvaPE4iIiKpat3uRqJxp+u/RETSgAqwFFdZlCjAqupbPU4iIiKpas3ORAMOdUAUEUl9KsBS3JsFmEbARETk8NZUHaAsP8SIgrDXUURE5ChUgKW4YdkB8kJZKsBERKRHq6samFU5TA04RETSgAqwFGdmVBRm6xowERE5rEhnjK21LUwbpemHIiLpQAVYGqgsytYImIiIHNaOulacgwlluV5HERGRXlABlgYSa4GpCYeIiLzd1poWACaU5nmcREREekMFWBqoKMymMRKlMaK1wERE5K221SYKsHGlOR4nERGR3lABlgYqixIn1eoUmobYGYt7HUFERIA3alsozQuRHw54HUVERHpBBVgaqEixVvTPb6pl2lce09pkIiIpYFttC+M1+iUikjZUgKWBg2uBpcp1YL9btoOOaJzXqg94HUVEZMjbtr+F8aVqwCEiki5UgKWBktwg4YAvJUbAWtqjPLl+LwBbk9cdiIj8//buPEyu6rzz+Pettbt63yT1oqW102IRkgDHLGY1YBPkx8Y2iWeMEyaOZ+AxJH48A2PHcZzkmfEMmYTMME4Im00w2MYsguABA8nYMDEgQCBoQAi1ltbam3qp7q71zB91W7SEBFKrq6pv6fd5nnrq3lu3qt6jU6rTb51zz5HiGB5P0TOcYIESMBER31AC5gMzaS2wX3buZTyVJWDQ1aMETESkmLb25kZGLFQCJiLiG6FiByBHp7UuNiN6wB7dsJOWmjLa6mLqARMRKbKuvtz3cLumoBcR8Q0lYD7RVld+4Jqrn7y0nbue28rsmjLm18cIGOwdStAXTzCruoxFTZW0N8aYU13OnJoy5lSXUR4JHncMA/Ekv363l2vPaWdoPMWTb+497tcUEZGpmxiJML9Bk3CIiPiFEjCfaK0tpz+e5MGXu7npoY0sm13FQDzJhu0DOGBOdRn1FRHe3DnILzbuJusOfn51WYg5NWXMri6j2UvKZk/cV5cxp6aM+liEQMCOGMMTb+wmnXVcubKF5zf30h9Psn80SW0skt/Ci4jIYW3ti9NaW05Z+Ph/ZBMRkcJQAuYTEzMhfvPB11g1r477/t1ZR2xwE+kMO/rH2Ds0zp7BcfYMjR+0/c6eYXpHEh9I0sJBY1ZVLhmbVRWlMhqiIhqiMhoiFg2ybsMuFjVV0NFcze7940BuIo5V85SAiYgUw5beuBZgFhHxGSVgPjGxGPOipkruvGbNh/7aGQ0FWTyrksWzjnxNQDqTpWckwZ7ByclZ4sD2pr3DxBMZ4sk08UT6QLJ28+XLMTPam3IXfHf1xFk1r276CioiIkfFOUdXzwhXrmwpdigiInIMlID5xKltNdxw0RKuPnPutAz5CwUDNNeU01xT/pHnOudIpLOMJTPUxsIAzKuPEQwYW3pHjjsWERE5dgOjKYbG0yxo0AyIIiJ+ogTMJ8LBAH90ydKivLeZURYOHtTrFg4GmFcfo0szIYqIFEWX9wPYwiYlYCIifqJ1wGTK2hsr2KK1wEREiqLLWwNMPWAiIv6iBEymbGFjBVv74mQPnc1DRMRHzOwyM3vHzDab2U2HeTxqZj/xHn/BzBZ4xxeY2ZiZbfBuf1fIuLt6RwgGjLn1moRDRMRPNARRpqy9qYLxVJbdQ+O01n70tWQiIjONmQWB24BLgG7gJTNb55zrnHTatcCAc26xmV0NfB/4ovfYe865lQUN2rO9f4y2Tp3o+gAAFQdJREFUunLCQf2WKiLiJ/rWlilb2JibZXFLz7FPxOGcI5XJTewxkkgznsqQymTVmyYihXYmsNk5t8U5lwQeANYecs5a4Ife9oPARWZ25EUTC6R3OEFTZbTYYYiIyDFSD5hM2cSF3129cc5d0gRAJuvYuHOQl7cNMDSWYiyVoW8kyfb+ONv6RhkeT5PKZEl/SKJlBqGAETAjFDCCB26BA/uRUIAzFtRx2clzOHtxI9GQFiEVkSlpBXZM2u8GzjrSOc65tJkNAg3eY+1m9iowBHzbOffrQ9/AzL4KfBVg3rx50xZ4fzzJ/AYNPxQR8RslYDJls6qiVESCbOmJs71vlL999l2efmsv+0dTB86JhgLUxSLMa4jxiaVN1MbChIMBQsEA4YARCgYIBiCThUw2l5hlJt3Sh2xnvfvh8RS/2LiHn67vZm59OU/d+AnKI0rCRKSgdgPznHN9ZrYaeMTMVjjnhiaf5Jy7HbgdYM2aNdPWzd8XT7Jqfu10vZyIiBSIEjCZsokFmR97bRf3vbCNUCDAp05p5ryljfzWogYaKqIEA/kbpZNIZ3jolZ3c/NBGnn17H58+tTlv7yUiJWsnMHfSfpt37HDndJtZCKgB+pxzDkgAOOdeNrP3gKXA+nwHnc06BkaT1E3DupAiIlJYugZMjktHczUDo0k+e3ob//LN8/mrL5zG2pWtzKoqy2vyBRANBfnCmrk0VUV57LVdeX0vESlZLwFLzKzdzCLA1cC6Q85ZB1zjbV8FPOucc2bW5E3igZktBJYAWwoR9NB4ikzWUV+hBExExG/UAybH5U+u6ODGi5fSUqRZEIMB49OnNHP/i9sZSaSpjOojLSJHz7um63rgSSAI3OWce9PMvgesd86tA+4E7jWzzUA/uSQN4Dzge2aWArLA15xz/YWIuz+eBKChUgmYiIjffORfq2Z2F3AFsM85d3L+QxI/qSoLU1UWLmoMV5zazD3/bytPd+7lM6e3FjUWEfEf59wTwBOHHPvOpO1x4POHed7PgZ/nPcDDmEjA6is0C6KIiN8czRDEe4DL8hyHyJStmldHc00Zj7+uYYgicmLom+gB0xBEERHf+cgeMOfcr8xsQf5DEZmagDcM8Yf/upXB0RQ1sVyPnHOOobE0PSMJ4OCJx5yD/WMpeoYT7B9Nkc5mSWdya5ONJjOMpzKMpTKMJTMk0tkDU+GHJt2b5abKr42Fufacdio0/FFECuT9HjAlYCIifqO/GKUkXHFaC3c818Wtz7wLwItb+9jaO8pIIj2l14uGAsQiQcrDQSKhAFmHNxV+lkzWkco4ss7hHIwk0mzcOcjf/5vVBPI88YiICCgBExHxs2lLwPK10KTI0TitrYZ59THuer6LaCjA6vl1XLW6jdbacmZVRwnYBxOjmvIwjZVR6isihIK5Xq1wMEB5OHhMidTdz3fxZ4918v0n3+bmy0+azmKJiBxWfzxJLBKkLKz1D0VE/GbaErB8LTQpcjTMjLt/7wz2DSU4fV5tQf8o+crHF7ClJ87f/98tLGqs5AtnzP3oJ4mIHIf+eFK9XyIiPqUhiFIyFjVVsqipsuDva2b86W93sLUvzrcffYOV82pZOruq4HGIyImjL57UBBwiIj51NNPQ3w+cDzSaWTfwp865O/MdmIifhIIB/vqLK7nsb37FjQ9s4JHrziYSOvZ1zt+fOGSceCJDKpMlmcmSyjjSmSypTJZEOrefymRJpt8/lkhnwTnqKiLUV0Q4Y0F90dZnE5H86o8naKrUFPQiIn50NLMg/k4hAhHxu8bKKP/ls6fyBz9az63PbOKbly4/8Jhzjvd64mzaO8z+0RQDo0n2jyYPbPeMJOkdTtAznCCZyU45BrPcDI8AHc3VPHHDucdbLBGZgfpHkuppFxHxKQ1BFJlGl3TM5gtr2vjBv7xHPJEhmcnSO5zgle0D9I4kDzq3LBygLhahpjxMU1WURU0VNFVFaaqM0lQVpaosRCgQIBwMEAnlJggJBQJEQgEiwdx9OGiEQwGi3rGJ6fV//MI2bnlqE527huhoqS7Sv4aI5INzTkMQRUR8TAmYyDT7kys66Nw9xI9f3E51WYjq8jDnLmnirPZ6Tm6toaEyQl0skpeJQsxy01L/7lnzufWZd3n41W46Wjqm/X1EpHjGUrn1CesrNARRRMSPlICJTLOqsjCPXX8Odpip7wulviLCBctm8ciGXfyny5YTCh779WiHk85kSWcd6awjk3l/XbSRRJrBsdSB29BYivkNFZy3tGla3ldE3tfn9aarB0xExJ+UgInkQTGTrwmfXdXGU517eW5zL+cvm3XYc7JZR89Igu6BMXbuH2PP4BgDoyn2j6YYHJu4Ri3F4GiS/WMpRpOZo37/8nCQjd/95LQlfyKSo0WYRUT8TQmYSIm6YHkTtbEwD72yk/OXzWJwNMWTnXvYtGeYTftG2NobZ/fgGKnMwcv2hQJGbSxMbSxCbXmY1toyOpqrqYuFqSoLEw7lFq0OBgKEAkYgYFRGg9SUhw/cnnu3l+8+1klXb5wlmihAZFodSMAqlYCJiPiREjCREhUNBfntU1v46fod/NVT73DP81sZTqSJhgIsnlXJaXNr+dQpzbTWltFaV05rbYzm2jKqoqHj7sFLZ3NJXefuoYInYM45xlIZ+uNJBuIp+keTzKuP0d5YUdA4RPKlbyIBiykBExHxIyVgIiXss6taufc32/ifz27m0hWzue6CxaxoqSEYyO8QyUVNlURCAd7cNcTala3T9roTs79t6xtlR/8o2/pG2dYfZ99QIpdwjSbpjydza6JNEgwYv3/2Am68eCkVUX3tib/1xxOAesBERPxKf4mIlLCVc2u55fOnsXxOFSe31hTsfcPBAMtmV9G5a2hKzx8cS7F53widu4d4a/cQO/pH2bV/jN2D4x+4Dm1OdRlzasporiljRUs19RWR3GLUsdx9TXmYh1/t5h9+3cXjr+/mH768pqD/FiLTrT+eIhw0qvRjgoiIL+nbW6SEmRlXrW4rynt3NFfzVOcenHMHDWkcTabZtHeEnQNjpDJZUpkse4fG6eodZWtfnK7e+IFrXACqy0K0N1WydHYV5y5pYl59jPkNuVtbXeyopvM/s72eq1bP5Wv/+DLffuQNHv4PHy/YRCmjyTS9w0l6RsbpG0ly+rw6mqo0fbhMXX88QX1FZEZM9iMiIsdOCZiI5MWK1mp+sn4He4bGaa4pZ9/wONfes543dg3i3AfPn10dpb2xgktXzGZBQwULmyrpaKmmpaZsWv7QXD2/jm9cspSbHtrILzv38skVc6b0Os7lpt3vHUnSN5KgdyRB70jSu0/QO5zb7hlJ0DucIH5Ij11LTRkP/vuP01JbftxlkhNTfzypNcBERHxMCZiI5EVHczUAb+4cormmnJ+t72bjzkG+fuFiOlpqmN8QIxoKEA4GqK+IFOTarKtWt3H7r7Zwy1PvcNFJs494LVzfSIIXu/rZ1p+71mzP4PhBidah15hNqIuFaayM0lQV5bS22gPbjZURmqqiZLKOGx/YwL+98wV+9rWPF20a8YmJSgBiETUDftMXT2oNMBERH1PLKyJ5sby5GrPcTIgXnTSLR17dyRkL6vjjTy4rWkyhYIBvfHIZ1/34FR55dSefW93Gzv1jbNo7zJ7BcboHRnl+cx+vde8/0EtXGwvTUlNOY1WURU2VNHoJVWNllIZKL7mqjFJXESF8FGue3XHNGr5814v83t0vct8ffIzKaUw8x5IZeoYT9IyMs28o1wu3byjhHUuwbzg3DHJiopJvXrqM6y5YPG3vL4XRH0/SVhcrdhgiIjJFSsBEJC8qoyEWNFTw5q5BOncP8e6+Ef7iMycXOywuP3kOJ7dW8+f/1MktT73D7sHxA48FDE5pq+XGi5Zy3tJGFs2qpLosPK3vf9bCBm773VX84T++zB/eu567vnIG0dBHX8c2lsywb3icHf1jdPXF2dYbZ8/QeC658m7DifQHnhcwaKyMMqs6SlNllOVzqmnwJio5q71+WssmhdE/oh4wERE/UwImInnT0VLN6937eXTDLkIB49OnNBc7JAIB4ztXrOA/P7yR5XOqWDO/jhWtNbTUljO7KkroKHqxjtfFHbP5b587lW/87DVuuH8Dt31p1YHhkM45dg2Os2H7fjbsGOC1HYO8vWeIofGDk6uycIDmmnKaKqOc1FLNeZOSrFnVZTR5wx/rKyJ5X3ZACieZzjKcSBdt+KqIiBw/JWAikjcdzdX80+u7+fnL3Zy/rIm6GfJH45nt9Tz9x58oagyfW93G/rEUf/54J1+5+0XqYhH64gk27R2hZzi3zlMkFGBFSzVXrmyhuaacWVVRWmvLWdhUyezqqGbBmyZmdhlwKxAE7nDO/ddDHo8CPwJWA33AF51zW73HbgauBTLA151zT+Yz1oFRbxHmGfJ/SUREjp0SMBHJmxUtuYk4+uLJaV2QuVRce047Y8k0dz7XRU15mPqKCOcubmTlvFpWzq1l+ZxqIqH898idyMwsCNwGXAJ0Ay+Z2TrnXOek064FBpxzi83sauD7wBfNrAO4GlgBtABPm9lS59zBU19Oo76RXAKmIYgiIv6lBExE8mZFS27B44pIkItPml3kaGam6y9cwvUXLil2GCeyM4HNzrktAGb2ALAWmJyArQW+620/CPwvy3U/rgUecM4lgC4z2+y93r/mK9iJNfLUAyYi4l/6aVVE8qapKsqChhhXrmyhPPLRE02IFEErsGPSfrd37LDnOOfSwCDQcJTPxcy+ambrzWx9T0/PcQXbF88NT1UCJiLiX+oBE5G8evS6c4iG9VuPnLicc7cDtwOsWbPmMMuQH70Lls9i3fVnM7de09CLiPiVEjARyaua2PRO4y4yzXYCcyftt3nHDndOt5mFgBpyk3EczXOnVXVZmFPbavP5FiIikmf6WVpERE5kLwFLzKzdzCLkJtVYd8g564BrvO2rgGedc847frWZRc2sHVgCvFiguEVExKfUAyYiIics51zazK4HniQ3Df1dzrk3zex7wHrn3DrgTuBeb5KNfnJJGt55PyU3YUcauC6fMyCKiEhpUAImIiInNOfcE8AThxz7zqTtceDzR3juXwJ/mdcARUSkpGgIooiIiIiISIEoARMRERERESkQJWAiIiIiIiIFogRMRERERESkQJSAiYiIiIiIFIgSMBERERERkQJRAiYiIiIiIlIg5pyb/hc16wG2HefLNAK90xDOTFKKZQKVy09KsUygchXTfOdcU7GD8Au1jx9K5fKPUiwTqFx+4pcyHbaNzEsCNh3MbL1zbk2x45hOpVgmULn8pBTLBCqXnFhK9XOhcvlHKZYJVC4/8XuZNARRRERERESkQJSAiYiIiIiIFMhMTsBuL3YAeVCKZQKVy09KsUygcsmJpVQ/FyqXf5RimUDl8hNfl2nGXgMmIiIiIiJSamZyD5iIiIiIiEhJmXEJmJldZmbvmNlmM7up2PFMlZnNNbN/NrNOM3vTzG7wjteb2S/N7F3vvq7YsR4rMwua2atm9ri3325mL3h19hMzixQ7xmNlZrVm9qCZvW1mb5nZb5VIXf2R9/l7w8zuN7MyP9aXmd1lZvvM7I1Jxw5bP5bzt175XjezVcWL/MiOUKb/7n0GXzezh82sdtJjN3tlesfMLi1O1FJspdBGlnL7CGoj/ULt48xtH6H028gZlYCZWRC4Dbgc6AB+x8w6ihvVlKWBbzjnOoCPAdd5ZbkJeMY5twR4xtv3mxuAtybtfx/4a+fcYmAAuLYoUR2fW4H/45xbDpxGrny+riszawW+Dqxxzp0MBIGr8Wd93QNcdsixI9XP5cAS7/ZV4AcFivFY3cMHy/RL4GTn3KnAJuBmAO+742pghfec/+19X8oJpITayFJuH0Ft5Iyn9nHGt49Q4m3kjErAgDOBzc65Lc65JPAAsLbIMU2Jc263c+4Vb3uY3JdVK7ny/NA77YfAZ4oT4dSYWRvwaeAOb9+AC4EHvVP8WKYa4DzgTgDnXNI5tx+f15UnBJSbWQiIAbvxYX05534F9B9y+Ej1sxb4kcv5DVBrZs2FifToHa5MzrmnnHNpb/c3QJu3vRZ4wDmXcM51AZvJfV/KiaUk2shSbR9BbWRxIpwytY8ztH2E0m8jZ1oC1grsmLTf7R3zNTNbAJwOvADMds7t9h7aA8wuUlhT9TfAfwSy3n4DsH/Sfwg/1lk70APc7Q0bucPMKvB5XTnndgK3ANvJNSyDwMv4v74mHKl+SuV75PeBX3jbpVImOT4l9zkosfYR1Eb6gtrHA/xcRl+3kTMtASs5ZlYJ/By40Tk3NPkxl5uC0jfTUJrZFcA+59zLxY5lmoWAVcAPnHOnA3EOGUrht7oC8MZ8ryXXeLYAFXywO78k+LF+PoyZfYvcMK37ih2LSL6UUvsIaiPxUX2pffS3UmgjZ1oCthOYO2m/zTvmS2YWJte43Oece8g7vHeiu9e731es+KbgbOBKM9tKbujLheTGhdd6XfjgzzrrBrqdcy94+w+Sa2z8XFcAFwNdzrke51wKeIhcHfq9viYcqX58/T1iZl8BrgC+5N5fJ8TXZZJpUzKfgxJsH0FtpJ/qS+1jju/KWCpt5ExLwF4Clniz0ETIXVC3rsgxTYk37vtO4C3n3P+Y9NA64Bpv+xrg0ULHNlXOuZudc23OuQXk6uZZ59yXgH8GrvJO81WZAJxze4AdZrbMO3QR0ImP68qzHfiYmcW8z+NEuXxdX5McqX7WAV/2Znv6GDA4aSjGjGZml5EbvnSlc2500kPrgKvNLGpm7eQuoH6xGDFKUZVEG1mK7SOojcRf5VL76LP2EUqsjXTOzagb8ClyM5u8B3yr2PEcRznOIdfl+zqwwbt9itx48GeAd4GngfpixzrF8p0PPO5tLyT3Qd8M/AyIFju+KZRnJbDeq69HgLpSqCvgz4C3gTeAe4GoH+sLuJ/cOP0UuV9jrz1S/QBGbqa494CN5Ga5KnoZjrJMm8mNY5/4zvi7Sed/yyvTO8DlxY5ft6J9bnzfRpZ6++iVUW3kDL+pfZy57eOHlKtk2kjzghYREREREZE8m2lDEEVEREREREqWEjAREREREZECUQImIiIiIiJSIErARERERERECkQJmIiIiIiISIEoARMRERERESkQJWAiIiIiIiIFogRMRERERESkQP4/OSYwh0QyQlUAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Make-predictions&quot;&gt;Make predictions&lt;a class=&quot;anchor-link&quot; href=&quot;#Make-predictions&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;We have seen the scores obtained after training but what we are interested in making predictions and see how the model works with new sentences. The predict function will input a tokenize sentence to the model and return the predicted new sentence, in our example, a translation from english to spanish.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tokenize the input sentence to a sequence of tokens&lt;/li&gt;
&lt;li&gt;Set the initial output sequence to the SOS token&lt;/li&gt;
&lt;li&gt;Until we reach the max length or the eos token is returned by the model&lt;/li&gt;
&lt;li&gt;Get the next word predicted. The model returns the logits, remember that the softmax function is applied in the loss calculation.&lt;/li&gt;
&lt;li&gt;Get the index in the vocabulary of the word with the highest probability&lt;/li&gt;
&lt;li&gt;Concat the next word predicted to the output sequence&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Tokenize the input sequence using the tokenizer_in&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inp_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token_input&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;enc_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inp_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Set the initial output sentence to sos&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;out_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_output&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reshape the output&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# For max target len tokens&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the transformer and get the logits &lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transformer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;enc_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#(1, seq_length, VOCAB_SIZE_ES)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Extract the logists of the next word&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# The highest probability is taken&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;predicted_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Check if it is the eos token&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicted_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Concat the predicted word to the output sequence&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicted_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;And finally our last function receives a sentence in english, calls the transformer to translate it to spanish and shows the result&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Get the predicted sequence for the input sentence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MAX_LENGTH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Transform the sequence of tokens to a sentence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sos_token_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;First, we explore the predictions on sentences of our training dataset:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;you should pay for it.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: you should pay for it.
Output sentence: Deberías pagarlo.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;we have no extra money.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: we have no extra money.
Output sentence: No tenemos dinero extra.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, let's predict some new sentences on diferent topics:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;This is a problem to deal with.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: This is a problem to deal with.
Output sentence: Este problema es un problema con eso.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;This is a really powerful method!&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: This is a really powerful method!
Output sentence: ¡Esto es un verdadero poderoso!
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Show some translations&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;This is an interesting course about Natural Language Processing&amp;quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Input sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;translate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Output sentence: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicted_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Input sentence: This is an interesting course about Natural Language Processing
Output sentence: Esta es una buena persona en la diez.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Intro to the Encoder-Decoder model and the Attention mechanism</title><link href="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/encoder-decoder/lstm/attention/tensorflow%202/2020/10/07/Intro-seq2seq-Encoder-Decoder-ENG-SPA-translator-tf2.html" rel="alternate" type="text/html" title="Intro to the Encoder-Decoder model and the Attention mechanism" /><published>2020-10-07T00:00:00-05:00</published><updated>2020-10-07T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/fastpages/jupyter/encoder-decoder/lstm/attention/tensorflow%202/2020/10/07/Intro-seq2seq-Encoder-Decoder-ENG-SPA-translator-tf2</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/encoder-decoder/lstm/attention/tensorflow%202/2020/10/07/Intro-seq2seq-Encoder-Decoder-ENG-SPA-translator-tf2.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-07-Intro-seq2seq-Encoder-Decoder-ENG-SPA-translator-tf2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Intro-to-the-Encoder-Decoder-model-and-the-Attention-mechanism&quot;&gt;Intro to the Encoder-Decoder model and the Attention mechanism&lt;a class=&quot;anchor-link&quot; href=&quot;#Intro-to-the-Encoder-Decoder-model-and-the-Attention-mechanism&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h1 id=&quot;A-neural-machine-translator-from-english-to-spanish-short-sentences-in-tf2&quot;&gt;A neural machine translator from english to spanish short sentences in tf2&lt;a class=&quot;anchor-link&quot; href=&quot;#A-neural-machine-translator-from-english-to-spanish-short-sentences-in-tf2&quot;&gt; &lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We continue our journey through the world of NLP, in this post we are going to describe the &lt;strong&gt;basic architecture of an encoder-decoder model&lt;/strong&gt; that we will apply to a neural &lt;em&gt;machine translation problem&lt;/em&gt;, translating texts from English to Spanish. Later, we will introduce a technique that has been a great step forward in the treatment of NLP tasks: &lt;strong&gt;the attention mechanism&lt;/strong&gt;. We will detail a basic processing of the attention applied to a scenario of a &lt;em&gt;sequence-to-sequence model&lt;/em&gt;, &quot;many to many&quot; approach. But for the moment it will be a simple attention model, we will not comment on more complex models that will be discussed in future posts, when we address the subject of &lt;em&gt;Transformers&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;What-is-Neural-Machine-Translation?&quot;&gt;What is Neural Machine Translation?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-Neural-Machine-Translation?&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;em&gt;Machine translation (MT) is the task of automatically converting source text in one language to text in another language. Given a sequence of text in a source language, there is no one single best translation of that text to another language. This is because of the natural ambiguity and flexibility of human language. This makes the challenge of automatic machine translation difficult, perhaps one of the most difficult in artificial intelligence.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Machine Learning Mastery, Jason Brownlee [1]&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;The initial approach to MT problems was the statistical machine translation based on the use of statistical models, probabilities, given an input sentence. Neural machine translation, or NMT for short, is the use of neural network models to learn a statistical model for machine translation.
The key benefit to the approach is that a single system can be trained directly on source and target text, no longer requiring the pipeline of specialized systems used in statistical machine learning.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;A-basic-approach-to-the-Encoder-Decoder-model&quot;&gt;A basic approach to the Encoder-Decoder model&lt;a class=&quot;anchor-link&quot; href=&quot;#A-basic-approach-to-the-Encoder-Decoder-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;From the above we can deduce that NMT is a problem where we process an input sequence to produce an output sequence, that is, a sequence-to-sequence (seq2seq) problem. Specifically of the many-to-many type, sequence of several elements both at the input and at the output, and the encoder-decoder architecture for recurrent neural networks is the standard method.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/encoder_decoder_basic.png&quot; alt=&quot;Alt&quot; title=&quot;title Depiction of Sutskever Encoder-Decoder Model for Text Translation Taken from Sequence to Sequence Learning with Neural Networks, 2014&quot; /&gt;&lt;/p&gt;
&lt;p&gt;The seq2seq model consists of two sub-networks, the encoder and the decoder. The encoder, on the left hand, receives sequences from the source language as inputs and produces as a result a compact representation of the input sequence, trying to summarize or condense all its information. Then that output becomes an input or initial state of the decoder, which can also receive another external input. At each time step, the decoder generates an element of its output sequence based on the input received and its current state, as well as updating its own state for the next time step. &lt;/p&gt;
&lt;p&gt;Mention that the input and output sequences are of fixed size but they do not have to match, the length of the input sequence may differ from that of the output sequence.&lt;/p&gt;
&lt;p&gt;The critical point of this model is how to get the encoder to provide the most complete and meaningful representation of its input sequence in a single output element to the decoder. Because this vector or state is the only information the decoder will receive from the input to generate the corresponding output. The longer the input, the harder to compress in a single vector.
We will describe in detail the model and build it in a latter section.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Importing-the-libraries-and-initialize-global-variables&quot;&gt;Importing the libraries and initialize global variables&lt;a class=&quot;anchor-link&quot; href=&quot;#Importing-the-libraries-and-initialize-global-variables&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gc&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;unicodedata&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Importing libraries&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.keras&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;backend&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.text&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.preprocessing.sequence&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Using TensorFlow backend.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We set the variables for data location&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Global parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#root folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#data_folder=&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;spa.txt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Variable for data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_filenamepath&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Both train and test set are in the root data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The next code cell define the parameters and hyperparameters of our model:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Parameters for our model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;INPUT_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;input&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TARGET_FOR_INPUT&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target_for_input&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;NUM_SAMPLES&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#40000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;MAX_VOCAB_SIZE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;EMBEDDING_DIM&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;128&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;HIDDEN_DIM&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1024&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#512&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;BATCH_SIZE&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Batch size for training.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;# Number of epochs to train for.&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ATTENTION_FUNC&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;general&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;The-dataset-and-text-processing&quot;&gt;The dataset and text processing&lt;a class=&quot;anchor-link&quot; href=&quot;#The-dataset-and-text-processing&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;For this exercise we will use pairs of simple sentences, the source in English and target in Spanish, from the Tatoeba project where people contribute adding translations every day. This is the &lt;a href=&quot;http://www.manythings.org/anki/&quot;&gt;link&lt;/a&gt; to some traslations in different languages. There you can download the Spanish - English spa_eng.zip file, it contains 124457 pairs of sentences.&lt;/p&gt;
&lt;p&gt;The text sentences are almost clean, they are simple plain text, so we only need to remove accents, lower case the sentences and replace everything with space except (a-z, A-Z, &quot;.&quot;, &quot;?&quot;, &quot;!&quot;, &quot;,&quot;). The code to apply this preprocess has been taken from the Tensorflow tutorial for neural machine translation.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Preprocess-the-text-data&quot;&gt;Preprocess the text data&lt;a class=&quot;anchor-link&quot; href=&quot;#Preprocess-the-text-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Some function to preprocess the text data, taken from the Neural machine translation with attention tutorial&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# in Tensorflow&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;unicode_to_ascii&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unicodedata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normalize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;NFD&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unicodedata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;category&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Mn&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;preprocess_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Preprocess the input text w applying lowercase, removing accents, &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    creating a space between a word and the punctuation following it and &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    replacing everything with space except (a-z, A-Z, &amp;quot;.&amp;quot;, &amp;quot;?&amp;quot;, &amp;quot;!&amp;quot;, &amp;quot;,&amp;quot;)&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Input:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - w: a string, input text&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    Output:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - a string, the cleaned text&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unicode_to_ascii&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# creating a space between a word and the punctuation following it&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# eg: &amp;quot;he is a boy.&amp;quot; =&amp;gt; &amp;quot;he is a boy .&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reference:- https://stackoverflow.com/questions/3645931/python-padding-punctuation-with-white-spaces-keeping-punctuation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;([?.!,¿])&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; \1 &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;[&amp;quot; &amp;quot;]+&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# replacing everything with space except (a-z, A-Z, &amp;quot;.&amp;quot;, &amp;quot;?&amp;quot;, &amp;quot;!&amp;quot;, &amp;quot;,&amp;quot;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;[^a-zA-Z?.!,¿]+&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;strip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# adding a start and an end token to the sentence&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# so that the model know when to start and stop predicting.&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#w = &amp;#39;&amp;lt;start&amp;gt; &amp;#39; + w + &amp;#39; &amp;lt;end&amp;gt;&amp;#39;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-the-datasets&quot;&gt;Loading the datasets&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-datasets&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Load the dataset into a pandas dataframe and apply the preprocess function to the input and target columns.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Load the dataset: sentence in english, sentence in spanish &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_filenamepath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;INPUT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;usecols&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; 
               &lt;span class=&quot;n&quot;&gt;nrows&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;NUM_SAMPLES&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Preprocess the input data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;INPUT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preprocess_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Preprocess and include the end of sentence token to the target text&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preprocess_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;lt;eos&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Preprocess and include a start of setence token to the input text to the decoder, it is rigth shifted&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;sos&amp;gt; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;preprocess_sentence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[&amp;#39;go .&amp;#39;, &amp;#39;go .&amp;#39;, &amp;#39;go .&amp;#39;, &amp;#39;go .&amp;#39;, &amp;#39;hi .&amp;#39;]
[&amp;#39;ve . &amp;lt;eos&amp;gt;&amp;#39;, &amp;#39;vete . &amp;lt;eos&amp;gt;&amp;#39;, &amp;#39;vaya . &amp;lt;eos&amp;gt;&amp;#39;, &amp;#39;vayase . &amp;lt;eos&amp;gt;&amp;#39;, &amp;#39;hola . &amp;lt;eos&amp;gt;&amp;#39;]
[&amp;#39;&amp;lt;sos&amp;gt; ve .&amp;#39;, &amp;#39;&amp;lt;sos&amp;gt; vete .&amp;#39;, &amp;#39;&amp;lt;sos&amp;gt; vaya .&amp;#39;, &amp;#39;&amp;lt;sos&amp;gt; vayase .&amp;#39;, &amp;#39;&amp;lt;sos&amp;gt; hola .&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Delete the dataframe and release the memory (if it is possible)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;del&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;gc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;collect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;22&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tokenize-and-process-the-text-data&quot;&gt;Tokenize and process the text data&lt;a class=&quot;anchor-link&quot; href=&quot;#Tokenize-and-process-the-text-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Next, let's see how to prepare the data for our model. It is very simple and the steps are the following:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Tokenize the data, to convert the raw text into a sequence of integers. First, we create a Tokenizer object from the keras library and fit it to our text (one tokenizer for the input and another one for the output).&lt;/li&gt;
&lt;li&gt;Extract sequence of integers from the text: we call the text_to_sequence method of the tokenizer for every input and output text.&lt;/li&gt;
&lt;li&gt;Calculate the maximum length of the input and output sequences.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a tokenizer for the input texts and fit it to them &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_VOCAB_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_on_texts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tokenize and transform input texts to sequence of integers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_sequences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texts_to_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Claculate the max length&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Max Input Length: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Show some example of tokenize sentences, useful to check the tokenization&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Max Input Length:  8
are you in ?
[21, 4, 36, 5]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now we repeat the steps for the output texts but now we do not want to filter special characters otherwise eos and sos token will be removed&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# tokenize the outputs&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# don&amp;#39;t filter out special characters (filters = &amp;#39;&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# otherwise &amp;lt;sos&amp;gt; and &amp;lt;eos&amp;gt; won&amp;#39;t appear&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# By default, Keras’ Tokenizer will trim out all the punctuations, which is not what we want. &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# we can just set filters as blank here.&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create a tokenizer for the output texts and fit it to them &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Tokenizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MAX_VOCAB_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_on_texts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_on_texts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tokenize and transform output texts to sequence of integers&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_sequences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texts_to_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_sequences_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texts_to_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# determine maximum length output sequence&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_max_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Max Target Length: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_sequences_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Max Target Length:  15
¿ estas dentro ? &amp;lt;eos&amp;gt;
[5, 45, 401, 4, 2]
&amp;lt;sos&amp;gt; ¿ estas dentro ?
[3, 5, 45, 401, 4]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-the-vocabularies&quot;&gt;Create the vocabularies&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-vocabularies&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Using the tokenizer we have created previously we can retrieve the vocabularies, one to match word to integer (word2idx) and a second one to match the integer to the corresponding word (idx2word).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# get the word to index mapping for input language&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;word2idx_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_index&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Found &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; unique input tokens.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# get the word to index mapping for output language&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_index&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Found &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; unique output tokens.&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# store number of output and input words for later&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# remember to add 1 since indexing starts at 1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# map indexes back into real words&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# so we can view the results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;idx2word_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2idx_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()}&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Found 3664 unique input tokens.
Found 7168 unique output tokens.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Padding-the-sentences&quot;&gt;Padding the sentences&lt;a class=&quot;anchor-link&quot; href=&quot;#Padding-the-sentences&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Padding the sentences: we need to pad zeros at the end of the sequences so that all sequences have the same length. Otherwise, we won't be able train the model on batches&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# pad the input sequences&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;encoder_inputs.shape:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;encoder_inputs[0]:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# pad the decoder input sequences&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_sequences_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;decoder_inputs[0]:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;decoder_inputs.shape:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# pad the target output sequences&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder_targets&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;encoder_inputs.shape: (20000, 8)
encoder_inputs[0]: [31  1  0  0  0  0  0  0]
decoder_inputs[0]: [ 3 99  1  0  0  0  0  0  0  0  0  0  0  0  0]
decoder_inputs.shape: (20000, 15)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Create-the-batch-data-generator&quot;&gt;Create the batch data generator&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-batch-data-generator&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Create a batch data generator: we want to train the model on batches, group of sentences, so we need to create a Dataset using the tf.data library and the function batch_on_slices on the input and output sequences.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define a dataset &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_tensor_slices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder_targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;BATCH_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_remainder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Build-an-Encoder-Decoder-model-with-Recurrent-Neural-Networks&quot;&gt;Build an Encoder-Decoder model with Recurrent Neural Networks&lt;a class=&quot;anchor-link&quot; href=&quot;#Build-an-Encoder-Decoder-model-with-Recurrent-Neural-Networks&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For a better understanding, we can divide the model in three basic components:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/encoder_decoder_RNN.jpeg&quot; alt=&quot;Alt&quot; title=&quot;From Understanding Encoder-Decoder Sequence to Sequence Model by Simeon Kostadinov [3]&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;encoder&lt;/strong&gt;: Layers of recurrent units where in each time step, receive a an input token, collects relevant information and produce a hidden state. Depends on the type of RNN, in our example a LSTM, the unit &quot;mixes&quot; the current hidden state and the input and return an output, discarded, and a new hidden state. You can read my post … for more information.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;encoder vector&lt;/strong&gt;: it is the last hidden state of the encoder and it tries to contain as much of the useful input information as possible to help the decoder get the best results. It is only information from the input that the decoder will get.&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;The &lt;strong&gt;decoder&lt;/strong&gt;: Layers of recurrent units, i.e. LSTMs, where each unit produces an output at a time step t. The hidden state of the first unit is the encoder vector and the rest of units accept the hidden state from the previous unit. The output is calculated using a softmax function to obtain a  probability for every token in the output vocabulary.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Encoder-class&quot;&gt;Encoder class&lt;a class=&quot;anchor-link&quot; href=&quot;#Encoder-class&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Define the embedding layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Define the RNN layer, LSTM&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Embed the input&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the LSTM unit&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_c&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Return a all 0s initial states&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Decoder-class&quot;&gt;Decoder class&lt;a class=&quot;anchor-link&quot; href=&quot;#Decoder-class&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Define the embedding layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Define the RNN layer, LSTM&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Embed the input&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Call the LSTM unit&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Dense layer to predict output token&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_c&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Once our encoder and decoder are defined we can init them and set the initial hidden state. We have included a simple test, calling the encoder and decoder to check they works fine.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Set the length of the input and output vocabulary&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Create the encoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EMBEDDING_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HIDDEN_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the initial states&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;initial_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Call the encoder for testing&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_encoder_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the decoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EMBEDDING_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HIDDEN_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the initial states&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;de_initial_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Call the decoder for testing&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_decoder_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_initial_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_decoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(1, 6, 512)
(1, 8, 11239)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Create-the-loss-function-and-metrics&quot;&gt;Create the loss function and metrics&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-loss-function-and-metrics&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now we need to define a custom loss function to avoid taking into account the 0 values, padding values, when calculating the loss. And also we have to define a custom accuracy function.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loss_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;crossentropy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SparseCategoricalCrossentropy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;from_logits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Mask padding values, they do not have to compute for loss&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logical_not&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;math&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Calculate the loss value&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;crossentropy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;targets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;accuracy_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# y_pred shape is batch_size, seq length, vocab size&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# y_true shape is batch_size, seq length&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pred_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;correct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;equal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pred_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# 0 is padding, don&amp;#39;t include those&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;greater&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;float32&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n_correct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;correct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n_total&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mask&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_correct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_total&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Train-the-model&quot;&gt;Train the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Train-the-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As we mentioned before, we are interested in training the network in batches, therefore, we create a function that carries out the training of a batch of the data:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Call the encoder for the batch input sequence, the output is the encoded vector.&lt;/li&gt;
&lt;li&gt;Set the decoder initial states to the encoded vector&lt;/li&gt;
&lt;li&gt;Call the decoder, taking the right shifted target sequence as input. The output are the logits (the softmax function is applied in the loss function)&lt;/li&gt;
&lt;li&gt;Calculate the loss and accuracy of the batch data&lt;/li&gt;
&lt;li&gt;Update the learnable parameters of the encoder and the decoder&lt;/li&gt;
&lt;li&gt;update the optimizer&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Use the @tf.function decorator to take advance of static graph computation&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; A training step, train a batch of the data and return the loss value reached&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Input:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - input_seq: array of integers, shape [batch_size, max_seq_len, embedding dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the input sequence&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - target_seq_out: array of integers, shape [batch_size, max_seq_len, embedding dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the target seq, our target sequence&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - target_seq_in: array of integers, shape [batch_size, max_seq_len, embedding dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the input sequence to the decoder, we use Teacher Forcing&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - en_initial_states: tuple of arrays of shape [batch_size, hidden_dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the initial state of the encoder&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - optimizer: a tf.keras.optimizers.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Output:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - loss: loss value&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Network’s computations need to be put under tf.GradientTape() to keep track of gradients&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GradientTape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the encoder outputs&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Set the encoder and decoder states&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;en_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_states&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the encoder outputs&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Take the actual output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Calculate the loss function&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Calculate the gradients for the variables&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;gradients&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gradient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Apply the gradients and update the optimizer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply_gradients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gradients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As you can observe, our train function receives three sequences:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Input&lt;/strong&gt; sequence: array of integers of shape [batch_size, max_seq_len, embedding dim]. It is the input sequence to the encoder.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;target&lt;/strong&gt; sequence: array of integers of shape [batch_size, max_seq_len, embedding dim]. It is the target of our model, the output that we want for our model.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Target input&lt;/strong&gt; sequence: array of integers of shape [batch_size, max_seq_len, embedding dim]. It is the input sequence to the decoder because we use &lt;em&gt;Teacher Forcing&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Teacher-Forcing&quot;&gt;Teacher Forcing&lt;a class=&quot;anchor-link&quot; href=&quot;#Teacher-Forcing&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Teacher forcing is a training method critical to the development of deep learning models in NLP. It is a way for quickly and efficiently training recurrent neural network models that use the ground truth from a prior time step as input.&lt;/p&gt;
&lt;p&gt;In a recurrent network usually the input to a RNN at the time step t is the output of the RNN in the previous time step, t-1. But with teacher forcing we can use the actual output to improve the learning capabilities of the model.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;&quot;Teacher forcing works by using the actual or expected output from the training dataset at the current time step y(t) as input in the next time step X(t+1), rather than the output generated by the network.
So, in our example, the input to the decoder is the target sequence right-shifted, the target output at time step t is the decoder input at time step t+1.&quot;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;When our model output do not vary from what was seen by the model during training, teacher forcing is very effective. But if we need a more &quot;creative&quot; model, where given an input sequence there can be several possible outputs, we should avoid this technique or apply it randomly (only in some random time steps).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, we can code the whole training process:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the main train function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the initial time&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the initial state for the encoder&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# For every batch data&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;take&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Train and get the loss value &lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# Store the loss and accuracy values&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; Batch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; Loss &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; Acc:&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()))&lt;/span&gt;
                
        &lt;span class=&quot;c1&quot;&gt;# saving (checkpoint) the model every 2 epochs&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Time taken for 1 epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; sec&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We are almost ready, our last step include a call to the main train function and we create a checkpoint object to save our model. Because the training process require a long time to run, every two epochs we save it. Later we can restore it and use it to make predictions.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create an Adam optimizer and clips gradients by norm&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clipnorm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create a checkpoint object to save the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./training_ckpt_seq2seq&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ckpt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BATCH_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1 Batch 0 Loss 3.6920 Acc:0.0000
Epoch 1 Batch 100 Loss 1.8457 Acc:0.3483
Epoch 1 Batch 200 Loss 1.8571 Acc:0.3507
Epoch 1 Batch 300 Loss 1.7594 Acc:0.3544
Epoch 1 Batch 400 Loss 1.7331 Acc:0.3711
Epoch 1 Batch 500 Loss 1.6858 Acc:0.4112
Epoch 1 Batch 600 Loss 1.5133 Acc:0.4176
Time taken for 1 epoch 412.1442 sec

Epoch 2 Batch 0 Loss 1.4640 Acc:0.4237
Epoch 2 Batch 100 Loss 1.3850 Acc:0.4479
Epoch 2 Batch 200 Loss 1.3766 Acc:0.4496
Epoch 2 Batch 300 Loss 1.3028 Acc:0.4920
Epoch 2 Batch 400 Loss 1.2801 Acc:0.4804
Epoch 2 Batch 500 Loss 1.2633 Acc:0.4809
Epoch 2 Batch 600 Loss 1.1715 Acc:0.5307
Time taken for 1 epoch 407.9001 sec

Epoch 3 Batch 0 Loss 1.0933 Acc:0.5026
Epoch 3 Batch 100 Loss 0.9902 Acc:0.5368
Epoch 3 Batch 200 Loss 1.1020 Acc:0.5166
Epoch 3 Batch 300 Loss 0.9828 Acc:0.5831
Epoch 3 Batch 400 Loss 1.0007 Acc:0.5851
Epoch 3 Batch 500 Loss 1.0448 Acc:0.5623
Epoch 3 Batch 600 Loss 1.0433 Acc:0.5434
Time taken for 1 epoch 410.5108 sec

Epoch 4 Batch 0 Loss 0.8128 Acc:0.5749
Epoch 4 Batch 100 Loss 0.8484 Acc:0.5805
Epoch 4 Batch 200 Loss 0.8766 Acc:0.6042
Epoch 4 Batch 300 Loss 0.8591 Acc:0.5722
Epoch 4 Batch 400 Loss 0.9052 Acc:0.5625
Epoch 4 Batch 500 Loss 0.8957 Acc:0.5607
Epoch 4 Batch 600 Loss 0.7913 Acc:0.6230
Time taken for 1 epoch 408.0038 sec

Epoch 5 Batch 0 Loss 0.7634 Acc:0.6171
Epoch 5 Batch 100 Loss 0.7738 Acc:0.6005
Epoch 5 Batch 200 Loss 0.7116 Acc:0.6011
Epoch 5 Batch 300 Loss 0.7309 Acc:0.6133
Epoch 5 Batch 400 Loss 0.7092 Acc:0.6168
Epoch 5 Batch 500 Loss 0.6972 Acc:0.6475
Epoch 5 Batch 600 Loss 0.7019 Acc:0.6544
Time taken for 1 epoch 407.3742 sec

Epoch 6 Batch 0 Loss 0.5252 Acc:0.6979
Epoch 6 Batch 100 Loss 0.5881 Acc:0.6987
Epoch 6 Batch 200 Loss 0.5753 Acc:0.6832
Epoch 6 Batch 300 Loss 0.5651 Acc:0.7018
Epoch 6 Batch 400 Loss 0.6628 Acc:0.6524
Epoch 6 Batch 500 Loss 0.6011 Acc:0.6794
Epoch 6 Batch 600 Loss 0.5782 Acc:0.6613
Time taken for 1 epoch 407.0541 sec

Epoch 7 Batch 0 Loss 0.4506 Acc:0.7228
Epoch 7 Batch 100 Loss 0.4577 Acc:0.7179
Epoch 7 Batch 200 Loss 0.4120 Acc:0.7560
Epoch 7 Batch 300 Loss 0.4673 Acc:0.7092
Epoch 7 Batch 400 Loss 0.4652 Acc:0.7084
Epoch 7 Batch 500 Loss 0.5468 Acc:0.7000
Epoch 7 Batch 600 Loss 0.5556 Acc:0.6779
Time taken for 1 epoch 405.3848 sec

Epoch 8 Batch 0 Loss 0.4024 Acc:0.7581
Epoch 8 Batch 100 Loss 0.3794 Acc:0.7715
Epoch 8 Batch 200 Loss 0.3802 Acc:0.7486
Epoch 8 Batch 300 Loss 0.3644 Acc:0.7425
Epoch 8 Batch 400 Loss 0.4295 Acc:0.7378
Epoch 8 Batch 500 Loss 0.3921 Acc:0.7418
Epoch 8 Batch 600 Loss 0.4412 Acc:0.7280
Time taken for 1 epoch 406.3167 sec

Epoch 9 Batch 0 Loss 0.3029 Acc:0.8434
Epoch 9 Batch 100 Loss 0.3544 Acc:0.7959
Epoch 9 Batch 200 Loss 0.3183 Acc:0.7900
Epoch 9 Batch 300 Loss 0.3036 Acc:0.8057
Epoch 9 Batch 400 Loss 0.2649 Acc:0.7955
Epoch 9 Batch 500 Loss 0.3325 Acc:0.8065
Epoch 9 Batch 600 Loss 0.3186 Acc:0.7851
Time taken for 1 epoch 406.4001 sec

Epoch 10 Batch 0 Loss 0.2331 Acc:0.8437
Epoch 10 Batch 100 Loss 0.2692 Acc:0.8189
Epoch 10 Batch 200 Loss 0.2705 Acc:0.8256
Epoch 10 Batch 300 Loss 0.2724 Acc:0.8333
Epoch 10 Batch 400 Loss 0.3233 Acc:0.7969
Epoch 10 Batch 500 Loss 0.2822 Acc:0.8115
Epoch 10 Batch 600 Loss 0.2861 Acc:0.7984
Time taken for 1 epoch 404.6103 sec

Epoch 11 Batch 0 Loss 0.2095 Acc:0.8633
Epoch 11 Batch 100 Loss 0.2155 Acc:0.8743
Epoch 11 Batch 200 Loss 0.2788 Acc:0.8182
Epoch 11 Batch 300 Loss 0.2359 Acc:0.8660
Epoch 11 Batch 400 Loss 0.2279 Acc:0.8285
Epoch 11 Batch 500 Loss 0.2795 Acc:0.8436
Epoch 11 Batch 600 Loss 0.2480 Acc:0.8238
Time taken for 1 epoch 405.8043 sec

Epoch 12 Batch 0 Loss 0.1880 Acc:0.8763
Epoch 12 Batch 100 Loss 0.2248 Acc:0.8665
Epoch 12 Batch 200 Loss 0.2108 Acc:0.8656
Epoch 12 Batch 300 Loss 0.1966 Acc:0.8590
Epoch 12 Batch 400 Loss 0.2039 Acc:0.8560
Epoch 12 Batch 500 Loss 0.2260 Acc:0.8429
Epoch 12 Batch 600 Loss 0.2418 Acc:0.8442
Time taken for 1 epoch 404.0757 sec

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Evaluate-the-model&quot;&gt;Evaluate the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluate-the-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;When training is done, we get back the history and results, so we can explore them and plot our relevant metrics:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# plot some data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#plt.plot(results.history[&amp;#39;val_loss&amp;#39;], label=&amp;#39;val_loss&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# accuracies&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#plt.plot(results.history[&amp;#39;val_accuracy_fn&amp;#39;], label=&amp;#39;val_acc&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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I2FOPWoiIWJmZ5tZUmAI4y/xD2GcH+KwREREgqYN3uuuxN9jqGrKcsyiQh2ASBt2Av4yxtHASuDiwFBGERGRSNFm7nVm9gXQD/i205A1CQINfRQREREREWllNPRRRERERESklVGiJiIiIiIi0sqEbI5aSkqKy8zMDNXlRUSkBS1atCjPOdfQWoESoHukiEjbcKT7Y8gStczMTBYuXBiqy4uISAsys82hjiGc6B4pItI2HOn+qKGPIiIiIiIirYwSNRERERERkVZGiZqIiIiIiEgrowWvRURaWEVFBTk5OZSVlYU6lKCLjY0lLS0Nn88X6lAiTqR9bvRZERE5MiVqIiItLCcnh8TERDIzMzGzUIcTNM45du/eTU5ODr169Qp1OBEnkj43+qyIiDRMQx9FRFpYWVkZycnJYf9l+1BmRnJycsT0+LQ2kfS50WdFRKRhStREREIgEr5s1yVSX1drEUnvbyS9FhGR5qBETUSkDUpISAh1CCIiInIEStRERERERERambBN1LYXlfH8vC3s3KPx7SIiR8s5x913383QoUMZNmwYL730EgDbtm1j8uTJjBw5kqFDh/L5559TVVXFDTfccLDt//3f/4U4emlpF198MWPGjGHIkCFMmzYNgA8++IDRo0czYsQITjvtNABKSkq48cYbGTZsGMOHD+e1114LZdgi0sas2V7Mxl0loQ7jmIVt1ceNeSX8/I3l9O48kS6JsaEOR0QkLL3++ussWbKEpUuXkpeXx7hx45g8eTLPP/88Z511Fr/4xS+oqqpi3759LFmyhK1bt7JixQoACgsLQxy9tLQnn3ySTp06UVpayrhx47jooou45ZZbmDVrFr169SI/Px+AX//61yQlJbF8+XIACgoKQhm2iLQSeSXl/Obd1RzXO5krx6U3yzWqqx3X/nM+RaX7+e9T+/G9k/vg84Zn31TYJmoxUV4AyiurQxyJiMjR+9XbK1mVWxzUcw7u3p77LhjSqLZffPEF11xzDV6vl9TUVE466SQWLFjAuHHj+M53vkNFRQUXX3wxI0eOpHfv3mzcuJHbb7+d8847jzPPPDOocUvjhepz8+CDD/LGG28AkJ2dzbRp05g8efLBEvudOnUC4OOPP+bFF188eFzHjh2DGquIhJ95G3fz3y9+xY7iclbmFjVborYyt5i8knIGdk3kz9PX8cHK7fzpihEM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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Make-predictions&quot;&gt;Make predictions&lt;a class=&quot;anchor-link&quot; href=&quot;#Make-predictions&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;To restore the lastest checkpoint, saved model, you can run the following cell:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# restoring the latest checkpoint in checkpoint_dir&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./training_ckpt_seq2seq&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ckpt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In the prediction step, our input is a secuence of length one, the sos token, then we call the encoder and decoder repeatedly until we get the eos token or reach the maximum length defined.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Tokenize the input sequence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texts_to_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Pad the sentence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Set the encoder initial state&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Create the decoder input, the sos token&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;sos&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Set the decoder states to the encoder vector or encoder hidden state&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Decode and get the output probabilities&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Select the word with the highest probability&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Append the word to the predicted output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Finish when eos token is found or the max length is reached&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;eos&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It is time to show how our model works with some simple examples:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_sents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10003&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10120&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#test_sents = [encoder_inputs[1000]]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_sents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_sent&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_sents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_sent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[&amp;#39;we re not going .&amp;#39;, &amp;#39;why are you sad ?&amp;#39;]
[[ 17  24  33 111   1   0   0   0   0   0]]
no vamos . &amp;lt;eos&amp;gt;
[[ 69  22   3 326   5   0   0   0   0   0]]
¿ por que estas triste ? &amp;lt;eos&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;The-Attention-Mechanism&quot;&gt;The Attention Mechanism&lt;a class=&quot;anchor-link&quot; href=&quot;#The-Attention-Mechanism&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The previously described model based on RNNs has a serious problem when working with long sequences, because the information of the first tokens is lost or diluted as more tokens are processed. The context vector has been given the responsibility of encoding all the information in a given source sentence in to a vector of few hundred elements. it made it challenging for the models to deal with long sentences. A solution was proposed in Bahdanau et al., 2014 [4] and Luong et al., 2015,[5].&lt;/p&gt;
&lt;p&gt;They introduce a technique called &quot;Attention&quot;, which highly improved the quality of machine translation systems. Attention allows the model to focus on the relevant parts of the input sequence as needed, accessing to all the past hidden states of the encoder, instead of just the last one. At each decoding step, the decoder gets to look at any particular state of the encoder and can selectively pick out specific elements from that sequence to produce the output. We will focus on the Luong perspective.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loung-Attention-layer&quot;&gt;Loung Attention layer&lt;a class=&quot;anchor-link&quot; href=&quot;#Loung-Attention-layer&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/luong_attention.PNG&quot; alt=&quot;Alt&quot; title=&quot;Attention Mechanism by Gabriel Loye [6]&quot; /&gt;&lt;/p&gt;
&lt;p&gt;There are two relevant points to focus on:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The &lt;strong&gt;alignment vector&lt;/strong&gt;: is a vector with the same length that the input or source sequence and is computed at every time step of the decoder. Each of its values is the score (or the probability) of the corresponding word within the source sequence, they tell the decoder what to focus on at each time step.&lt;/p&gt;
&lt;p&gt;There are three ways to calculate the alingment scores:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Dot product&lt;/em&gt;: we only need to take the hidden states of the encoder and multiply them by the hidden state of the decoder&lt;/li&gt;
&lt;li&gt;&lt;em&gt;General&lt;/em&gt;: very similar to dot product but a weight matrix is included.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Concat&lt;/em&gt;: the decoder hidden state and encoder hidden states are added together first before being passed through a Linear layer with an tanh activation function and finally multiply by a weight matrix.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/formula_luong_attention.PNG&quot; alt=&quot;Alt&quot; title=&quot;Decoder output&quot; /&gt;&lt;/p&gt;
&lt;p&gt;The alignment scores are softmaxed so that the weights will be between 0 to 1.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The context vector: It's the weighted average sum of the encoder's output, the dot product of the alignment vector and the encoder's output.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;LuongAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LuongAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dot&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;general&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;concat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;s1&quot;&gt;&amp;#39;Attention score must be either dot, general or concat.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;general&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# General score function&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;concat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Concat score function&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tanh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;va&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dot&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Dot score function: decoder_output (dot) encoder_output&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# decoder_output has shape: (batch_size, 1, rnn_size)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# encoder_output has shape: (batch_size, max_len, rnn_size)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; score has shape: (batch_size, 1, max_len)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transpose_b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (batch_size, 1, max_len)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;general&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# General score function: decoder_output (dot) (Wa (dot) encoder_output)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# decoder_output has shape: (batch_size, 1, rnn_size)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# encoder_output has shape: (batch_size, max_len, rnn_size)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; score has shape: (batch_size, 1, max_len)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;transpose_b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#(batch_size, 1, max_len)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;elif&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;concat&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Concat score function: va (dot) tanh(Wa (dot) concat(decoder_output + encoder_output))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Decoder output must be broadcasted to encoder output&amp;#39;s shape first&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;decoder_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;decoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#shape (batch size, max len,hidden_dim)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# Concat =&amp;gt; Wa =&amp;gt; va&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# (batch_size, max_len, 2 * rnn_size) =&amp;gt; (batch_size, max_len, rnn_size) =&amp;gt; (batch_size, max_len, 1)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (batch_size, max len, 1)&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# Transpose score vector to have the same shape as other two above&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# (batch_size, max_len, 1) =&amp;gt; (batch_size, 1, max_len)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#(batch_size, 1, max_len)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# alignment a_t = softmax(score)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;activations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#(batch_size, 1, max_len)&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# context vector c_t is the weighted average sum of encoder output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# (batch_size, 1, hidden_dim)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Decoder-with-Attention&quot;&gt;Decoder with Attention&lt;a class=&quot;anchor-link&quot; href=&quot;#Decoder-with-Attention&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Once our Attention Class has been defined, we can create the decoder. The complete sequence of steps when calling the decoder are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Generate the encoder hidden states as usual, one for every input token&lt;/li&gt;
&lt;li&gt;Apply a RNN to produce a new hidden state, taking its previous hidden state and the target output from the previous time step&lt;/li&gt;
&lt;li&gt;Calculate the alignment scores as described previously&lt;/li&gt;
&lt;li&gt;Calculate the context vector&lt;/li&gt;
&lt;li&gt;In the last operation, the context vector is concatenated with the decoder hidden state we generated previously, then it is passed through a linear layer which acts as a classifier for us to obtain the probability scores of the next predicted word&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LuongAttention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;attention_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_sequences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;return_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tanh&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ws&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Remember that the input to the decoder&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# is now a batch of one-word sequences,&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# which means that its shape is (batch_size, 1)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Therefore, the lstm_out has shape (batch_size, 1, hidden_dim)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Use self.attention to compute the context and alignment vectors&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# context vector&amp;#39;s shape: (batch_size, 1, hidden_dim)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# alignment vector&amp;#39;s shape: (batch_size, 1, source_length)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Combine the context vector and the LSTM output&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Before combined, both have shape of (batch_size, 1, hidden_dim),&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# so let&amp;#39;s squeeze the axis 1 first&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# After combined, it will have shape of (batch_size, 2 * hidden_dim)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# lstm_out now has shape (batch_size, hidden_dim)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Finally, it is converted back to vocabulary space: (batch_size, vocab_size)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ws&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For testing purposes, we create a decoder and call it to check the output shapes:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Set the length of the input and output vocabulary&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Create the encoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EMBEDDING_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HIDDEN_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EMBEDDING_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;HIDDEN_DIM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ATTENTION_FUNC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Call the encoder and then the decoder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;initial_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoder_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;initial_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;decoder_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Train-step-function&quot;&gt;Train step function&lt;a class=&quot;anchor-link&quot; href=&quot;#Train-step-function&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we can define our step train function, to train a batch data. It is very similar to the one we coded for the seq2seq model without attention but this time we pass all the hidden states returned by the encoder to the decoder. And we need to create a loop to iterate through the target sequences, calling the decoder for each one and calculating the loss function comparing the decoder output to the expected target.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;function&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; A training step, train a batch of the data and return the loss value reached&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Input:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - input_seq: array of integers, shape [batch_size, max_seq_len, embedding dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the input sequence&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - target_seq_out: array of integers, shape [batch_size, max_seq_len, embedding dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the target seq, our target sequence&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - target_seq_in: array of integers, shape [batch_size, max_seq_len, embedding dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the input sequence to the decoder, we use Teacher Forcing&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - en_initial_states: tuple of arrays of shape [batch_size, hidden_dim].&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;            the initial state of the encoder&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - optimizer: a tf.keras.optimizers.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Output:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        - loss: loss value&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GradientTape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;en_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_states&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# We need to create a loop to iterate through the target sequences&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Input to the decoder must have shape of (batch_size, length)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# so we need to expand one dimension&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;decoder_in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;logit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;decoder_in&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;# The loss is now accumulated through the whole batch&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_func&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Store the logits to calculate the accuracy&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;logit&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logit&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;K&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;concatenate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Calculate the accuracy for the batch data        &lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Update the parameters and the optimizer&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;trainable_variables&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;gradients&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gradient&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;apply_gradients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gradients&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;variables&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq_out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Main-train&quot;&gt;Main train&lt;a class=&quot;anchor-link&quot; href=&quot;#Main-train&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create an Adam optimizer and clips gradients by norm&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clipnorm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create a checkpoint object to save the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./training_ckpt_seq2seq_att&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ckpt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BATCH_SIZE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 1 Batch 0 Loss 3.0794 Acc:0.0000
Epoch 1 Batch 100 Loss 1.5153 Acc:0.4106
Epoch 1 Batch 200 Loss 1.3571 Acc:0.4490
Epoch 1 Batch 300 Loss 1.1166 Acc:0.5296
Time taken for 1 epoch 682.8766 sec

Epoch 2 Batch 0 Loss 1.1873 Acc:0.4848
Epoch 2 Batch 100 Loss 0.9923 Acc:0.5562
Epoch 2 Batch 200 Loss 1.0025 Acc:0.5470
Epoch 2 Batch 300 Loss 1.0277 Acc:0.5510
Time taken for 1 epoch 656.4251 sec

Epoch 3 Batch 0 Loss 0.8298 Acc:0.5680
Epoch 3 Batch 100 Loss 0.7965 Acc:0.6073
Epoch 3 Batch 200 Loss 0.8324 Acc:0.6023
Epoch 3 Batch 300 Loss 0.8243 Acc:0.6059
Time taken for 1 epoch 650.9733 sec

Epoch 4 Batch 0 Loss 0.6563 Acc:0.6423
Epoch 4 Batch 100 Loss 0.6277 Acc:0.6714
Epoch 4 Batch 200 Loss 0.6086 Acc:0.6497
Epoch 4 Batch 300 Loss 0.5977 Acc:0.6833
Time taken for 1 epoch 657.5127 sec

Epoch 5 Batch 0 Loss 0.4388 Acc:0.7050
Epoch 5 Batch 100 Loss 0.5328 Acc:0.6919
Epoch 5 Batch 200 Loss 0.5073 Acc:0.6619
Epoch 5 Batch 300 Loss 0.4655 Acc:0.6946
Time taken for 1 epoch 655.9225 sec

Epoch 6 Batch 0 Loss 0.3079 Acc:0.7917
Epoch 6 Batch 100 Loss 0.4277 Acc:0.7337
Epoch 6 Batch 200 Loss 0.4378 Acc:0.7390
Epoch 6 Batch 300 Loss 0.3456 Acc:0.7735
Time taken for 1 epoch 658.4363 sec

Epoch 7 Batch 0 Loss 0.2302 Acc:0.8353
Epoch 7 Batch 100 Loss 0.2826 Acc:0.7977
Epoch 7 Batch 200 Loss 0.2620 Acc:0.7975
Epoch 7 Batch 300 Loss 0.3166 Acc:0.7826
Time taken for 1 epoch 644.7999 sec

Epoch 8 Batch 0 Loss 0.2196 Acc:0.8529
Epoch 8 Batch 100 Loss 0.2533 Acc:0.8128
Epoch 8 Batch 200 Loss 0.2885 Acc:0.7924
Epoch 8 Batch 300 Loss 0.3511 Acc:0.8093
Time taken for 1 epoch 650.8827 sec

Epoch 9 Batch 0 Loss 0.1434 Acc:0.8690
Epoch 9 Batch 100 Loss 0.2054 Acc:0.8629
Epoch 9 Batch 200 Loss 0.2266 Acc:0.8220
Epoch 9 Batch 300 Loss 0.1910 Acc:0.8663
Time taken for 1 epoch 645.2892 sec

Epoch 10 Batch 0 Loss 0.1330 Acc:0.8950
Epoch 10 Batch 100 Loss 0.1828 Acc:0.8692
Epoch 10 Batch 200 Loss 0.1890 Acc:0.8563
Epoch 10 Batch 300 Loss 0.1998 Acc:0.8806
Time taken for 1 epoch 650.5875 sec

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Evaluate-the-model&quot;&gt;Evaluate the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluate-the-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;When training is done, we can plot the losses and accuracies obtained during training:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplots&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# plot some data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#plt.plot(results.history[&amp;#39;val_loss&amp;#39;], label=&amp;#39;val_loss&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# accuracies&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;acc&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#plt.plot(results.history[&amp;#39;val_accuracy_fn&amp;#39;], label=&amp;#39;val_acc&amp;#39;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Training Accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ax2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Prediction-or-inference&quot;&gt;Prediction or inference&lt;a class=&quot;anchor-link&quot; href=&quot;#Prediction-or-inference&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We can restore the latest checkpoint of our model before making some predictions:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create an Adam optimizer and clips gradients by norm&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keras&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clipnorm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create a checkpoint object to save the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;./training_ckpt_seq2seq_att&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;ckpt&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                 &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;latest_checkpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;checkpoint_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;tensorflow.python.training.tracking.util.CheckpointLoadStatus at 0x7f5916e835f8&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict_seq2seq_att&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;choice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))]&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Tokenize the input text&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texts_to_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Pad the sentence&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_sequences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;post&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Get the encoder initial states&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Get the encoder outputs or hidden states&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_initial_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Set the decoder input to the sos token&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;constant&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;sos&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Set the initial hidden states of the decoder to the hidden states of the encoder&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alignments&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Get the decoder with attention output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_state_h&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;de_state_c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;en_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expand_dims&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Detokenize the output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;de_input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Save the aligment matrix&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;alignments&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alignment&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;eos&amp;gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Join the output words&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alignments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_words&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;It is time to test out model, making some predictions or doing some translation from english to spanish&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_predictions&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_sents&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;15005&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the figure to plot in&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_sent&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_sents&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Call the predict function to get the translation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;alignments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict_seq2seq_att&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_sent&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_max_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizer_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                                                     &lt;span class=&quot;n&quot;&gt;word2idx_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx2word_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;squeeze&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;alignments&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Create a subplot&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fig&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_predictions&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attention&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;viridis&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_xticklabels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rotation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;90&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ax&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_yticklabels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prediction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;she got him drunk .
ella le emborracho . &amp;lt;eos&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Character-level Text Generator using Pytorch and Amazon SageMaker</title><link href="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/lstm/pytorch/sagemaker/2020/09/06/char-level-text-generator-pytorch-SageMaker.html" rel="alternate" type="text/html" title="Character-level Text Generator using Pytorch and Amazon SageMaker" /><published>2020-09-06T00:00:00-05:00</published><updated>2020-09-06T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/lstm/pytorch/sagemaker/2020/09/06/char-level-text-generator-pytorch-SageMaker</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/lstm/pytorch/sagemaker/2020/09/06/char-level-text-generator-pytorch-SageMaker.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-09-06-char-level-text-generator-pytorch-SageMaker.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Character-level-text-generator-with-Pytorch&quot;&gt;Character-level text generator with Pytorch&lt;a class=&quot;anchor-link&quot; href=&quot;#Character-level-text-generator-with-Pytorch&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h2 id=&quot;Using-PyTorch-and-SageMaker&quot;&gt;Using PyTorch and SageMaker&lt;a class=&quot;anchor-link&quot; href=&quot;#Using-PyTorch-and-SageMaker&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Some parts of the notebook have been extracted or modified from a notebook of my exercises in the Machine Learning Egineer Nanodegree.&lt;/p&gt;
&lt;p&gt;In this notebook we will be implementing a simple RNN character model with PyTorch to familiarize ourselves with the PyTorch library and get started with RNNs. The goal is to build a model that can complete your sentence based on a few characters or a word used as input. And we will use AWS Sagemaker to train the model, evaluate and deploy.&lt;/p&gt;
&lt;h2 id=&quot;General-Outline&quot;&gt;General Outline&lt;a class=&quot;anchor-link&quot; href=&quot;#General-Outline&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Recall the general outline for SageMaker projects using a notebook instance.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Download or otherwise retrieve the data.&lt;/li&gt;
&lt;li&gt;Process / Prepare the data.&lt;/li&gt;
&lt;li&gt;Upload the processed data to S3.&lt;/li&gt;
&lt;li&gt;Train a chosen model.&lt;/li&gt;
&lt;li&gt;Test the trained model (typically using a batch transform job).&lt;/li&gt;
&lt;li&gt;Deploy the trained model.&lt;/li&gt;
&lt;li&gt;Use the deployed model.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;For this project, you will be following the steps in the general outline with some modifications.&lt;/p&gt;
&lt;p&gt;First, we will not be testing the model in its own step. We will still be testing the model, however, we will do it by deploying your model and then using the deployed model by sending the test data to it. One of the reasons for doing this is so that we can make sure that our deployed model is working correctly before moving forward.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Loading-the-libraries&quot;&gt;Loading the libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-libraries&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;rnd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-1:-Downloading-and-loading-the-data&quot;&gt;Step 1: Downloading and loading the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-1:-Downloading-and-loading-the-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;First, we'll define the sentences that we want our model to output when fed with the first word or the first few characters. Our dataset is a text file containing Shakespeare's plays or books from which we will extract sequence of chars to use as input to our model. Then our model will learn how to complete sentences like &quot;Shakespeare would do&quot;.&lt;/p&gt;
&lt;p&gt;This dataset can be downloaded from Karpathy's Github account: &lt;a href=&quot;https://github.com/karpathy/char-rnn/blob/master/data/tinyshakespeare/input.txt&quot;&gt;https://github.com/karpathy/char-rnn/blob/master/data/tinyshakespeare/input.txt&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The dataset is stored in our notebook instance, it is small and easy to &quot;move&quot;, so we do not need to store it in S3 or other cloud storage service.&lt;/p&gt;
&lt;p&gt;As in many of my notebooks, we set some variables to the data directory and filenames. If you want to run this code on your own enviroment you must change these values:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the root folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the folder with the dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the filename&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;input.txt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Path to the data folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set the path where the text for training is stored&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set a seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;load_text_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_dialog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Load the texts from the filename, splitting by lines and removing empty strings.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Setting init_dialog = True will remove lines where the character who is going to speak is indicated&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#sentences = reader.readlines()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#if &amp;#39;:&amp;#39; not in line and line !=&amp;#39;\n&amp;#39;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_dialog&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# Append the line to the sentences, removing the end of line character&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
                
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Loading the input data, sentences from Shakespeare's plays.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_text_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of sentences: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of sentences:  29723
[&amp;#39;Before we proceed any further, hear me speak.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;Speak, speak.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;You are all resolved rather to die than to famish?&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;Resolved. resolved.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;First, you know Caius Marcius is chief enemy to the people.&amp;#39;, &amp;#39;&amp;#39;, &amp;#34;We know&amp;#39;t, we know&amp;#39;t.&amp;#34;, &amp;#39;&amp;#39;, &amp;#34;Let us kill him, and we&amp;#39;ll have corn at our own price.&amp;#34;, &amp;#34;Is&amp;#39;t a verdict?&amp;#34;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;One word, good citizens.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;We are accounted poor citizens, the patricians good.&amp;#39;, &amp;#39;would yield us but the superfluity, while it were&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-2:-Preparing-and-Processing-the-data&quot;&gt;Step 2: Preparing and Processing the data&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-2:-Preparing-and-Processing-the-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Also, we will be doing some initial data processing. The first few steps are the same as in many other notebooks that works in NLP tasks. To begin with, we will read in each of the lines and combine them into a single input structure.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Cleaning-the-input-data&quot;&gt;Cleaning the input data&lt;a class=&quot;anchor-link&quot; href=&quot;#Cleaning-the-input-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;When working with text data, we usually need to perform some cleanings to prepare the data for our algorithm. This time we will start with a simple cleaning, convert to lowercase the text and that's all.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;clean_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Cleaning process of the text&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Remove non alphabetic character&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isalpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Simply lower the characters&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Remove any emoty string&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clean_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Join all the sentences in a one long string&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of characters: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of characters:  894876
before we proceed any further, hear me speak. speak, speak. you are all resolved rather to die than 
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Our input data is a sequence of 900,000 characters, we will extract the label data from this sequence and split it into a train and validation dataset. But we will do this tasks after encoding the text data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creating-the-dictionary&quot;&gt;Creating the dictionary&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-the-dictionary&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we'll create a dictionary out of all the characters that we have in the sentences and map them to an integer. This will allow us to convert our input characters to their respective integers (char2int) and viceversa (int2char).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CharVocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Create a Vocabulary for &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;PAD&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;EOS&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unk_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Initialization of the type of vocabulary&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type_vocab&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#self.int2char ={}&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unk_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unk_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#self.int2char[1]=eos_token&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#self.int2char[2]=unk_token&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;#When called, adds the values of parameters x_1 and x_2, prints and returns the result &lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Join all the sentences together and extract the unique characters from the combined sentences&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Creating a dictionary that maps integers to the characters&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Creating another dictionary that maps characters to integers&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ind&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
        
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CharVocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;char&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Length of vocabulary: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Int to Char: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Char to Int: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Length of vocabulary:  38
Int to Char:  [&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;, &amp;#39;a&amp;#39;, &amp;#39;n&amp;#39;, &amp;#39;-&amp;#39;, &amp;#39;h&amp;#39;, &amp;#39;!&amp;#39;, &amp;#39;i&amp;#39;, &amp;#39;j&amp;#39;, &amp;#39;d&amp;#39;, &amp;#39;.&amp;#39;, &amp;#39;f&amp;#39;, &amp;#39;x&amp;#39;, &amp;#39;k&amp;#39;, &amp;#39;w&amp;#39;, &amp;#39;3&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;l&amp;#39;, &amp;#39;q&amp;#39;, &amp;#39; &amp;#39;, &amp;#39;u&amp;#39;, &amp;#39;&amp;amp;&amp;#39;, &amp;#39;,&amp;#39;, &amp;#39;$&amp;#39;, &amp;#39;t&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;m&amp;#39;, &amp;#39;p&amp;#39;, &amp;#39;;&amp;#39;, &amp;#39;z&amp;#39;, &amp;#39;g&amp;#39;, &amp;#39;r&amp;#39;, &amp;#39;s&amp;#39;, &amp;#39;?&amp;#39;, &amp;#34;&amp;#39;&amp;#34;, &amp;#39;e&amp;#39;, &amp;#39;v&amp;#39;, &amp;#39;o&amp;#39;, &amp;#39;y&amp;#39;]
Char to Int:  {&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;: 0, &amp;#39;a&amp;#39;: 1, &amp;#39;n&amp;#39;: 2, &amp;#39;-&amp;#39;: 3, &amp;#39;h&amp;#39;: 4, &amp;#39;!&amp;#39;: 5, &amp;#39;i&amp;#39;: 6, &amp;#39;j&amp;#39;: 7, &amp;#39;d&amp;#39;: 8, &amp;#39;.&amp;#39;: 9, &amp;#39;f&amp;#39;: 10, &amp;#39;x&amp;#39;: 11, &amp;#39;k&amp;#39;: 12, &amp;#39;w&amp;#39;: 13, &amp;#39;3&amp;#39;: 14, &amp;#39;c&amp;#39;: 15, &amp;#39;l&amp;#39;: 16, &amp;#39;q&amp;#39;: 17, &amp;#39; &amp;#39;: 18, &amp;#39;u&amp;#39;: 19, &amp;#39;&amp;amp;&amp;#39;: 20, &amp;#39;,&amp;#39;: 21, &amp;#39;$&amp;#39;: 22, &amp;#39;t&amp;#39;: 23, &amp;#39;b&amp;#39;: 24, &amp;#39;m&amp;#39;: 25, &amp;#39;p&amp;#39;: 26, &amp;#39;;&amp;#39;: 27, &amp;#39;z&amp;#39;: 28, &amp;#39;g&amp;#39;: 29, &amp;#39;r&amp;#39;: 30, &amp;#39;s&amp;#39;: 31, &amp;#39;?&amp;#39;: 32, &amp;#34;&amp;#39;&amp;#34;: 33, &amp;#39;e&amp;#39;: 34, &amp;#39;v&amp;#39;: 35, &amp;#39;o&amp;#39;: 36, &amp;#39;y&amp;#39;: 37}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Save-the-dictionary&quot;&gt;Save the dictionary&lt;a class=&quot;anchor-link&quot; href=&quot;#Save-the-dictionary&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this example it is not mandatory to save the dictionary inmediately, because it is a fast and easy to reproduce task. But when dealing with a huge corpus and a large dictionary, we should save the dictionary to restore it latter when new experiments will be executed.&lt;/p&gt;
&lt;p&gt;Later on when we construct an endpoint which processes a submitted review we will need to make use of the char2int and int2char dictionaries which we have created. As such, we will save them to a file now for future use.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Check or create the directory where dictionary will be saved&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Make sure that the folder exists&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;makedirs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Save the dictionary to data path dir  &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;char_dict.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;int_dict.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Create-the-input-data-and-labels-for-training&quot;&gt;Create the input data and labels for training&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-input-data-and-labels-for-training&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;As we're going to predict the next character in the sequence at each time step, we'll have to divide each sentence into:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Input data&lt;/strong&gt;: The last input character should be excluded as it does not need to be fed into the model (it is the target label for the last input character)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Target/Ground Truth Label&lt;/strong&gt;: One time-step ahead of the Input data as this will be the &quot;correct answer&quot; for the model at each time step corresponding to the input data&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Define one hot encode matrix for our sequences&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Creating a multi-dimensional array with the desired output shape&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Encode every integer with its one hot representation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eye&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Finally reshape it to get back to the original array&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encode_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Replace every char by its integer value based on the vocabulary&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# One hot encode every integer of the sequence&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, we can encode our text, replacing every character by the integer value in the dictionary. When we have our dataset unified and prepared, we should do a quick check and see an example of the data our model will be trained on. This is generally a good idea as it allows you to see how each of the further processing steps affects the reviews and it also ensures that the data has been loaded correctly.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Encode the train dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encode_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the input sequence, from 0 to len-1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the target sequence, from 1 to len. It is right-shifted one place&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Original text:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Encoded text:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Input sequence:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Target sequence:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;
Original text:
before we proceed any further, hear me speak. speak, speak. you are all resolved rather to die than 

Encoded text:
[24 34 10 36 30 34 18 13 34 18 26 30 36 15 34 34  8 18  1  2 37 18 10 19
 30 23  4 34 30 21 18  4 34  1 30 18 25 34 18 31 26 34  1 12  9 18 31 26
 34  1 12 21 18 31 26 34  1 12  9 18 37 36 19 18  1 30 34 18  1 16 16 18
 30 34 31 36 16 35 34  8 18 30  1 23  4 34 30 18 23 36 18  8  6 34 18 23
  4  1  2 18]

Input sequence:
[24 34 10 36 30 34 18 13 34 18 26 30 36 15 34 34  8 18  1  2 37 18 10 19
 30 23  4 34 30 21 18  4 34  1 30 18 25 34 18 31 26 34  1 12  9 18 31 26
 34  1 12 21 18 31 26 34  1 12  9 18 37 36 19 18  1 30 34 18  1 16 16 18
 30 34 31 36 16 35 34  8 18 30  1 23  4 34 30 18 23 36 18  8  6 34 18 23
  4  1  2 18]

Target sequence:
[34 10 36 30 34 18 13 34 18 26 30 36 15 34 34  8 18  1  2 37 18 10 19 30
 23  4 34 30 21 18  4 34  1 30 18 25 34 18 31 26 34  1 12  9 18 31 26 34
  1 12 21 18 31 26 34  1 12  9 18 37 36 19 18  1 30 34 18  1 16 16 18 30
 34 31 36 16 35 34  8 18 30  1 23  4 34 30 18 23 36 18  8  6 34 18 23  4
  1  2 18 23]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Lets check our one-hot-encode function that we will use later during the training phase:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Encoded characters: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;102&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;One-hot-encoded characters: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;102&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Encoded characters:  [23 36]
One-hot-encoded characters:  [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-3:-Upload-the-data-to-S3&quot;&gt;Step 3: Upload the data to S3&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-3:-Upload-the-data-to-S3&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now, we will need to upload the training dataset to S3 in order for our training code to access it. For now we will save it locally and we will upload to S3 later on.&lt;/p&gt;
&lt;h3 id=&quot;Save-the-processed-training-dataset-locally&quot;&gt;Save the processed training dataset locally&lt;a class=&quot;anchor-link&quot; href=&quot;#Save-the-processed-training-dataset-locally&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;It is important to note the format of the data that we are saving as we will need to know it when we write the training code. In our case, we will save the dataset as a pickle object, it is a list containing the whole dataset encoded as an integer value for every character.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Save the encoded text to a file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoded_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;input_data.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoded_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Uploading-the-training-data&quot;&gt;Uploading the training data&lt;a class=&quot;anchor-link&quot; href=&quot;#Uploading-the-training-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Next, we need to upload the training data to the SageMaker default S3 bucket so that we can provide access to it while training our model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Get the session id &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the bucet, in our example the default buack&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;default_bucket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the S3 subfolder where our data will be stored &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sagemaker/char_level_rnn&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the role for permission&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;role&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_execution_role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upload_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bucket&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key_prefix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prefix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; The cell above uploads the entire contents of our data directory. This includes the &lt;code&gt;char_dict.pkl&lt;/code&gt; and &lt;code&gt;int_dict.pkl&lt;/code&gt; file. This is fortunate as we will need this later on when we create an endpoint that accepts an arbitrary input text. For now, we will just take note of the fact that it resides in the data directory (and so also in the S3 training bucket) and that we will need to make sure it gets saved in the model directory.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-4:-Build-and-Train-the-PyTorch-Model&quot;&gt;Step 4: Build and Train the PyTorch Model&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-4:-Build-and-Train-the-PyTorch-Model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A model in the SageMaker framework, in particular, comprises three objects:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Model Artifacts,&lt;/li&gt;
&lt;li&gt;Training Code, and&lt;/li&gt;
&lt;li&gt;Inference Code,&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;each of which interact with one another.&lt;/p&gt;
&lt;p&gt;We will start by implementing our own neural network in PyTorch along with a training script. For the purposes of this project we need to provide the model object implementation in the &lt;code&gt;model.py&lt;/code&gt; file, inside of the &lt;code&gt;train&lt;/code&gt; folder. You can see the provided implementation by running the cell below.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pygmentize train/model.py
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; nn
&lt;span class=&quot;ansi-blue-fg&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;autograd&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; Variable

&lt;span class=&quot;ansi-blue-fg&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;ansi-green-fg ansi-underline&quot;&gt;RNNModel&lt;/span&gt;(nn.Module):
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;__init__&lt;/span&gt;(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;, vocab_size, embedding_size, hidden_dim, n_layers, drop_rate=&lt;span class=&quot;ansi-blue-fg&quot;&gt;0.2&lt;/span&gt;):
        
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;super&lt;/span&gt;(RNNModel, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;).&lt;span class=&quot;ansi-green-fg&quot;&gt;__init__&lt;/span&gt;()

        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Defining some parameters&lt;/span&gt;
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.hidden_dim = hidden_dim
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.embedding_size = embedding_size
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.n_layers = n_layers
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.vocab_size = vocab_size
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.drop_rate = drop_rate
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.char2int = &lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.int2char = &lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;


        &lt;span class=&quot;ansi-white-fg&quot;&gt;#Defining the layers&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Define the encoder as an Embedding layer&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#self.encoder = nn.Embedding(vocab_size, embedding_size)&lt;/span&gt;
            
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Dropout layer&lt;/span&gt;
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.dropout = nn.Dropout(drop_rate)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# RNN Layer&lt;/span&gt;
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.rnn = nn.LSTM(embedding_size, hidden_dim, n_layers, dropout=drop_rate, batch_first = &lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Fully connected layer&lt;/span&gt;
        &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.decoder = nn.Linear(hidden_dim, vocab_size)
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;forward&lt;/span&gt;(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;, x, state):
        
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# input shape: [batch_size, seq_len, embedding_size]&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Apply the embedding layer and dropout&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#embed_seq = self.dropout(self.encoder(x))&lt;/span&gt;
            
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(&amp;#39;Input RNN shape: &amp;#39;, embed_seq.shape)&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# shape: [batch_size, seq_len, embedding_size]&lt;/span&gt;
        rnn_out, state = &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.rnn(x, state)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(&amp;#39;Out RNN shape: &amp;#39;, rnn_out.shape)&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# rnn_out shape: [batch_size, seq_len, rnn_size]&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# hidden shape: [2, num_layers, batch_size, rnn_size]&lt;/span&gt;
        rnn_out = &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.dropout(rnn_out)

        &lt;span class=&quot;ansi-white-fg&quot;&gt;# shape: [seq_len, batch_size, rnn_size]&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Stack up LSTM outputs using view&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# you may need to use contiguous to reshape the output&lt;/span&gt;
        rnn_out = rnn_out.contiguous().view(-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.hidden_dim)

        logits = &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.decoder(rnn_out)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# output shape: [seq_len * batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(&amp;#39;Output model shape: &amp;#39;, logits.shape)&lt;/span&gt;
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; logits, state
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;init_state&lt;/span&gt;(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;, device, batch_size=&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;):
        &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&quot;ansi-yellow-fg&quot;&gt;        initialises rnn states.&lt;/span&gt;
&lt;span class=&quot;ansi-yellow-fg&quot;&gt;        &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#return (Variable(torch.zeros(self.n_layers, batch_size, self.hidden_dim)),&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#        Variable(torch.zeros(self.n_layers, batch_size, self.hidden_dim)))&lt;/span&gt;
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; (torch.zeros(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.n_layers, batch_size, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.hidden_dim).to(device),
                torch.zeros(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.n_layers, batch_size, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.hidden_dim).to(device))

    &lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;predict&lt;/span&gt;(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;input&lt;/span&gt;):
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# input shape: [seq_len, batch_size]&lt;/span&gt;
        logits, hidden = &lt;span class=&quot;ansi-cyan-fg&quot;&gt;self&lt;/span&gt;.forward(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;input&lt;/span&gt;)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# logits shape: [seq_len * batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# hidden shape: [2, num_layers, batch_size, rnn_size]&lt;/span&gt;
        probs = F.softmax(logits)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# shape: [seq_len * batch_size, vocab_size]&lt;/span&gt;
        probs = probs.view(&lt;span class=&quot;ansi-cyan-fg&quot;&gt;input&lt;/span&gt;.size(&lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;), &lt;span class=&quot;ansi-cyan-fg&quot;&gt;input&lt;/span&gt;.size(&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;), probs.size(&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;))
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# output shape: [seq_len, batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; probs, hidden
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-a-batch-data-generator&quot;&gt;Create a batch data generator&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-a-batch-data-generator&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;When training on the dataset, we need to extract a batch size examples from the inputs and targets, forward and backward the RNN on them and then repite the iteration with another batch size examples. A batch generator will help us to extract a batch size examples from our datasets.&lt;/p&gt;
&lt;p&gt;The next code defines our batch generator:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;batch_generator_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Generator function that yields batches of data (input and target)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    Args:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        batch_size (int): number of examples (in this case, sentences) per batch.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        max_length (int): maximum length of the output tensor.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        NOTE: max_length includes the end-of-sentence character that will be added&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;                to the tensor.  &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;                Keep in mind that the length of the tensor is always 1 + the length&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;                of the original line of characters.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        input_lines (list): list of the input data to group into batches.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        target_lines (list): list of the target data to group into batches.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        shuffle (bool, optional): True if the generator should generate random batches of data. Defaults to True.&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    Yields:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        tuple: two copies of the batch and the mask &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# calculate the number of batches we can supply&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;No batches created. Use smaller batch size or sequence length.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# calculate effective length of text to use&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rounded_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reshape the features matrix in batch size x num_batches * seq_len&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Reshape the target matrix in batch size x num_batches * seq_len&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# roll so that no need to reset rnn states over epochs&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Writing-the-training-method&quot;&gt;Writing the training method&lt;a class=&quot;anchor-link&quot; href=&quot;#Writing-the-training-method&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Next we need to write the training code itself. This should be very similar to training methods that you have written before to train PyTorch models. We will leave any difficult aspects such as model saving / loading and parameter loading until a little later.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Training Run&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;start_time&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Store the loss in every batch iteration&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Init the hidden state&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Train all the batches in every epoch&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Batch :&amp;#39;, i)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Get the next batch data for input and target&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Onr hot encode the input data&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Tranform to tensor&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Create a new variable for the hidden state, necessary to calculate the gradients&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;tuple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the input data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Input shape: &amp;#39;, input_data.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Hidden shape: &amp;#39;, hidden[0].shape, hidden[1].shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Set the model to train and prepare the gradients&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Clears existing gradients from previous epoch&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Pass Fordward the RNN&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the target data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(loss)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Save the loss&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#data[0]&lt;/span&gt;
        
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Does backpropagation and calculates gradients&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# clip gradient norm&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clip_grad_norm_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Updates the weights accordingly&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;# Now, when epoch is finished, evaluate the model on validation data&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Get the next batch data for input and target&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Onr hot encode the input data&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Tranform to tensor&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Create a new variable for the hidden state, necessary to calculate the gradients&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;tuple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the input data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Pass Fordward the RNN&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the target data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(loss)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Save the loss&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#data[0]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;                  
        &lt;span class=&quot;c1&quot;&gt;#if epoch%2 == 0:&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Epoch: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.............&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Time: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start_time&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Train Loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Val Loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Supposing we have the training method above, we will test that it is working by writing a bit of code in the notebook that executes our training method on a small sample training set. Because we are not using a GPU and we are just testing the training code we take 50,000 characters from the input data. The reason for doing this in the notebook is so that we have an opportunity to fix any errors that arise early when they are easier to diagnose.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.autograd&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tqdm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;train.model&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RNNModel&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set a seed to reproduce experiments&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the device for training&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;cuda&amp;quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;cpu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RNNModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define Loss, Optimizer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Limit the size of our input sequence for this simple test&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;50000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Calculate the number of batches to train&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Calculate the validation batches&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_frac&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_frac&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the batch data generator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_generator_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Train the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch: 1/5............. Time: 0.3447 Train Loss: 3.2359 Val Loss: 2.9530
Epoch: 2/5............. Time: 0.3499 Train Loss: 2.9400 Val Loss: 2.8528
Epoch: 3/5............. Time: 0.3474 Train Loss: 2.7989 Val Loss: 2.6553
Epoch: 4/5............. Time: 0.3487 Train Loss: 2.6213 Val Loss: 2.4888
Epoch: 5/5............. Time: 0.3474 Train Loss: 2.5100 Val Loss: 2.3986
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In order to construct a PyTorch model using SageMaker we must provide SageMaker with a training script. We may optionally include a directory which will be copied to the container and from which our training code will be run. When the training container is executed it will check the uploaded directory (if there is one) for a &lt;code&gt;requirements.txt&lt;/code&gt; file and install any required Python libraries, after which the training script will be run.&lt;/p&gt;
&lt;p&gt;In this example, we only requiere the numpy package.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Training-the-model&quot;&gt;Training the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-the-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;When a PyTorch model is constructed in SageMaker, an entry point must be specified. This is the Python file which will be executed when the model is trained. Inside of the &lt;code&gt;train&lt;/code&gt; directory is a file called &lt;code&gt;train.py&lt;/code&gt; which contains most of the necessary code to train our model.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTICE&lt;/strong&gt;: The &lt;code&gt;train()&lt;/code&gt; method written above and has been pasted into the &lt;code&gt;train/train.py&lt;/code&gt; file where required.&lt;/p&gt;
&lt;p&gt;The way that SageMaker passes hyperparameters to the training script is by way of arguments. These arguments can then be parsed and used in the training script. To see how this is done take a look at the provided &lt;code&gt;train/train.py&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;First, we need to set which type of instance will run our training:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Local: We do not launch a real compute instance, just a container where our scripts will run. This scenario is very useful to test that the train script is working fine because it is faster to run a container than an compute instance. But finally, when we confirm that everything is working we must change the instance type for a &quot;real&quot; training instance.&lt;/li&gt;
&lt;li&gt;ml.m4.4xlarge: It is a CPU instance&lt;/li&gt;
&lt;li&gt;ml.p2.xlarge: A GPU instance to use when managing a big volume of data to train on.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Select the type of instance to use for training&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;ml.m4.4xlarge&amp;#39; # CPU instance&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ml.p2.xlarge&amp;#39;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# GPU instance&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#instance_type=&amp;#39;local&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker.pytorch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyTorch&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyTorch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train.py&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;source_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;framework_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;0.4.0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;train_instance_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;train_instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;hyperparameters&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;epochs&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;hidden_dim&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;512&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                        &lt;span class=&quot;s1&quot;&gt;&amp;#39;n_layers&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;training&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;&amp;#39;create_image_uri&amp;#39; will be deprecated in favor of &amp;#39;ImageURIProvider&amp;#39; class in SageMaker Python SDK v2.
&amp;#39;s3_input&amp;#39; class will be renamed to &amp;#39;TrainingInput&amp;#39; in SageMaker Python SDK v2.
&amp;#39;create_image_uri&amp;#39; will be deprecated in favor of &amp;#39;ImageURIProvider&amp;#39; class in SageMaker Python SDK v2.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;2020-09-04 18:09:13 Starting - Starting the training job...
2020-09-04 18:09:15 Starting - Launching requested ML instances......
2020-09-04 18:10:30 Starting - Preparing the instances for training.........
2020-09-04 18:12:11 Downloading - Downloading input data......
2020-09-04 18:13:01 Training - Downloading the training image..&lt;span class=&quot;ansi-blue-fg&quot;&gt;bash: cannot set terminal process group (-1): Inappropriate ioctl for device&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;bash: no job control in this shell&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:23,643 sagemaker-containers INFO     Imported framework sagemaker_pytorch_container.training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:23,671 sagemaker_pytorch_container.training INFO     Block until all host DNS lookups succeed.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:26,690 sagemaker_pytorch_container.training INFO     Invoking user training script.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:27,188 sagemaker-containers INFO     Module train does not provide a setup.py. &lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Generating setup.py&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:27,189 sagemaker-containers INFO     Generating setup.cfg&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:27,189 sagemaker-containers INFO     Generating MANIFEST.in&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:27,189 sagemaker-containers INFO     Installing module with the following command:&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/usr/bin/python -m pip install -U . -r requirements.txt&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Processing /opt/ml/code&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting numpy (from -r requirements.txt (line 1))&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Downloading https://files.pythonhosted.org/packages/b5/36/88723426b4ff576809fec7d73594fe17a35c27f8d01f93637637a29ae25b/numpy-1.18.5-cp35-cp35m-manylinux1_x86_64.whl (19.9MB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Building wheels for collected packages: train
  Running setup.py bdist_wheel for train: started&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Running setup.py bdist_wheel for train: finished with status &amp;#39;done&amp;#39;
  Stored in directory: /tmp/pip-ephem-wheel-cache-7uiumycw/wheels/35/24/16/37574d11bf9bde50616c67372a334f94fa8356bc7164af8ca3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully built train&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Installing collected packages: numpy, train
  Found existing installation: numpy 1.15.4
    Uninstalling numpy-1.15.4:&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;      Successfully uninstalled numpy-1.15.4&lt;/span&gt;

2020-09-04 18:13:22 Training - Training image download completed. Training in progress.&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully installed numpy-1.18.5 train-1.0.0&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;You are using pip version 18.1, however version 20.2.2 is available.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;You should consider upgrading via the &amp;#39;pip install --upgrade pip&amp;#39; command.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:13:34,112 sagemaker-containers INFO     Invoking user script
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Training Env:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;{
    &amp;#34;num_gpus&amp;#34;: 1,
    &amp;#34;resource_config&amp;#34;: {
        &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;,
        &amp;#34;hosts&amp;#34;: [
            &amp;#34;algo-1&amp;#34;
        ],
        &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;
    },
    &amp;#34;input_data_config&amp;#34;: {
        &amp;#34;training&amp;#34;: {
            &amp;#34;S3DistributionType&amp;#34;: &amp;#34;FullyReplicated&amp;#34;,
            &amp;#34;TrainingInputMode&amp;#34;: &amp;#34;File&amp;#34;,
            &amp;#34;RecordWrapperType&amp;#34;: &amp;#34;None&amp;#34;
        }
    },
    &amp;#34;model_dir&amp;#34;: &amp;#34;/opt/ml/model&amp;#34;,
    &amp;#34;output_data_dir&amp;#34;: &amp;#34;/opt/ml/output/data&amp;#34;,
    &amp;#34;module_name&amp;#34;: &amp;#34;train&amp;#34;,
    &amp;#34;hosts&amp;#34;: [
        &amp;#34;algo-1&amp;#34;
    ],
    &amp;#34;framework_module&amp;#34;: &amp;#34;sagemaker_pytorch_container.training:main&amp;#34;,
    &amp;#34;module_dir&amp;#34;: &amp;#34;s3://sagemaker-us-east-1-223817798831/sagemaker-pytorch-2020-09-04-18-09-12-678/source/sourcedir.tar.gz&amp;#34;,
    &amp;#34;output_dir&amp;#34;: &amp;#34;/opt/ml/output&amp;#34;,
    &amp;#34;channel_input_dirs&amp;#34;: {
        &amp;#34;training&amp;#34;: &amp;#34;/opt/ml/input/data/training&amp;#34;
    },
    &amp;#34;num_cpus&amp;#34;: 4,
    &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;,
    &amp;#34;input_dir&amp;#34;: &amp;#34;/opt/ml/input&amp;#34;,
    &amp;#34;log_level&amp;#34;: 20,
    &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;,
    &amp;#34;user_entry_point&amp;#34;: &amp;#34;train.py&amp;#34;,
    &amp;#34;job_name&amp;#34;: &amp;#34;sagemaker-pytorch-2020-09-04-18-09-12-678&amp;#34;,
    &amp;#34;output_intermediate_dir&amp;#34;: &amp;#34;/opt/ml/output/intermediate&amp;#34;,
    &amp;#34;hyperparameters&amp;#34;: {
        &amp;#34;epochs&amp;#34;: 50,
        &amp;#34;hidden_dim&amp;#34;: 512,
        &amp;#34;n_layers&amp;#34;: 2
    },
    &amp;#34;additional_framework_parameters&amp;#34;: {},
    &amp;#34;input_config_dir&amp;#34;: &amp;#34;/opt/ml/input/config&amp;#34;&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;}
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Environment variables:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ENTRY_POINT=train.py&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_CONFIG_DIR=/opt/ml/input/config&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_LOG_LEVEL=20&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_MODULE=sagemaker_pytorch_container.training:main&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_RESOURCE_CONFIG={&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DATA_DIR=/opt/ml/output/data&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CURRENT_HOST=algo-1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_GPUS=1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_EPOCHS=50&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_N_LAYERS=2&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_NAME=train&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_TRAINING_ENV={&amp;#34;additional_framework_parameters&amp;#34;:{},&amp;#34;channel_input_dirs&amp;#34;:{&amp;#34;training&amp;#34;:&amp;#34;/opt/ml/input/data/training&amp;#34;},&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;framework_module&amp;#34;:&amp;#34;sagemaker_pytorch_container.training:main&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;hyperparameters&amp;#34;:{&amp;#34;epochs&amp;#34;:50,&amp;#34;hidden_dim&amp;#34;:512,&amp;#34;n_layers&amp;#34;:2},&amp;#34;input_config_dir&amp;#34;:&amp;#34;/opt/ml/input/config&amp;#34;,&amp;#34;input_data_config&amp;#34;:{&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}},&amp;#34;input_dir&amp;#34;:&amp;#34;/opt/ml/input&amp;#34;,&amp;#34;job_name&amp;#34;:&amp;#34;sagemaker-pytorch-2020-09-04-18-09-12-678&amp;#34;,&amp;#34;log_level&amp;#34;:20,&amp;#34;model_dir&amp;#34;:&amp;#34;/opt/ml/model&amp;#34;,&amp;#34;module_dir&amp;#34;:&amp;#34;s3://sagemaker-us-east-1-223817798831/sagemaker-pytorch-2020-09-04-18-09-12-678/source/sourcedir.tar.gz&amp;#34;,&amp;#34;module_name&amp;#34;:&amp;#34;train&amp;#34;,&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;,&amp;#34;num_cpus&amp;#34;:4,&amp;#34;num_gpus&amp;#34;:1,&amp;#34;output_data_dir&amp;#34;:&amp;#34;/opt/ml/output/data&amp;#34;,&amp;#34;output_dir&amp;#34;:&amp;#34;/opt/ml/output&amp;#34;,&amp;#34;output_intermediate_dir&amp;#34;:&amp;#34;/opt/ml/output/intermediate&amp;#34;,&amp;#34;resource_config&amp;#34;:{&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;},&amp;#34;user_entry_point&amp;#34;:&amp;#34;train.py&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DIR=/opt/ml/output&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DATA_CONFIG={&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_PARAMS={}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HOSTS=[&amp;#34;algo-1&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_CPUS=4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;PYTHONPATH=/usr/local/bin:/usr/lib/python35.zip:/usr/lib/python3.5:/usr/lib/python3.5/plat-x86_64-linux-gnu:/usr/lib/python3.5/lib-dynload:/usr/local/lib/python3.5/dist-packages:/usr/lib/python3/dist-packages&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNELS=[&amp;#34;training&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODEL_DIR=/opt/ml/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNEL_TRAINING=/opt/ml/input/data/training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HPS={&amp;#34;epochs&amp;#34;:50,&amp;#34;hidden_dim&amp;#34;:512,&amp;#34;n_layers&amp;#34;:2}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_HIDDEN_DIM=512&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DIR=/opt/ml/input&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NETWORK_INTERFACE_NAME=eth0&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_DIR=s3://sagemaker-us-east-1-223817798831/sagemaker-pytorch-2020-09-04-18-09-12-678/source/sourcedir.tar.gz&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ARGS=[&amp;#34;--epochs&amp;#34;,&amp;#34;50&amp;#34;,&amp;#34;--hidden_dim&amp;#34;,&amp;#34;512&amp;#34;,&amp;#34;--n_layers&amp;#34;,&amp;#34;2&amp;#34;]
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Invoking script with the following command:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/usr/bin/python -m train --epochs 50 --hidden_dim 512 --n_layers 2

&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Using device cuda.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Get train data loader.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Model loaded with embedding_dim 38, hidden_dim 512, vocab_size 38.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 1/50............. Time: 14.4431 Train Loss: 2.9868 Val Loss: 2.9684&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 2/50............. Time: 14.4539 Train Loss: 2.8127 Val Loss: 2.5652&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 3/50............. Time: 14.5240 Train Loss: 2.3785 Val Loss: 2.2880&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 4/50............. Time: 14.6011 Train Loss: 2.1525 Val Loss: 2.0916&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 5/50............. Time: 14.6164 Train Loss: 1.9958 Val Loss: 1.9362&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 6/50............. Time: 14.6468 Train Loss: 1.8589 Val Loss: 1.8146&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 7/50............. Time: 14.6547 Train Loss: 1.7433 Val Loss: 1.7126&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 8/50............. Time: 14.6899 Train Loss: 1.6541 Val Loss: 1.6359&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 9/50............. Time: 14.6877 Train Loss: 1.5832 Val Loss: 1.5861&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 10/50............. Time: 14.9234 Train Loss: 1.5350 Val Loss: 1.5421&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 11/50............. Time: 14.7145 Train Loss: 1.6048 Val Loss: 1.5478&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 12/50............. Time: 14.8416 Train Loss: 1.4783 Val Loss: 1.4964&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 13/50............. Time: 14.6023 Train Loss: 1.4303 Val Loss: 1.4738&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 14/50............. Time: 14.6174 Train Loss: 1.3992 Val Loss: 1.4667&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 15/50............. Time: 14.8158 Train Loss: 1.3759 Val Loss: 1.4611&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 16/50............. Time: 15.3926 Train Loss: 1.3576 Val Loss: 1.4520&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 17/50............. Time: 15.4225 Train Loss: 1.3431 Val Loss: 1.4551&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 18/50............. Time: 15.7483 Train Loss: 1.3301 Val Loss: 1.4477&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 19/50............. Time: 15.5521 Train Loss: 1.3183 Val Loss: 1.4493&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 20/50............. Time: 15.5506 Train Loss: 1.3071 Val Loss: 1.4519&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 21/50............. Time: 15.8857 Train Loss: 1.2994 Val Loss: 1.4560&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 22/50............. Time: 15.8872 Train Loss: 1.2918 Val Loss: 1.4624&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 23/50............. Time: 15.5845 Train Loss: 1.2837 Val Loss: 1.4590&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 24/50............. Time: 15.4095 Train Loss: 1.2769 Val Loss: 1.4608&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 25/50............. Time: 15.3529 Train Loss: 1.2723 Val Loss: 1.4590&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 26/50............. Time: 15.4680 Train Loss: 1.2655 Val Loss: 1.4589&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 27/50............. Time: 15.2459 Train Loss: 1.2594 Val Loss: 1.4576&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 28/50............. Time: 14.8407 Train Loss: 1.2541 Val Loss: 1.4611&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 29/50............. Time: 14.8493 Train Loss: 1.2491 Val Loss: 1.4626&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 30/50............. Time: 14.8030 Train Loss: 1.2439 Val Loss: 1.4673&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 31/50............. Time: 14.8256 Train Loss: 1.2406 Val Loss: 1.4672&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 32/50............. Time: 14.8147 Train Loss: 1.2360 Val Loss: 1.4802&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 33/50............. Time: 14.8162 Train Loss: 1.2309 Val Loss: 1.4683&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 34/50............. Time: 14.7752 Train Loss: 1.2273 Val Loss: 1.4689&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 35/50............. Time: 14.8036 Train Loss: 1.2238 Val Loss: 1.4734&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 36/50............. Time: 14.9146 Train Loss: 1.2201 Val Loss: 1.4775&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 37/50............. Time: 14.7848 Train Loss: 1.2188 Val Loss: 1.4706&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 38/50............. Time: 14.8986 Train Loss: 1.2141 Val Loss: 1.4750&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 39/50............. Time: 15.3889 Train Loss: 1.2104 Val Loss: 1.4759&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 40/50............. Time: 15.4683 Train Loss: 1.2065 Val Loss: 1.4744&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 41/50............. Time: 14.8328 Train Loss: 1.2049 Val Loss: 1.4741&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 42/50............. Time: 14.8112 Train Loss: 1.2023 Val Loss: 1.4774&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 43/50............. Time: 14.8114 Train Loss: 1.1987 Val Loss: 1.4803&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 44/50............. Time: 14.7854 Train Loss: 1.1956 Val Loss: 1.4837&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 45/50............. Time: 14.8066 Train Loss: 1.1929 Val Loss: 1.4888&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 46/50............. Time: 14.9014 Train Loss: 1.1889 Val Loss: 1.4856&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 47/50............. Time: 14.7856 Train Loss: 1.1877 Val Loss: 1.4897&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 48/50............. Time: 14.7771 Train Loss: 1.1857 Val Loss: 1.4911&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 49/50............. Time: 15.2428 Train Loss: 1.1826 Val Loss: 1.4963&lt;/span&gt;

2020-09-04 18:26:23 Uploading - Uploading generated training model
2020-09-04 18:26:23 Completed - Training job completed
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 50/50............. Time: 15.3424 Train Loss: 1.1790 Val Loss: 1.4912&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-04 18:26:12,138 sagemaker-containers INFO     Reporting training SUCCESS&lt;/span&gt;
Training seconds: 852
Billable seconds: 852
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-5:-Testing-the-model&quot;&gt;Step 5: Testing the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-5:-Testing-the-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As mentioned at the top of this notebook, we will be testing this model by first deploying it and then sending the testing data to the deployed endpoint. We will do this so that we can make sure that the deployed model is working correctly.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-6---Deploy-the-model-for-inference&quot;&gt;Step 6 - Deploy the model for inference&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-6---Deploy-the-model-for-inference&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that our model is trained, it's time to create some custom inference code so that we can send the model a initial string which has not been processed and determine the next caracters on the string.&lt;/p&gt;
&lt;p&gt;By default the estimator which we created, when deployed, will use the entry script and directory which we provided when creating the model. However, since we wish to accept a string as input and our model expects a processed review, we need to write some custom inference code.&lt;/p&gt;
&lt;p&gt;We will store the code that we write in the &lt;code&gt;serve&lt;/code&gt; directory. Provided in this directory is the &lt;code&gt;model.py&lt;/code&gt; file that we used to construct our model, a &lt;code&gt;utils.py&lt;/code&gt; file which contains the &lt;code&gt;one-hot-encode&lt;/code&gt; and &lt;code&gt;encode_text&lt;/code&gt; pre-processing functions which we used during the initial data processing, and &lt;code&gt;predict.py&lt;/code&gt;, the file which will contain our custom inference code. Note also that &lt;code&gt;requirements.txt&lt;/code&gt; is present which will tell SageMaker what Python libraries are required by our custom inference code.&lt;/p&gt;
&lt;p&gt;When deploying a PyTorch model in SageMaker, you are expected to provide four functions which the SageMaker inference container will use.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;model_fn&lt;/code&gt;: This function is the same function that we used in the training script and it tells SageMaker how to load our model. This function must be called &lt;code&gt;model_fn()&lt;/code&gt; and takes as its only parameter a path to the directory where the model artifacts are stored. This function must also be present in the python file which we specified as the entry point. It also reads the saved dictionaries because they could be used during the inference process.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;input_fn&lt;/code&gt;: This function receives the raw serialized input that has been sent to the model's endpoint and its job is to de-serialize and make the input available for the inference code. Latter we will mention what our input_fn function is doing.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;output_fn&lt;/code&gt;: This function takes the output of the inference code and its job is to serialize this output and return it to the caller of the model's endpoint.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;predict_fn&lt;/code&gt;: The heart of the inference script, this is where the actual prediction is done and is the function which you will need to complete.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For the simple example that we are constructing during this project, the &lt;code&gt;input_fn&lt;/code&gt; and &lt;code&gt;output_fn&lt;/code&gt; methods are relatively straightforward. We require being able to accept a string as input, &lt;em&gt;composed by the desired length of the output and the initial string&lt;/em&gt;. And we expect to return a single string as output, the new text generated. You might imagine though that in a more complex application the input or output may be image data or some other binary data which would require some effort to serialize.&lt;/p&gt;
&lt;h3 id=&quot;Writing-inference-code&quot;&gt;Writing inference code&lt;a class=&quot;anchor-link&quot; href=&quot;#Writing-inference-code&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Before writing our custom inference code, we will begin by taking a look at the code which has been provided.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pygmentize serve/predict.py
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;argparse&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;json&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;pickle&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;sagemaker_containers&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;nn&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;nn&lt;/span&gt;

&lt;span class=&quot;ansi-blue-fg&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; RNNModel

&lt;span class=&quot;ansi-blue-fg&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg ansi-underline&quot;&gt;utils&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;import&lt;/span&gt; clean_text, encode_text, one_hot_encode

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;model_fn&lt;/span&gt;(model_dir):
    &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&amp;#34;&amp;#34;Load the PyTorch model from the `model_dir` directory.&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Loading model.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# First, load the parameters used to create the model.&lt;/span&gt;
    model_info = {}
    model_info_path = os.path.join(model_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;model_info.pth&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(model_info_path, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;rb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        model_info = torch.load(f)

    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;model_info: &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;.format(model_info))

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Determine the device and construct the model.&lt;/span&gt;
    device = torch.device(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; torch.cuda.is_available() &lt;span class=&quot;ansi-blue-fg&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    model = RNNModel(model_info[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;], model_info[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;embedding_dim&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;], model_info[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;], model_info[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;], model_info[&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;drop_rate&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;])

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Load the stored model parameters.&lt;/span&gt;
    model_path = os.path.join(model_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;model.pth&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(model_path, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;rb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        model.load_state_dict(torch.load(f, map_location=&lt;span class=&quot;ansi-blue-fg&quot;&gt;lambda&lt;/span&gt; storage, loc: storage))

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Load the saved word_dict.&lt;/span&gt;
    word_dict_path = os.path.join(model_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;char_dict.pkl&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(word_dict_path, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;rb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        model.char2int = pickle.load(f)

    word_dict_path = os.path.join(model_dir, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;int_dict.pkl&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;open&lt;/span&gt;(word_dict_path, &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;rb&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;) &lt;span class=&quot;ansi-blue-fg&quot;&gt;as&lt;/span&gt; f:
        model.int2char = pickle.load(f)

    model.to(device).eval()

    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Done loading model.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; model

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;input_fn&lt;/span&gt;(serialized_input_data, content_type):
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Deserializing the input data.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; content_type == &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;text/plain&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;:
        data = serialized_input_data.decode(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;utf-8&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# Extract the desired length of the output string&lt;/span&gt;
        sep_pos= data.find(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; sep_pos &amp;gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;:
            length = data[:sep_pos]
            initial_string = data[sep_pos+&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;:]
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; (length,initial_string)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Exception&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Requested unsupported ContentType in content_type: &lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt; + content_type)

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;output_fn&lt;/span&gt;(prediction_output, accept):
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Serializing the generated output.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;str&lt;/span&gt;(prediction_output)

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;sample_from_probs&lt;/span&gt;(probs, top_n=&lt;span class=&quot;ansi-blue-fg&quot;&gt;10&lt;/span&gt;):
    &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;span class=&quot;ansi-yellow-fg&quot;&gt;    truncated weighted random choice.&lt;/span&gt;
&lt;span class=&quot;ansi-yellow-fg&quot;&gt;    &amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;
    _, indices = torch.sort(probs)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# set probabilities after top_n to 0&lt;/span&gt;
    probs[indices.data[:-top_n]] = &lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(probs.shape)&lt;/span&gt;
    sampled_index = torch.multinomial(probs, &lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;)
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; sampled_index

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;predict_probs&lt;/span&gt;(model, hidden, character, vocab, device):
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# One-hot encoding our input to fit into the model&lt;/span&gt;
    character = np.array([[vocab[c] &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; c &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; character]])
    character = one_hot_encode(character, &lt;span class=&quot;ansi-cyan-fg&quot;&gt;len&lt;/span&gt;(vocab))
    character = torch.from_numpy(character)
    character = character.to(device)
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;with&lt;/span&gt; torch.no_grad():
        out, hidden = model(character, hidden)

    prob = nn.functional.softmax(out[-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;], dim=&lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;).data

    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; prob, hidden

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;predict_old&lt;/span&gt;(input_data, model):
    &lt;span class=&quot;ansi-cyan-fg&quot;&gt;print&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Inferring sentiment of input data.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)

    device = torch.device(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; torch.cuda.is_available() &lt;span class=&quot;ansi-blue-fg&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; model.char2int &lt;span class=&quot;ansi-magenta-fg&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;:
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Exception&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Model has not been loaded properly, no word_dict.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    
    model.eval() &lt;span class=&quot;ansi-white-fg&quot;&gt;# eval mode&lt;/span&gt;
    start = input_data.lower()
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Clean the text as the text used in training &lt;/span&gt;
    start = clean_text(start, &lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Encode the text&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#encode_text(start, model.vocab, one_hot = False):&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# First off, run through the starting characters&lt;/span&gt;
    chars = [ch &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; ch &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; start]

    state = model.init_state(device, &lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;)
    probs, state = predict_probs(model, state, chars, model.vocab, device)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#print(probs.shape)&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#probs = torch.transpose(probs, 0, 1)&lt;/span&gt;
    next_index = sample_from_probs(probs[-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;].squeeze(), top_n=&lt;span class=&quot;ansi-blue-fg&quot;&gt;3&lt;/span&gt;)
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; next_index.data[&lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;].item()

&lt;span class=&quot;ansi-blue-fg&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;predict_fn&lt;/span&gt;(input_data, model):

    device = torch.device(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; torch.cuda.is_available() &lt;span class=&quot;ansi-blue-fg&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#34;&lt;/span&gt;)
    
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;if&lt;/span&gt; model.char2int &lt;span class=&quot;ansi-magenta-fg&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ansi-blue-fg&quot;&gt;None&lt;/span&gt;:
        &lt;span class=&quot;ansi-blue-fg&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;Exception&lt;/span&gt;(&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;Model has not been loaded properly, no word_dict.&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;)
    
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# TODO: Process input_data so that it is ready to be sent to our model.&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#       You should produce two variables:&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#         data_X   - A sequence of length 500 which represents the converted review&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#         data_len - The length of the review&lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Extract the input data and the desired length&lt;/span&gt;
    out_len, start = input_data
    out_len = &lt;span class=&quot;ansi-cyan-fg&quot;&gt;int&lt;/span&gt;(out_len)

    model.eval() &lt;span class=&quot;ansi-white-fg&quot;&gt;# eval mode&lt;/span&gt;
    start = start.lower()
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Clean the text as the text used in training &lt;/span&gt;
    start = clean_text(start, &lt;span class=&quot;ansi-blue-fg&quot;&gt;True&lt;/span&gt;)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# First off, run through the starting characters&lt;/span&gt;
    chars = [ch &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; ch &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; start]
    size = out_len - &lt;span class=&quot;ansi-cyan-fg&quot;&gt;len&lt;/span&gt;(chars)
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Init the hidden state&lt;/span&gt;
    state = model.init_state(device, &lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Warm up the initial state, predicting on the initial string&lt;/span&gt;
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; ch &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; chars:
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#char, state = predict(model, ch, state, top_n=top_k)&lt;/span&gt;
        probs, state = predict_probs(model, state, ch, model.char2int, device)
        next_index = sample_from_probs(probs, &lt;span class=&quot;ansi-blue-fg&quot;&gt;5&lt;/span&gt;)

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Include the last char predicted to the predicted output&lt;/span&gt;
    chars.append(model.int2char[next_index.data[&lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;]])   
    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Now pass in the previous characters and get a new one&lt;/span&gt;
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;for&lt;/span&gt; ii &lt;span class=&quot;ansi-magenta-fg&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;ansi-cyan-fg&quot;&gt;range&lt;/span&gt;(size-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;):
        &lt;span class=&quot;ansi-white-fg&quot;&gt;#char, h = predict_char(model, chars, vocab)&lt;/span&gt;
        probs, state = predict_probs(model, state, chars[-&lt;span class=&quot;ansi-blue-fg&quot;&gt;1&lt;/span&gt;], model.char2int, device)
        next_index = sample_from_probs(probs, &lt;span class=&quot;ansi-blue-fg&quot;&gt;5&lt;/span&gt;)
        &lt;span class=&quot;ansi-white-fg&quot;&gt;# append to sequence&lt;/span&gt;
        chars.append(model.int2char[next_index.data[&lt;span class=&quot;ansi-blue-fg&quot;&gt;0&lt;/span&gt;]])

    &lt;span class=&quot;ansi-white-fg&quot;&gt;# Join all the chars    &lt;/span&gt;
    &lt;span class=&quot;ansi-white-fg&quot;&gt;#chars = chars.decode(&amp;#39;utf-8&amp;#39;)&lt;/span&gt;
    &lt;span class=&quot;ansi-blue-fg&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;ansi-yellow-fg&quot;&gt;&amp;#39;&lt;/span&gt;.join(chars)
    
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;As mentioned earlier, the &lt;code&gt;model_fn&lt;/code&gt; method is the same as the one provided in the training code and the &lt;code&gt;input_fn&lt;/code&gt; and &lt;code&gt;output_fn&lt;/code&gt; methods are very simple. Finally we must build a &lt;code&gt;predict_fn&lt;/code&gt; method that will receive the input string, encode it (char2int), one-hot-encode and send it to the model. Every output will be decode (int2char) and appended to the final output string.&lt;/p&gt;
&lt;p&gt;Make sure that you save the completed file as &lt;code&gt;predict.py&lt;/code&gt; in the &lt;code&gt;serve&lt;/code&gt; directory.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Deploying-the-model&quot;&gt;Deploying the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Deploying-the-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now that the custom inference code has been written, we will create and deploy our model. To begin with, we need to construct a new PyTorchModel object which points to the model artifacts created during training and also points to the inference code that we wish to use. Then we can call the deploy method to launch the deployment container.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE&lt;/strong&gt;: The default behaviour for a deployed PyTorch model is to assume that any input passed to the predictor is a &lt;code&gt;numpy&lt;/code&gt; array. In our case we want to send a string so we need to construct a simple wrapper around the &lt;code&gt;RealTimePredictor&lt;/code&gt; class to accomodate simple strings. In a more complicated situation you may want to provide a serialization object, for example if you wanted to sent image data.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;NOTE:&lt;/strong&gt; When deploying a model you are asking SageMaker to launch an compute instance that will wait for data to be sent to it. As a result, this compute instance will continue to run until &lt;em&gt;you&lt;/em&gt; shut it down. This is important to know since the cost of a deployed endpoint depends on how long it has been running for.&lt;/p&gt;
&lt;p&gt;In other words &lt;strong&gt;If you are no longer using a deployed endpoint, shut it down!&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now, we can deploy our trained model&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-a-previously-trained-model&quot;&gt;Loading a previously trained model&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-a-previously-trained-model&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In many situations, you have trained the model in another execution of this notebook or you shutdown the notebook while the model was training. So the estimator variable is empty or undefined and then, you want to restore or use a previous training job and deploy it. In the next cell, we attach that trained model to the estimator variable and continue the necessary steps to launch and deploy the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Attach the estimator to a oreviously trained job&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker.pytorch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyTorch&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;my_training_job_name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;sagemaker-pytorch-2020-09-02-19-49-57-475&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyTorch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my_training_job_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;2020-09-02 20:00:18 Starting - Preparing the instances for training
2020-09-02 20:00:18 Downloading - Downloading input data
2020-09-02 20:00:18 Training - Training image download completed. Training in progress.
2020-09-02 20:00:18 Uploading - Uploading generated training model
2020-09-02 20:00:18 Completed - Training job completed&lt;span class=&quot;ansi-blue-fg&quot;&gt;bash: cannot set terminal process group (-1): Inappropriate ioctl for device&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;bash: no job control in this shell&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,432 sagemaker-containers INFO     Imported framework sagemaker_pytorch_container.training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,457 sagemaker_pytorch_container.training INFO     Block until all host DNS lookups succeed.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,461 sagemaker_pytorch_container.training INFO     Invoking user training script.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,761 sagemaker-containers INFO     Module train does not provide a setup.py. &lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Generating setup.py&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,761 sagemaker-containers INFO     Generating setup.cfg&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,761 sagemaker-containers INFO     Generating MANIFEST.in&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:53:51,761 sagemaker-containers INFO     Installing module with the following command:&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/usr/bin/python -m pip install -U . -r requirements.txt&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Processing /opt/ml/code&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting pandas (from -r requirements.txt (line 1))
  Downloading https://files.pythonhosted.org/packages/74/24/0cdbf8907e1e3bc5a8da03345c23cbed7044330bb8f73bb12e711a640a00/pandas-0.24.2-cp35-cp35m-manylinux1_x86_64.whl (10.0MB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting numpy (from -r requirements.txt (line 2))&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Downloading https://files.pythonhosted.org/packages/b5/36/88723426b4ff576809fec7d73594fe17a35c27f8d01f93637637a29ae25b/numpy-1.18.5-cp35-cp35m-manylinux1_x86_64.whl (19.9MB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Collecting pytz&amp;gt;=2011k (from pandas-&amp;gt;-r requirements.txt (line 1))
  Downloading https://files.pythonhosted.org/packages/4f/a4/879454d49688e2fad93e59d7d4efda580b783c745fd2ec2a3adf87b0808d/pytz-2020.1-py2.py3-none-any.whl (510kB)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied, skipping upgrade: python-dateutil&amp;gt;=2.5.0 in /usr/local/lib/python3.5/dist-packages (from pandas-&amp;gt;-r requirements.txt (line 1)) (2.7.5)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Requirement already satisfied, skipping upgrade: six&amp;gt;=1.5 in /usr/local/lib/python3.5/dist-packages (from python-dateutil&amp;gt;=2.5.0-&amp;gt;pandas-&amp;gt;-r requirements.txt (line 1)) (1.11.0)&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Building wheels for collected packages: train
  Running setup.py bdist_wheel for train: started&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;  Running setup.py bdist_wheel for train: finished with status &amp;#39;done&amp;#39;
  Stored in directory: /tmp/pip-ephem-wheel-cache-9xt478wn/wheels/35/24/16/37574d11bf9bde50616c67372a334f94fa8356bc7164af8ca3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully built train&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Installing collected packages: pytz, numpy, pandas, train
  Found existing installation: numpy 1.15.4
    Uninstalling numpy-1.15.4:&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;      Successfully uninstalled numpy-1.15.4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Successfully installed numpy-1.18.5 pandas-0.24.2 pytz-2020.1 train-1.0.0&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;You are using pip version 18.1, however version 20.2.2 is available.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;You should consider upgrading via the &amp;#39;pip install --upgrade pip&amp;#39; command.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 19:54:01,620 sagemaker-containers INFO     Invoking user script
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Training Env:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;{
    &amp;#34;output_dir&amp;#34;: &amp;#34;/opt/ml/output&amp;#34;,
    &amp;#34;log_level&amp;#34;: 20,
    &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;,
    &amp;#34;hosts&amp;#34;: [
        &amp;#34;algo-1&amp;#34;
    ],
    &amp;#34;job_name&amp;#34;: &amp;#34;sagemaker-pytorch-2020-09-02-19-49-57-475&amp;#34;,
    &amp;#34;num_cpus&amp;#34;: 4,
    &amp;#34;user_entry_point&amp;#34;: &amp;#34;train.py&amp;#34;,
    &amp;#34;module_dir&amp;#34;: &amp;#34;s3://sagemaker-us-east-1-223817798831/sagemaker-pytorch-2020-09-02-19-49-57-475/source/sourcedir.tar.gz&amp;#34;,
    &amp;#34;framework_module&amp;#34;: &amp;#34;sagemaker_pytorch_container.training:main&amp;#34;,
    &amp;#34;input_dir&amp;#34;: &amp;#34;/opt/ml/input&amp;#34;,
    &amp;#34;output_intermediate_dir&amp;#34;: &amp;#34;/opt/ml/output/intermediate&amp;#34;,
    &amp;#34;input_data_config&amp;#34;: {
        &amp;#34;training&amp;#34;: {
            &amp;#34;TrainingInputMode&amp;#34;: &amp;#34;File&amp;#34;,
            &amp;#34;S3DistributionType&amp;#34;: &amp;#34;FullyReplicated&amp;#34;,
            &amp;#34;RecordWrapperType&amp;#34;: &amp;#34;None&amp;#34;
        }
    },
    &amp;#34;hyperparameters&amp;#34;: {
        &amp;#34;epochs&amp;#34;: 3,
        &amp;#34;hidden_dim&amp;#34;: 64
    },
    &amp;#34;output_data_dir&amp;#34;: &amp;#34;/opt/ml/output/data&amp;#34;,
    &amp;#34;model_dir&amp;#34;: &amp;#34;/opt/ml/model&amp;#34;,
    &amp;#34;channel_input_dirs&amp;#34;: {
        &amp;#34;training&amp;#34;: &amp;#34;/opt/ml/input/data/training&amp;#34;
    },
    &amp;#34;resource_config&amp;#34;: {
        &amp;#34;network_interface_name&amp;#34;: &amp;#34;eth0&amp;#34;,
        &amp;#34;hosts&amp;#34;: [
            &amp;#34;algo-1&amp;#34;
        ],
        &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;
    },
    &amp;#34;num_gpus&amp;#34;: 1,
    &amp;#34;input_config_dir&amp;#34;: &amp;#34;/opt/ml/input/config&amp;#34;,
    &amp;#34;additional_framework_parameters&amp;#34;: {},
    &amp;#34;module_name&amp;#34;: &amp;#34;train&amp;#34;,
    &amp;#34;current_host&amp;#34;: &amp;#34;algo-1&amp;#34;&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;}
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Environment variables:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_LOG_LEVEL=20&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_EPOCHS=3&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_PARAMS={}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HPS={&amp;#34;epochs&amp;#34;:3,&amp;#34;hidden_dim&amp;#34;:64}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_CPUS=4&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DATA_DIR=/opt/ml/output/data&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_TRAINING_ENV={&amp;#34;additional_framework_parameters&amp;#34;:{},&amp;#34;channel_input_dirs&amp;#34;:{&amp;#34;training&amp;#34;:&amp;#34;/opt/ml/input/data/training&amp;#34;},&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;framework_module&amp;#34;:&amp;#34;sagemaker_pytorch_container.training:main&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;hyperparameters&amp;#34;:{&amp;#34;epochs&amp;#34;:3,&amp;#34;hidden_dim&amp;#34;:64},&amp;#34;input_config_dir&amp;#34;:&amp;#34;/opt/ml/input/config&amp;#34;,&amp;#34;input_data_config&amp;#34;:{&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}},&amp;#34;input_dir&amp;#34;:&amp;#34;/opt/ml/input&amp;#34;,&amp;#34;job_name&amp;#34;:&amp;#34;sagemaker-pytorch-2020-09-02-19-49-57-475&amp;#34;,&amp;#34;log_level&amp;#34;:20,&amp;#34;model_dir&amp;#34;:&amp;#34;/opt/ml/model&amp;#34;,&amp;#34;module_dir&amp;#34;:&amp;#34;s3://sagemaker-us-east-1-223817798831/sagemaker-pytorch-2020-09-02-19-49-57-475/source/sourcedir.tar.gz&amp;#34;,&amp;#34;module_name&amp;#34;:&amp;#34;train&amp;#34;,&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;,&amp;#34;num_cpus&amp;#34;:4,&amp;#34;num_gpus&amp;#34;:1,&amp;#34;output_data_dir&amp;#34;:&amp;#34;/opt/ml/output/data&amp;#34;,&amp;#34;output_dir&amp;#34;:&amp;#34;/opt/ml/output&amp;#34;,&amp;#34;output_intermediate_dir&amp;#34;:&amp;#34;/opt/ml/output/intermediate&amp;#34;,&amp;#34;resource_config&amp;#34;:{&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;},&amp;#34;user_entry_point&amp;#34;:&amp;#34;train.py&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;PYTHONPATH=/usr/local/bin:/usr/lib/python35.zip:/usr/lib/python3.5:/usr/lib/python3.5/plat-x86_64-linux-gnu:/usr/lib/python3.5/lib-dynload:/usr/local/lib/python3.5/dist-packages:/usr/lib/python3/dist-packages&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNEL_TRAINING=/opt/ml/input/data/training&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DIR=/opt/ml/input&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_FRAMEWORK_MODULE=sagemaker_pytorch_container.training:main&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NUM_GPUS=1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_CONFIG_DIR=/opt/ml/input/config&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ARGS=[&amp;#34;--epochs&amp;#34;,&amp;#34;3&amp;#34;,&amp;#34;--hidden_dim&amp;#34;,&amp;#34;64&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_INPUT_DATA_CONFIG={&amp;#34;training&amp;#34;:{&amp;#34;RecordWrapperType&amp;#34;:&amp;#34;None&amp;#34;,&amp;#34;S3DistributionType&amp;#34;:&amp;#34;FullyReplicated&amp;#34;,&amp;#34;TrainingInputMode&amp;#34;:&amp;#34;File&amp;#34;}}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_USER_ENTRY_POINT=train.py&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_DIR=/opt/ml/output&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CURRENT_HOST=algo-1&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_DIR=s3://sagemaker-us-east-1-223817798831/sagemaker-pytorch-2020-09-02-19-49-57-475/source/sourcedir.tar.gz&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODEL_DIR=/opt/ml/model&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_CHANNELS=[&amp;#34;training&amp;#34;]&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_OUTPUT_INTERMEDIATE_DIR=/opt/ml/output/intermediate&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_NETWORK_INTERFACE_NAME=eth0&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_MODULE_NAME=train&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HP_HIDDEN_DIM=64&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_RESOURCE_CONFIG={&amp;#34;current_host&amp;#34;:&amp;#34;algo-1&amp;#34;,&amp;#34;hosts&amp;#34;:[&amp;#34;algo-1&amp;#34;],&amp;#34;network_interface_name&amp;#34;:&amp;#34;eth0&amp;#34;}&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;SM_HOSTS=[&amp;#34;algo-1&amp;#34;]
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Invoking script with the following command:
&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;/usr/bin/python -m train --epochs 3 --hidden_dim 64

&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Using device cuda.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Get train data loader.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Model loaded with embedding_dim 28, hidden_dim 64, vocab_size 28.&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 1/3............. Loss: 1.5655&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 2/3............. Loss: 1.5143&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;Epoch: 3/3............. Loss: 1.5086&lt;/span&gt;
&lt;span class=&quot;ansi-blue-fg&quot;&gt;2020-09-02 20:00:09,820 sagemaker-containers INFO     Reporting training SUCCESS&lt;/span&gt;
Training seconds: 453
Billable seconds: 453
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker.predictor&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RealTimePredictor&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sagemaker.pytorch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyTorchModel&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;StringPredictor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RealTimePredictor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;endpoint_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StringPredictor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;endpoint_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sagemaker_session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;content_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;text/plain&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PyTorchModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;role&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;role&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;framework_version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;0.4.0&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;entry_point&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;predict.py&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;source_dir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;serve&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;predictor_cls&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StringPredictor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;predictor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;deploy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initial_instance_count&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;instance_type&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ml.m4.xlarge&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Parameter image will be renamed to image_uri in SageMaker Python SDK v2.
&amp;#39;create_image_uri&amp;#39; will be deprecated in favor of &amp;#39;ImageURIProvider&amp;#39; class in SageMaker Python SDK v2.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;---------------!&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Step-7---Use-the-model-for-testing&quot;&gt;Step 7 - Use the model for testing&lt;a class=&quot;anchor-link&quot; href=&quot;#Step-7---Use-the-model-for-testing&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now that we have deployed our model with the custom inference code, we should test it to see if everything is working. Here we test our model by creating an initial string and send it to the endpoint, then collect the result. But we also want to tell the inference how long should be the expected output.&lt;/p&gt;
&lt;p&gt;It means that we need to send to our predict function not only the initial string but the the length of the output. As the expected input by the deserialized function, input_fn, is a string and we are looking for a simple solution, &lt;strong&gt;our input data will be a string composed by: the length of the output+'-'+initial string.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Now, it is time to test our model, sending a very common initial string: &lt;code&gt;you are&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;100-you are &amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;new_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;you are think too the starry a my seens weeped as he to be then that tonight we was shall be wear my
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Another example to try out is to send the model a text included in the training dataset and see what the model predicts:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Text: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;963&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1148&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;init_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;963&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1148&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Init text: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;963&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1020&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;-&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_text&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;new_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predictor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;new_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Text:  he did content to say it was for his country he did it to please his mother and to be partly proud; which he is, even till the altitude of his virtue. what he cannot help in his nature,
Init text:  he did content to say it was for his country he did it to
he did content to say it was for his country he did it to please his mother and to be partly proud which he is even till the altitude of his virtue what he cannot help in his nature of 
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can check that the model &quot;remember&quot; the texts during the training, it can mostly reproduce the original text.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now that we know our endpoint is working as expected, we can set up a web page or app that will interact with it.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Make sure to skip down to the end of this notebook and shut down your endpoint. You can deploy it again when you come back.&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Delete-the-endpoint&quot;&gt;Delete the endpoint&lt;a class=&quot;anchor-link&quot; href=&quot;#Delete-the-endpoint&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Remember to always shut down your endpoint if you are no longer using it. You are charged for the length of time that the endpoint is running so if you forget and leave it on you could end up with an unexpectedly large bill.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predictor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;delete_endpoint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">A guide on Recurrent Neural Networks: Character-level Text Generator</title><link href="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/lstm/pytorch/2020/09/03/char-level-text-generator-pytorch.html" rel="alternate" type="text/html" title="A guide on Recurrent Neural Networks: Character-level Text Generator" /><published>2020-09-03T00:00:00-05:00</published><updated>2020-09-03T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/lstm/pytorch/2020/09/03/char-level-text-generator-pytorch</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/lstm/pytorch/2020/09/03/char-level-text-generator-pytorch.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-09-03-char-level-text-generator-pytorch.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Character-level-text-generator-with-Pytorch-using-Long-Short-Term-Memory-Units&quot;&gt;Character-level text generator with Pytorch using Long Short-Term Memory Units&lt;a class=&quot;anchor-link&quot; href=&quot;#Character-level-text-generator-with-Pytorch-using-Long-Short-Term-Memory-Units&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this notebook we will be implementing a simple RNN character model with PyTorch to familiarize ourselves with the PyTorch library and get started with RNNs. The goal is to build a model that can complete your sentence based on a few characters or a word used as input.&lt;/p&gt;
&lt;p&gt;The model will be fed with a word and will predict what the next character in the sentence will be. This process will repeat itself until we generate a sentence of our desired length.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Importing-the-libraries&quot;&gt;Importing the libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#Importing-the-libraries&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.autograd&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;random&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;rnd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;time&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;string&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tqdm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-the-dataset&quot;&gt;Loading the dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-dataset&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;First, we'll define the sentences that we want our model to output when fed with the first word or the first few characters. Our dataset is a text file containing Shakespeare's plays or books that we will extract sequence of chars to use as input to our model. Then our model will learn how to complete sentences like &quot;Shakespeare would do&quot;.&lt;/p&gt;
&lt;p&gt;This dataset can be downloaded from Karpathy's Github account: &lt;a href=&quot;https://github.com/karpathy/char-rnn/blob/master/data/tinyshakespeare/input.txt&quot;&gt;https://github.com/karpathy/char-rnn/blob/master/data/tinyshakespeare/input.txt&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As in many of my notebooks, we set some variables to the data directory and filenames. If you want to run this code on your own enviroment you must change these values:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set the root folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the folder with the dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;model&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set the filename&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;input.txt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Path to the data folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_dir&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set the path where the text for training is stored&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set a seed&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;load_text_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_dialog&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Load the texts from the filename, splitting by lines and removing empty strings.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Setting init_dialog = True will remove lines where the character who is going to speak is indicated&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#sentences = reader.readlines()&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#if &amp;#39;:&amp;#39; not in line and line !=&amp;#39;\n&amp;#39;:&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init_dialog&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;:&amp;#39;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;# Append the line to the sentences, removing the end of line character&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
                
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Loading the input data, sentences from Shakespeare's plays.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_text_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of sentences: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of sentences:  29723
[&amp;#39;Before we proceed any further, hear me speak.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;Speak, speak.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;You are all resolved rather to die than to famish?&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;Resolved. resolved.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;First, you know Caius Marcius is chief enemy to the people.&amp;#39;, &amp;#39;&amp;#39;, &amp;#34;We know&amp;#39;t, we know&amp;#39;t.&amp;#34;, &amp;#39;&amp;#39;, &amp;#34;Let us kill him, and we&amp;#39;ll have corn at our own price.&amp;#34;, &amp;#34;Is&amp;#39;t a verdict?&amp;#34;, &amp;#39;&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;One word, good citizens.&amp;#39;, &amp;#39;&amp;#39;, &amp;#39;We are accounted poor citizens, the patricians good.&amp;#39;, &amp;#39;would yield us but the superfluity, while it were&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Cleaning-the-input-data&quot;&gt;Cleaning the input data&lt;a class=&quot;anchor-link&quot; href=&quot;#Cleaning-the-input-data&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;When working with text data, we usually need to perform some cleanings to prepare the data for our algorithm.This time we will start with a simple cleaning, convert to lowercase the text and remove non alphanumeric chracters (a parameter configuration).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;clean_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Cleaning process of the text&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;alpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Remove non alphabetic character&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isalpha&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Simply lower the characters&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Remove any emoty string&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cleaned_text&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Clean the sentences&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clean_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Join all the sentences in a one long string&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Number of characters: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Number of characters:  894876
before we proceed any further, hear me speak. speak, speak. you are all resolved rather to die than 
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creating-the-dictionary&quot;&gt;Creating the dictionary&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-the-dictionary&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now we'll create a dictionary out of all the characters that we have in the sentences and map them to an integer. This will allow us to convert our input characters to their respective integers (char2int) and viceversa (int2char).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;CharVocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; 
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Create a Vocabulary for &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type_vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;PAD&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;EOS&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unk_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Initialization of the type of vocabulary&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type_vocab&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#self.int2char ={}&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pad_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eos_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unk_token&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unk_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__call__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;       &lt;span class=&quot;c1&quot;&gt;#When called, adds the values of parameters x_1 and x_2, prints and returns the result &lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Join all the sentences together and extract the unique characters from the combined sentences&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Creating a dictionary that maps integers to the characters&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Creating another dictionary that maps characters to integers&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ind&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;char&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
        
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CharVocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;char&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Length of vocabulary: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Int to Char: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Char to Int: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Length of vocabulary:  38
Int to Char:  [&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;, &amp;#39;l&amp;#39;, &amp;#39;g&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;z&amp;#39;, &amp;#39;-&amp;#39;, &amp;#39;k&amp;#39;, &amp;#39;e&amp;#39;, &amp;#39;o&amp;#39;, &amp;#39;r&amp;#39;, &amp;#39;i&amp;#39;, &amp;#39;,&amp;#39;, &amp;#39;w&amp;#39;, &amp;#34;&amp;#39;&amp;#34;, &amp;#39;;&amp;#39;, &amp;#39;f&amp;#39;, &amp;#39;x&amp;#39;, &amp;#39;?&amp;#39;, &amp;#39;d&amp;#39;, &amp;#39;$&amp;#39;, &amp;#39;3&amp;#39;, &amp;#39;a&amp;#39;, &amp;#39;s&amp;#39;, &amp;#39;v&amp;#39;, &amp;#39;m&amp;#39;, &amp;#39;&amp;amp;&amp;#39;, &amp;#39;t&amp;#39;, &amp;#39;h&amp;#39;, &amp;#39;u&amp;#39;, &amp;#39;p&amp;#39;, &amp;#39;n&amp;#39;, &amp;#39;y&amp;#39;, &amp;#39; &amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;q&amp;#39;, &amp;#39;!&amp;#39;, &amp;#39;j&amp;#39;, &amp;#39;.&amp;#39;]
Char to Int:  {&amp;#39;&amp;lt;UNK&amp;gt;&amp;#39;: 0, &amp;#39;l&amp;#39;: 1, &amp;#39;g&amp;#39;: 2, &amp;#39;b&amp;#39;: 3, &amp;#39;z&amp;#39;: 4, &amp;#39;-&amp;#39;: 5, &amp;#39;k&amp;#39;: 6, &amp;#39;e&amp;#39;: 7, &amp;#39;o&amp;#39;: 8, &amp;#39;r&amp;#39;: 9, &amp;#39;i&amp;#39;: 10, &amp;#39;,&amp;#39;: 11, &amp;#39;w&amp;#39;: 12, &amp;#34;&amp;#39;&amp;#34;: 13, &amp;#39;;&amp;#39;: 14, &amp;#39;f&amp;#39;: 15, &amp;#39;x&amp;#39;: 16, &amp;#39;?&amp;#39;: 17, &amp;#39;d&amp;#39;: 18, &amp;#39;$&amp;#39;: 19, &amp;#39;3&amp;#39;: 20, &amp;#39;a&amp;#39;: 21, &amp;#39;s&amp;#39;: 22, &amp;#39;v&amp;#39;: 23, &amp;#39;m&amp;#39;: 24, &amp;#39;&amp;amp;&amp;#39;: 25, &amp;#39;t&amp;#39;: 26, &amp;#39;h&amp;#39;: 27, &amp;#39;u&amp;#39;: 28, &amp;#39;p&amp;#39;: 29, &amp;#39;n&amp;#39;: 30, &amp;#39;y&amp;#39;: 31, &amp;#39; &amp;#39;: 32, &amp;#39;c&amp;#39;: 33, &amp;#39;q&amp;#39;: 34, &amp;#39;!&amp;#39;: 35, &amp;#39;j&amp;#39;: 36, &amp;#39;.&amp;#39;: 37}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Save-the-dictionary&quot;&gt;Save the dictionary&lt;a class=&quot;anchor-link&quot; href=&quot;#Save-the-dictionary&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In this example it is nor mandatory to save the dictionary inmediately, because it is a quick task. But when dealing with a huge corpus and a large dictionary, we should save the dictionary to restore it latter when new experiments will be executed.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Check or create the directory where dictionary will be saved&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exists&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Make sure that the folder exists&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;makedirs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Save the dictionary to data path dir  &lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;char_dict.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;int_dict.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Create-the-input-data-and-labels-for-training&quot;&gt;Create the input data and labels for training&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-the-input-data-and-labels-for-training&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;As we're going to predict the next character in the sequence at each time step, we'll have to divide each sentence into&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Input data&lt;/strong&gt;: The last input character should be excluded as it does not need to be fed into the model&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Target/Ground Truth Label&lt;/strong&gt;: One time-step ahead of the Input data as this will be the &quot;correct answer&quot; for the model at each time step corresponding to the input data&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Define one hot encode matrix for our sequences&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Creating a multi-dimensional array with the desired output shape&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Encode every integer with its one hot representation&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eye&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flatten&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Finally reshape it to get back to the original array&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encode_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Encode the input_text replacing the char by its integer number based on the dictionary vocab&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Replace every char by its integer value based on the vocabulary&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# One hot encode every integer of the sequence&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, we can encode our text, replacing every character by the integer value in the dictionary. When we have our dataset unified and prepared, we should do a quick check and see an example of the data our model will be trained on. This is generally a good idea as it allows you to see how each of the further processing steps affects the reviews and it also ensures that the data has been loaded correctly.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Encode the train dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;encode_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Create the input sequence, from 0 to len-1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the target sequence, from 1 to len. It is right-shifted one place&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Original text:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sentences&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Encoded text:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Input sequence:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;Target sequence:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;
Original text:
before we proceed any further, hear me speak. speak, speak. you are all resolved rather to die than 

Encoded text:
[ 3  7 15  8  9  7 32 12  7 32 29  9  8 33  7  7 18 32 21 30 31 32 15 28
  9 26 27  7  9 11 32 27  7 21  9 32 24  7 32 22 29  7 21  6 37 32 22 29
  7 21  6 11 32 22 29  7 21  6 37 32 31  8 28 32 21  9  7 32 21  1  1 32
  9  7 22  8  1 23  7 18 32  9 21 26 27  7  9 32 26  8 32 18 10  7 32 26
 27 21 30 32]

Input sequence:
[ 3  7 15  8  9  7 32 12  7 32 29  9  8 33  7  7 18 32 21 30 31 32 15 28
  9 26 27  7  9 11 32 27  7 21  9 32 24  7 32 22 29  7 21  6 37 32 22 29
  7 21  6 11 32 22 29  7 21  6 37 32 31  8 28 32 21  9  7 32 21  1  1 32
  9  7 22  8  1 23  7 18 32  9 21 26 27  7  9 32 26  8 32 18 10  7 32 26
 27 21 30 32]

Target sequence:
[ 7 15  8  9  7 32 12  7 32 29  9  8 33  7  7 18 32 21 30 31 32 15 28  9
 26 27  7  9 11 32 27  7 21  9 32 24  7 32 22 29  7 21  6 37 32 22 29  7
 21  6 11 32 22 29  7 21  6 37 32 31  8 28 32 21  9  7 32 21  1  1 32  9
  7 22  8  1 23  7 18 32  9 21 26 27  7  9 32 26  8 32 18 10  7 32 26 27
 21 30 32 26]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now we can save our encoded dataset to a file, so we can restore it whenever it is necessary. It is important to note the format of the data that we are saving as we will need to know it when we write the training code. In our case, we will save the dataset as a pickle object, it is the array containing the whole dataset encoded as an integer value for every character.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Save the encoded text to a file&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;encoded_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;input_data.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encoded_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Lets check our one-hot-encode function that we will use later during the training phase:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Encoded characters: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;102&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;One-hot-encoded characters: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;102&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Encoded characters:  [26  8]
One-hot-encoded characters:  [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
  0. 0. 0. 0.]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-a-batch-data-generator&quot;&gt;Create a batch data generator&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-a-batch-data-generator&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;When training on the dataset, we need to extract a batch size examples from the inputs and targets, forward and backward the RNN and then repite the iteration with another batch size examples. 
A batch generator will help us to extract a batch size examples from our datasets.&lt;/p&gt;
&lt;p&gt;First we will load a small portion of the training data set to use as a sample. It would be very time consuming to try and train the model completely in the notebook as we do not have access to a gpu and the compute instance that we are using is not particularly powerful. However, we can work on a small bit of the data to get a feel for how our training script is behaving.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;batch_generator_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Generator function that yields batches of data (input and target)&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    Args:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        features_seq: sequence of chracters, feature of our model.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        label_seq: sequence of chracters, the target label of our model&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        batch_size (int): number of examples (in this case, sentences) per batch.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        seq_len (int): maximum length of the output tensor.&lt;/span&gt;

&lt;span class=&quot;sd&quot;&gt;    Yields:&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        x_epoch: sequence of features for the epoch&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        y_epoch: sequence of labels for the epoch&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# calculate the number of batches we can supply&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;ValueError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;No batches created. Use smaller batch size or sequence length.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# calculate effective length of text to use&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;rounded_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Reshape the features matrix in batch size x num_batches * seq_len&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Reshape the target matrix in batch size x num_batches * seq_len&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rounded_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# roll so that no need to reset rnn states over epochs&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roll&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Define-the-RNN-model&quot;&gt;Define the RNN model&lt;a class=&quot;anchor-link&quot; href=&quot;#Define-the-RNN-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The model is very simple_&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;An LSTM layer to encode the input (there is no need for an embedding layer because the data is one-hot-encoded)&lt;/li&gt;
&lt;li&gt;A dropout layer to reduce overfitting&lt;/li&gt;
&lt;li&gt;The decoder, a fully connected layer mapping to a vocabulary size outputs&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The output provides the probability of every item in the vocabulary to be the next char.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;RNNModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;RNNModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# Defining some parameters&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;


        &lt;span class=&quot;c1&quot;&gt;#Defining the layers&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Define the encoder as an Embedding layer&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#self.encoder = nn.Embedding(vocab_size, embedding_size)&lt;/span&gt;
            
        &lt;span class=&quot;c1&quot;&gt;# Dropout layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# RNN Layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTM&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_first&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Fully connected layer&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# input shape: [batch_size, seq_len, embedding_size]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Apply the embedding layer and dropout&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#embed_seq = self.dropout(self.encoder(x))&lt;/span&gt;
            
        &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Input RNN shape: &amp;#39;, embed_seq.shape)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# shape: [batch_size, seq_len, embedding_size]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rnn_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Out RNN shape: &amp;#39;, rnn_out.shape)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# rnn_out shape: [batch_size, seq_len, rnn_size]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# hidden shape: [2, num_layers, batch_size, rnn_size]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rnn_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dropout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# shape: [seq_len, batch_size, rnn_size]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Stack up LSTM outputs using view&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# you may need to use contiguous to reshape the output&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;rnn_out&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rnn_out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contiguous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decoder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# output shape: [seq_len * batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output model shape: &amp;#39;, logits.shape)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        initialises rnn states.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#return (Variable(torch.zeros(self.n_layers, batch_size, self.hidden_dim)),&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#        Variable(torch.zeros(self.n_layers, batch_size, self.hidden_dim)))&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# input shape: [seq_len, batch_size]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# logits shape: [seq_len * batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# hidden shape: [2, num_layers, batch_size, rnn_size]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;F&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# shape: [seq_len * batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;input&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# output shape: [seq_len, batch_size, vocab_size]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Training-the-model&quot;&gt;Training the model&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-the-model&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;After defining a RNN model, we can code the main training function. It is very simple and the steps involved are the usual ones in any other training of a neural network: in every epoch get the next batch data, move the tensors to the device, call the model (Forward pass), calculate the loss function, get the gradients and update the weights.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;train_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Training Run&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Store the loss in every batch iteration&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#epoch_losses = torch.Tensor(num_batches)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Init the hidden state&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# Train all the batches in every epoch&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Batch :&amp;#39;, i)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Get the next batch data for input and target&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Onr hot encode the input data&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Tranform to tensor&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Create a new variable for the hidden state, necessary to calculate the gradients&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;tuple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the input data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Input shape: &amp;#39;, input_data.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Hidden shape: &amp;#39;, hidden[0].shape, hidden[1].shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Set the model to train and prepare the gradients&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Clears existing gradients from previous epoch&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Pass Fordward the RNN&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the target data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(loss)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Save the loss&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#epoch_losses[i] = loss.item() #data[0]&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#data[0]&lt;/span&gt;
        
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Does backpropagation and calculates gradients&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# clip gradient norm&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clip_grad_norm_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            
            &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# Updates the weights accordingly&lt;/span&gt;
    
        &lt;span class=&quot;c1&quot;&gt;# Now, when epoch is finished, evaluate the model on validation data&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tqdm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;desc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Val Epoch &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Get the next batch data for input and target&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Onr hot encode the input data&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Tranform to tensor&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Create a new variable for the hidden state, necessary to calculate the gradients&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;tuple&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the input data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Pass Fordward the RNN&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Output shape: &amp;#39;, output.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Move the target data to the device&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(&amp;#39;Target shape; &amp;#39;, target_data.shape)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss_fn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;#print(loss)&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;# Save the loss&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#data[0]&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;                  
        &lt;span class=&quot;c1&quot;&gt;#if epoch%2 == 0:&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Epoch: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.............&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Train Loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;end&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Val Loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_losses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch_losses&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Before we start building the model, let's use a build in feature in PyTorch to check the device we're running on (CPU or GPU). This implementation will not require GPU as the training is really simple. However, as you progress on to large datasets and models with millions of trainable parameters, using the GPU will be very important to speed up your training.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;set_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# torch.cuda.is_available() checks and returns a Boolean True if a GPU is available, else it&amp;#39;ll return False&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;is_cuda&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# If we have a GPU available, we&amp;#39;ll set our device to GPU. We&amp;#39;ll use this device variable later in our code.&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;is_cuda&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;cuda&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;GPU is available&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;cpu&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;GPU not available, CPU used&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;After defining the model above, we'll have to instantiate the model with the relevant parameters and define our hyperparamters as well. The hyperparameters we're defining below are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;n_epochs: Number of Epochs --&amp;gt; This refers to the number of times our model will go through the entire training dataset&lt;/li&gt;
&lt;li&gt;lr: Learning Rate --&amp;gt; This affects the rate at which our model updates the weights in the cells each time backpropogation is done&lt;ul&gt;
&lt;li&gt;A smaller learning rate means that the model changes the values of the weight with a smaller magnitude&lt;/li&gt;
&lt;li&gt;A larger learning rate means that the weights are updated to a larger extent for each time step&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;batch_size: Number of examples to train on every train step&lt;/li&gt;
&lt;li&gt;maxlen: Length of the input sequence of char&lt;/li&gt;
&lt;li&gt;embedding_size: the vocab size because the input feature is one-hot-encoded&lt;/li&gt;
&lt;li&gt;hidden_dim: the number of hidden units in our LSTM module&lt;/li&gt;
&lt;li&gt;n_layers: number of layers of our LSTM module&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Define hyperparameters for training&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clip_norm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_fraction&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define hypeparameters of the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;64&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#64&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.2&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Set the device for training&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Device: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Set a seed to reproduce experiments&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;manual_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;GPU not available, CPU used
Device:  cpu
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;torch._C.Generator at 0x7f5761eba3b0&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Similar to other neural networks, we have to define the optimizer and loss function as well. We’ll be using CrossEntropyLoss as the final output is basically a classification task.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Instantiate the model with hyperparameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RNNModel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# We&amp;#39;ll also set the model to the device that we defined earlier (default is CPU)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Define Loss, Optimizer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;RNNModel(
  (dropout): Dropout(p=0.2, inplace=False)
  (rnn): LSTM(38, 64, batch_first=True, dropout=0.2)
  (decoder): Linear(in_features=64, out_features=38, bias=True)
)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/home/ec2-user/anaconda3/envs/pytorch_p36/lib/python3.6/site-packages/torch/nn/modules/rnn.py:50: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.2 and num_layers=1
  &amp;#34;num_layers={}&amp;#34;.format(dropout, num_layers))
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Limit the size of our input sequence to limit the training time, we are just testing the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;100000
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Calculate the number of batches to train&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;val_fraction&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the batch data generator&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_generator_sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;losses&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;val_batches&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; 
                    &lt;span class=&quot;n&quot;&gt;maxlen&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clip_norm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Epoch 1/6: 100%|██████████| 22/22 [00:02&amp;lt;00:00,  8.41it/s]
Val Epoch 1/6: 100%|██████████| 2/2 [00:00&amp;lt;00:00, 61.46it/s]
Epoch 2/6:  14%|█▎        | 3/22 [00:00&amp;lt;00:00, 24.20it/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch: 1/5............. Train Loss: 3.0507 Val Loss: 2.8581
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Epoch 2/6: 100%|██████████| 22/22 [00:00&amp;lt;00:00, 24.67it/s]
Val Epoch 2/6: 100%|██████████| 2/2 [00:00&amp;lt;00:00, 61.66it/s]
Epoch 3/6:  14%|█▎        | 3/22 [00:00&amp;lt;00:00, 24.21it/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch: 2/5............. Train Loss: 2.6476 Val Loss: 2.4374
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Epoch 3/6: 100%|██████████| 22/22 [00:00&amp;lt;00:00, 24.60it/s]
Val Epoch 3/6: 100%|██████████| 2/2 [00:00&amp;lt;00:00, 62.49it/s]
Epoch 4/6:  14%|█▎        | 3/22 [00:00&amp;lt;00:00, 24.54it/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch: 3/5............. Train Loss: 2.3630 Val Loss: 2.2691
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Epoch 4/6: 100%|██████████| 22/22 [00:00&amp;lt;00:00, 24.14it/s]
Val Epoch 4/6: 100%|██████████| 2/2 [00:00&amp;lt;00:00, 56.03it/s]
Epoch 5/6:  14%|█▎        | 3/22 [00:00&amp;lt;00:00, 23.93it/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch: 4/5............. Train Loss: 2.2456 Val Loss: 2.1838
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Epoch 5/6: 100%|██████████| 22/22 [00:00&amp;lt;00:00, 24.33it/s]
Val Epoch 5/6: 100%|██████████| 2/2 [00:00&amp;lt;00:00, 61.45it/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch: 5/5............. Train Loss: 2.1780 Val Loss: 2.1277
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Once the model is trained, we save it to disk then we can reload later and use ir for prediction. We also save the model parameters, they will be used to recreate the model if it is necessary.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Save the parameters used to construct the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_info_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;model_info.pth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;n_layers&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;embedding_dim&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embedding_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;hidden_dim&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;vocab_size&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dict_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;s1&quot;&gt;&amp;#39;drop_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_rate&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Save the model parameters&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_dir&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;model.pth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state_dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Predict-an-input-sequence&quot;&gt;Predict an input sequence&lt;a class=&quot;anchor-link&quot; href=&quot;#Predict-an-input-sequence&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;sample_from_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    truncated weighted random choice.&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# set probabilities after top_n to 0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;indices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#print(probs.shape)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sampled_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multinomial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sampled_index&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# One-hot encoding our input to fit into the model&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#character = one_hot_encode(character, len(vocab.char2int), character.shape[1], 1)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;functional&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Let’s test our model now and see what kind of output we will get.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_from_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hey&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# eval mode&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# First off, run through the starting characters&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Generate the initial hidden state&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# Warm up the initial state, predicting on the initial string&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#char, state = predict(model, ch, state, top_n=top_k)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_from_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Now pass in the previous characters and get a new one&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#char, h = predict_char(model, chars, vocab)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_from_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# append to sequence&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text_predicted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generate_from_text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;we want &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text_predicted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text_predicted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;GPU not available, CPU used
we want the he ares. ar to hat
30
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The next function  will feed our model one character at a time instead of providing it with the entire string of text.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;generate_from_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hey&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# eval mode&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# First off, run through the starting characters&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;out_len&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Generate the initial hidden state&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Warm up the initial state, predicting on the initial string&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#char, state = predict(model, ch, state, top_n=top_k)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_from_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# Include the last char predicted to the predicted output&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;   
    
    &lt;span class=&quot;c1&quot;&gt;# Now pass in the previous characters and get a new one&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ii&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;#char, h = predict_char(model, chars, vocab)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sample_from_probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;probs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;top_n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# append to sequence&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chars&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text_predicted&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;generate_from_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;we want &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text_predicted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text_predicted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;GPU not available, CPU used
we want what, and and whin she
30
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We also have developed a function to predict the next char given a initial string:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;predict_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# One-hot encoding our input to fit into the model&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char2int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#character = one_hot_encode(character, len(vocab.char2int), character.shape[1], 1)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;one_hot_encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Generate set the device&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;set_device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# eval mode&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Generate the initial hidden state&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;character&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;functional&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;softmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Taking the class with the highest probability score from the output&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;char_ind&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int2char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;char_ind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predict_char&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;we want &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Initial string: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;GPU not available, CPU used
Initial string:  t
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;At this point we are ready to train our model in Amazon SageMaker using the whole data set and improving its performance training on many epochs for a longer time.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Getting started with NLP: Word Embeddings, GloVe and Text classification</title><link href="https://edumunozsala.github.io/BlogEms/jupyter/nlp/classification/embeddings/python/2020/08/15/Intro_NLP_WordEmbeddings_Classification.html" rel="alternate" type="text/html" title="Getting started with NLP: Word Embeddings, GloVe and Text classification" /><published>2020-08-15T00:00:00-05:00</published><updated>2020-08-15T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/jupyter/nlp/classification/embeddings/python/2020/08/15/Intro_NLP_WordEmbeddings_Classification</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/jupyter/nlp/classification/embeddings/python/2020/08/15/Intro_NLP_WordEmbeddings_Classification.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-15-Intro_NLP_WordEmbeddings_Classification.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Word-Embeddings,-GloVe-and-Text-classification&quot;&gt;Word Embeddings, GloVe and Text classification&lt;a class=&quot;anchor-link&quot; href=&quot;#Word-Embeddings,-GloVe-and-Text-classification&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this notebook we are going to explain the concepts and use of word embeddings in NLP, using Glove as en example. Then we will try to apply the pre-trained Glove word embeddings to solve a text classification problem using this technique.&lt;/p&gt;
&lt;p&gt;As in other notebooks, we will follow the notebook from the great course on NLP by LazyProgrammer &quot;Natural Language Processing in Python&quot;:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/lazyprogrammer/machine_learning_examples/blob/master/nlp_class2/bow_classifier.py&quot;&gt;https://github.com/lazyprogrammer/machine_learning_examples/blob/master/nlp_class2/bow_classifier.py&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;About-the-data&quot;&gt;About the data&lt;a class=&quot;anchor-link&quot; href=&quot;#About-the-data&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h2 id=&quot;Large-Movie-Review-Dataset&quot;&gt;Large Movie Review Dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Large-Movie-Review-Dataset&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This is a dataset for binary sentiment classification containing substantially more data than previous benchmark datasets. We provide a set of 25,000 highly polar movie reviews for training, and 25,000 for testing. There is additional unlabeled data for use as well. Raw text and already processed bag of words formats are provided. See the README file contained in the release for more details.&lt;/p&gt;
&lt;p&gt;Link to dataset:
&lt;a href=&quot;http://ai.stanford.edu/~amaas/data/sentiment/&quot;&gt;http://ai.stanford.edu/~amaas/data/sentiment/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Publications Using the Dataset:&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Andrew L. Maas, Raymond E. Daly, Peter T. Pham, Dan Huang, Andrew Y. Ng, and Christopher Potts. (2011). Learning Word Vectors for Sentiment Analysis. The 49th Annual Meeting of the Association for Computational Linguistics (ACL 2011)&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Loading-the-libraries&quot;&gt;Loading the libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-libraries&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;c1&quot;&gt;#Import module to split the datasets&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Import modules to evaluate the metrics&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracy_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roc_auc_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;auc&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We set the variables for data location.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Global parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#root folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;glove_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;glove.6B.100d.txt&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Variable for data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;glove_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glove_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Both train and test set are in the root data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#Relevant columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TEXT_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Word-embeddings&quot;&gt;Word embeddings&lt;a class=&quot;anchor-link&quot; href=&quot;#Word-embeddings&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;What is word embedding?&lt;/strong&gt;
Word embeddings are a type of word representation that allows words with similar meaning to have a similar representation. They are a distributed representation for text that is perhaps one of the key breakthroughs for the impressive performance of deep learning methods on challenging natural language processing problems.&lt;/p&gt;
&lt;p&gt;Word embeddings are in fact a class of techniques where individual words are represented as real-valued vectors in a predefined vector space. Each word is mapped to one vector and the vector values are learned in a way that resembles a neural network, and hence the technique is often lumped into the field of deep learning. The distributed representation is learned based on the usage of words. This allows words that are used in similar ways to result in having similar representations, naturally capturing their meaning.&lt;/p&gt;
&lt;p&gt;Neural network embeddings have 3 primary purposes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Finding nearest neighbors in the embedding space. These can be used to make recommendations based on user interests or cluster categories.&lt;/li&gt;
&lt;li&gt;As input to a machine learning model for a supervised task.&lt;/li&gt;
&lt;li&gt;For visualization of concepts and relations between categories.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;How can we obtain the word embedings?&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Embedding Layer&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;An embedding layer is a word embedding that is learned in a neural network model on a specific natural language processing task. The documents or corpus of the task are cleaned and prepared and the size of the vector space is specified as part of the model, such as 50, 100, or 300 dimensions. The vectors are initialized with small random numbers. The embedding layer is used on the front end of a neural network and is fit in a supervised way using the Backpropagation algorithm.&lt;/p&gt;
&lt;p&gt;It is a flexible layer that can be used in a variety of ways, such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It can be used alone to learn a word embedding that can be saved and used in another model later.&lt;/li&gt;
&lt;li&gt;It can be used as part of a deep learning model where the embedding is learned along with the model itself.&lt;/li&gt;
&lt;li&gt;It can be used to load a pre-trained word embedding model, a type of transfer learning.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This approach requires a lot of training data and can be very slow, but will learn an embedding both targeted to the specific text data and the NLP task we are interested.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Word2Vec&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Word2Vec is a statistical method for efficiently learning a standalone word embedding from a text corpus. It was developed by Tomas Mikolov, et al. at Google in 2013 as a response to make the neural-network-based training of the embedding more efficient and since then has become the de facto standard for developing pre-trained word embedding.&lt;/p&gt;
&lt;p&gt;It learns the word embedding in one of two ways:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;either using context to predict a target word, a method known as continuous bag of words, or CBOW&lt;/li&gt;
&lt;li&gt;or using a word to predict a target context, which is called skip-gram, for example, we’d like to predict c context words having one target word on the input. 
The latter method usually produces more accurate results on large datasets.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;/BlogEms/images/copied_from_nb/images/CBOW.png&quot; alt=&quot;CBOW model&quot; title=&quot;CBOW Model&quot; /&gt;&lt;/p&gt;
&lt;p&gt;A well trained set of word vectors will place similar words close to each other in that space. The words oak, elm and birch might cluster in one corner, while war, conflict and strife huddle together in another.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Glove&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;The Global Vectors for Word Representation, or GloVe, algorithm is an extension to the word2vec method for efficiently learning word vectors, developed by Pennington, et al. at Stanford. GloVe is an unsupervised learning algorithm for obtaining vector representations for words. Training is performed on aggregated global word-word co-occurrence statistics from a corpus, and the resulting representations showcase interesting linear substructures of the word vector space.&lt;/p&gt;
&lt;p&gt;GloVe is an approach to marry both the global statistics of matrix factorization techniques like LSA (Latent Semantic Analysis) with the local context-based learning in word2vec. Rather than using a window to define local context, GloVe constructs an explicit word-context or word co-occurrence matrix using statistics across the whole text corpus.&lt;/p&gt;
&lt;p&gt;An extensive explanation on the next link:
Jeffrey Pennington, Richard Socher, and Christopher D. Manning. 2014. GloVe: Global Vectors for Word Representation. 
&lt;a href=&quot;https://nlp.stanford.edu/pubs/glove.pdf&quot;&gt;https://nlp.stanford.edu/pubs/glove.pdf&lt;/a&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Fasttext&lt;/strong&gt; &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;fastText is another word embedding method that is an extension of the word2vec model. Instead of learning vectors for words directly, fastText represents each word as an n-gram of characters. The FastText model takes into account internal structure of words by splitting them into a bag of character n-grams and adding to them a whole word as a final feature. If we denote n-gram vector as z and v as output vector representation of word w (context word):&lt;/p&gt;
&lt;p&gt;
$$s(w,c)=\sum_{g\in G_w}z^T_gv_c$$
&lt;/p&gt;
&lt;p&gt;We can choose n-grams of any size, but in practice size from 3 to 6 is the most suitable one.&lt;/p&gt;
&lt;p&gt;This helps capture the meaning of shorter words and allows the embeddings to understand suffixes and prefixes. A skip-gram model is trained to learn the embeddings. This model is considered to be a bag of words model with a sliding window over a word. fastText works well with rare words. So even if a word wasn’t seen during training, it can be broken down into n-grams to get its embeddings.&lt;/p&gt;
&lt;h4 id=&quot;Links&quot;&gt;Links&lt;a class=&quot;anchor-link&quot; href=&quot;#Links&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;https://towardsdatascience.com/neural-network-embeddings-explained-4d028e6f0526&quot;&gt;https://towardsdatascience.com/neural-network-embeddings-explained-4d028e6f0526&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Loading-a-pre-trained-word-embedding:-GloVe&quot;&gt;Loading a pre-trained word embedding: GloVe&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-a-pre-trained-word-embedding:-GloVe&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Files with the pre-trained vectors Glove can be found in many sites like Kaggle or in the previous link of the Stanford University. We will use the glove.6B.100d.txt file containing the glove vectors trained on the Wikipedia and GigaWord dataset.&lt;/p&gt;
&lt;p&gt;First we convert the GloVe file containing the word embeddings to the word2vec format for convenience of use. We can do it using the gensim library, a function called glove2word2vec.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# We just need to run this code once, the function glove2word2vec saves the Glove embeddings in the word2vec format &lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# that will be loaded in the next section&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gensim.scripts.glove2word2vec&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glove2word2vec&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#glove_input_file = glove_filename&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;word2vec_output_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glove_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.word2vec&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;glove2word2vec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;glove_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word2vec_output_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(400000, 100)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;So our vocabulary contains 400K words represented by a feature vector of shape 100. Now we can load the Glove embeddings in word2vec format and then analyze some analogies. In this way if we want to use a pre-trained word2vec embeddings we can simply change the filename and reuse all the code below.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gensim.models&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KeyedVectors&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# load the Stanford GloVe model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;word2vec_output_file&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;glove_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.word2vec&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;KeyedVectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_word2vec_format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word2vec_output_file&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;binary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#Show a word embedding&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;King: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;king&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;woman&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;king&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;man&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Most similar word to King + Woman: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;King:  [-0.32307  -0.87616   0.21977   0.25268   0.22976   0.7388   -0.37954
 -0.35307  -0.84369  -1.1113   -0.30266   0.33178  -0.25113   0.30448
 -0.077491 -0.89815   0.092496 -1.1407   -0.58324   0.66869  -0.23122
 -0.95855   0.28262  -0.078848  0.75315   0.26584   0.3422   -0.33949
  0.95608   0.065641  0.45747   0.39835   0.57965   0.39267  -0.21851
  0.58795  -0.55999   0.63368  -0.043983 -0.68731  -0.37841   0.38026
  0.61641  -0.88269  -0.12346  -0.37928  -0.38318   0.23868   0.6685
 -0.43321  -0.11065   0.081723  1.1569    0.78958  -0.21223  -2.3211
 -0.67806   0.44561   0.65707   0.1045    0.46217   0.19912   0.25802
  0.057194  0.53443  -0.43133  -0.34311   0.59789  -0.58417   0.068995
  0.23944  -0.85181   0.30379  -0.34177  -0.25746  -0.031101 -0.16285
  0.45169  -0.91627   0.64521   0.73281  -0.22752   0.30226   0.044801
 -0.83741   0.55006  -0.52506  -1.7357    0.4751   -0.70487   0.056939
 -0.7132    0.089623  0.41394  -1.3363   -0.61915  -0.33089  -0.52881
  0.16483  -0.98878 ]
Most similar word to King + Woman:  [(&amp;#39;queen&amp;#39;, 0.7698541283607483)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Analyzing-the-vector-space-and-find-analogies&quot;&gt;Analyzing the vector space and find analogies&lt;a class=&quot;anchor-link&quot; href=&quot;#Analyzing-the-vector-space-and-find-analogies&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We would like extract some interesting features of our word embeddings,Now, our words are numerical vectors so we can measure and compare distances between words to show some of the properties that these embedding provide.&lt;/p&gt;
&lt;p&gt;For example, we can compare some analogies. The most famous is the following: king – man + woman = queen. In other words, adding the vectors associated with the words king and woman while subtracting man is equal to the vector associated with queen. In others words, subtracting the concept of man to the concept of King we get a representation of the &quot;royalty&quot;. Then, if we sum to the woman word this concept we obtain the word &quot;queen&quot;. Another example is: france – paris + rome = italy. In this case, the vector difference between paris and france captures the concept of country.&lt;/p&gt;
&lt;p&gt;Now we will show some of thise analogies in different topics.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;woman&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;king&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;man&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;King - Man + Woman = &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rome&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;france&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;paris&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;France - Paris + Rome = &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;english&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;france&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;french&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;France - french + english = &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;june&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;december&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;november&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;December - November + June = &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;sister&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;man&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;woman&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Man - Woman + Sister = &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;King - Man + Woman =  [(&amp;#39;queen&amp;#39;, 0.7698541283607483)]
France - Paris + Rome =  [(&amp;#39;italy&amp;#39;, 0.8295994400978088)]
France - french + english =  [(&amp;#39;england&amp;#39;, 0.7678162455558777)]
December - November + June =  [(&amp;#39;july&amp;#39;, 0.9814669489860535)]
Man - Woman + Sister =  [(&amp;#39;brother&amp;#39;, 0.8288711905479431)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can observe how the word vectors include information to relate countries with nationalities, months of the year, family relationships, etc.&lt;/p&gt;
&lt;p&gt;But not always we get the expected results:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#But not always we get the expected result&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;aunt&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;nephew&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;negative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;niece&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;France - Paris + Rome = &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;France - Paris + Rome =  [(&amp;#39;uncle&amp;#39;, 0.8936851024627686)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We can extract wich words are more similar to another word, so they all are &quot;very close&quot; in the vector space.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;spain&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;10 most similar words to Spain: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;football&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;10 most similar words to Football: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_similar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;positive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;doctor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;topn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;10 most similar words to Doctor: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;10 most similar words to Spain:  [(&amp;#39;portugal&amp;#39;, 0.797070324420929), (&amp;#39;argentina&amp;#39;, 0.7758234143257141), (&amp;#39;italy&amp;#39;, 0.7746187448501587), (&amp;#39;france&amp;#39;, 0.7557463645935059), (&amp;#39;spanish&amp;#39;, 0.734722375869751), (&amp;#39;brazil&amp;#39;, 0.724494457244873), (&amp;#39;mexico&amp;#39;, 0.7206876277923584), (&amp;#39;madrid&amp;#39;, 0.7078269124031067), (&amp;#39;morocco&amp;#39;, 0.7001036405563354), (&amp;#39;netherlands&amp;#39;, 0.6802704334259033)]

10 most similar words to Football:  [(&amp;#39;soccer&amp;#39;, 0.8732221126556396), (&amp;#39;basketball&amp;#39;, 0.855563759803772), (&amp;#39;league&amp;#39;, 0.8153362274169922), (&amp;#39;rugby&amp;#39;, 0.8007533550262451), (&amp;#39;hockey&amp;#39;, 0.7833694219589233), (&amp;#39;club&amp;#39;, 0.7730998396873474), (&amp;#39;team&amp;#39;, 0.7720499038696289), (&amp;#39;baseball&amp;#39;, 0.7605736255645752), (&amp;#39;players&amp;#39;, 0.7399718761444092), (&amp;#39;player&amp;#39;, 0.7376238107681274)]

10 most similar words to Doctor:  [(&amp;#39;physician&amp;#39;, 0.7673239707946777), (&amp;#39;nurse&amp;#39;, 0.75215083360672), (&amp;#39;dr.&amp;#39;, 0.7175193428993225), (&amp;#39;doctors&amp;#39;, 0.7080885171890259), (&amp;#39;patient&amp;#39;, 0.7074184417724609), (&amp;#39;medical&amp;#39;, 0.6995993256568909), (&amp;#39;surgeon&amp;#39;, 0.6905338764190674), (&amp;#39;hospital&amp;#39;, 0.690092921257019), (&amp;#39;psychiatrist&amp;#39;, 0.658909797668457), (&amp;#39;dentist&amp;#39;, 0.6447421312332153)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Lets show some measure of similarities between words&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;similar_by_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;cat&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; Cat is similar to &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;similar_by_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;father&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot; Father is similar to &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{:.4f}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt; Cat is similar to dog: 0.8798
 Father is similar to son: 0.9240
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The idea behind all of the word embeddings is to capture with them as much of the semantical/morphological/context/hierarchical/etc. information as possible, but in practice one methods are definitely better than the other for a particular task (for instance, LSA is quite effective when working in low-dimensional space for the analysis of incoming documents from the same domain zone as the ones, which are already processed and put into the term-document matrix). The problem of choosing the best embeddings for a particular project is always the problem of try-and-fail approach, so realizing why in particular case one model works better than the other sufficiently helps in real work.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Visualization-of-word-embeddings&quot;&gt;Visualization of word embeddings&lt;a class=&quot;anchor-link&quot; href=&quot;#Visualization-of-word-embeddings&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Another exciting operation we can do with embeddings is visualization, plotting them in a 2D dimensional space can show us how words are related. Most similar words should be plotted in groups while non related words will appear in a large distance. This requires a further dimension reduction technique to get the dimensions to 2 or 3. The most popular technique for reduction is itself an embedding method: t-Distributed Stochastic Neighbor Embedding (TSNE).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;t-SNE stands for t-distributed stochastic neighbor embedding. It is a technique for dimensionality reduction that is best suited for the visualization of high dimensional data-set.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;TSNE is a manifold learning technique which means that it tries to map high-dimensional data to a lower-dimensional manifold, creating an embedding that attempts to maintain local structure within the data. It's almost exclusively used for visualization because the output is stochastic and it does not support transforming new data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.decomposition&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;IncrementalPCA&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;# inital reduction&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.manifold&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TSNE&lt;/span&gt;                   &lt;span class=&quot;c1&quot;&gt;# final reduction&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;                                  &lt;span class=&quot;c1&quot;&gt;# array handling&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;display_closestwords_tsnescatterplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;empty&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;f&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;word_labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# get close words&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#close_words = [model.similar_by_word(word) for word in words]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# add the vector for each of the closest words to the array&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;close_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;close_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;similar_by_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrd_score&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;close_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;wrd_vector&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrd_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;word_labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrd_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wrd_vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
    &lt;span class=&quot;c1&quot;&gt;# find tsne coords for 2 dimensions&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tsne&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TSNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_components&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#np.set_printoptions(suppress=True)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsne&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;x_coords&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_coords&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# display scatter plot&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_coords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_coords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;zip&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_coords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_coords&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;annotate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xytext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;textcoords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;offset points&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x_coords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.00005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x_coords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.00005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_coords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.00005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_coords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.00005&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tsne_plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;s2&quot;&gt;&amp;quot;Creates and TSNE model and plots it&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tokens&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;#for word in model.wv.vocab:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;tokens&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;tsne_model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TSNE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;perplexity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_components&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;pca&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_iter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;23&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;new_values&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tsne_model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;new_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; 
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scatter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;annotate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;xy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;xytext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;textcoords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;offset points&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;ha&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                     &lt;span class=&quot;n&quot;&gt;va&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;bottom&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;For example, we will plot a hundred words from our word embeddings and also the most similar words to the concept of woman and car. All similar words should be plotted closely, while the rest of words will apear distributed across the vector space:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#display_closestwords_tsnescatterplot(model, 100, [&amp;#39;man&amp;#39;, &amp;#39;dog&amp;#39;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;word1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;words2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;similar_by_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;woman&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;words3&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;similar_by_word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;car&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;w&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;w&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#print(words)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tsne_plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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PyYyDg6uvyU4IiJSGSiJERGRSqVVy5do3foNqrp4AgZVXTxp2fIVbbMsIlKJOJV1ACIiIsXNo0EfJS0iIpWYRmJERERERKRCURIjIiIiIiIVipIYERERERGpUJTEiIiIiIhIhaIkRkREREREKhQlMSIiIiIiUqEoiRERERERkQpFSYyIiIiIiFQoSmJERERERKRCURIjIiIiIiIVipIYERERERGpUJTEiIiIiIhIhaIkRkREREREKhQlMSIiIiIiUqEoiRERERERkQpFSYyIiIiIiFQo15zEGIbRyDCM5YZhbDcMY6thGCOLIzAREREREZGiOBVDGzbgSdM0NxiGUR1INgzjB9M0txVD2yIiIiIiIhe55pEY0zQzTNPc8Nvr08B2oOG1tisiIiIiIlKUYl0TYxiGFxAI/Fyc7YqIiIiIiFxQbEmMYRjuQALwuGmap4q4PtQwjCTDMJKOHj1aXN2KiIiIiMh1pliSGMMwnClMYOJN05xXVB3TNKeYphlsmmbwDTfcUBzdioiIiIjIdag4diczgKnAdtM037z2kERERERERC6vOEZiwoD7gG6GYaT89s/txdCuiIiIiIjIJa55i2XTNBMBoxhiERERERER+VPFujuZiFReNputrEMQERERAYrnsEsRqSCsVis9evQgNDSUjRs30rx5c2bMmMHEiRNZtGgROTk5dOjQgY8++gjDMAgPD6dDhw6sWrWKqKgoUlNTcXV1JS0tjV9//ZVp06bx6aefsmbNGkJDQ5k+fToADz/8MOvXrycnJ4fo6GhefPHFsn1wERERqVQ0EiNyndmxYwdDhw5l8+bN1KhRgw8++IBHH32U9evXs2XLFnJycvjqq6/s9TMzM/nxxx958sknATh58iTLli1j0qRJ9O7dm1GjRrF161ZSU1NJSUkB4JVXXiEpKYnNmzfz448/snnz5jJ5VhEREamclMSIXGcaNWpEWFgYAPfeey+JiYksX76c0NBQLBYLy5YtY+vWrfb6AwYMuOj+3r17YxgGFouFG2+8EYvFgoODAz4+PlitVgBmz55NUFAQgYGBbN26lW3btpXa84mIiEjlp+lkIteZwl3RL34/fPhwkpKSaNSoEXFxceTm5tqvV6tW7aL6Li4uADg4ONhfX3hvs9nYs2cPEydOZP369dSuXZuYmJiL2hMRERG5VhqJEbnO7N27lzVr1gDwxRdf0LFjRwDq1atHdnY2c+fOvab2T506RbVq1ahZsyaHDx/mm2++ueaYRURERH5PIzEi15lWrVrx6aef8tBDD9GsWTMefvhhTp48icViwcvLi5CQkGtq39/fn8DAQHx8fGjSpIl96pqIiIhIcTFM0yz1ToODg82kpKRS71fkeme1WunVqxdbtmwp61BERERErsgwjGTTNIOLuqaRGBEpNmc2HuHUd1bOZ+bhWMuFGt29qBZYv6zDEhERkUpGSYzIdcTLy6vERmHObDxC5rydmPkFAJzPzCNz3k4AJTIiIiJSrLSwX0SKxanvrPYE5gIzv4BT31nLJiARERGptJTEiFRCK1asYPXq1fb3MTEx17zr2J85n5lnf70vK4P/bvvhknIRERGR4qAkRqQS+mMSUxoca/3vzJj9WYdYsG3JJeUiIiIixUFJjEg5c+bMGXr27Im/vz++vr7MmjWLpUuXEhgYiMViYciQIeTlFY5ueHl5cezYMQCSkpIIDw/HarUyefJkJk2aREBAAD/99BMAK1eupEOHDjRp0sQ+KpOdnU1ERARBQUFYLBYWLFgAFO5i1rJlSx544AF8fX0ZOHAgS5YsISwsjGbNmrFu3ToA4uLiuO++++jWrRudPvgHM1O/AuDVFR+xbt9muk8fwoyj35Kbm8vgwYOxWCwEBgayfPlyAKZPn07fvn3p0aMHzZo146mnniq9D1pEREQqLC3sFylnvv32Wzw9PVm8eDEAWVlZ+Pr6snTpUpo3b87999/Phx9+yOOPP17k/V5eXgwbNgx3d3diY2MBmDp1KhkZGSQmJpKWlkZUVBTR0dFUrVqV//73v9SoUYNjx47Rrl07oqKiAPjll1+YM2cOU6ZMISQkhJkzZ5KYmMjChQuZMGEC8+fPB2Dz5s2sXbuWM2fOEODrz//5d2ZM+ENM2TCb+V/Mo1pgfd544w0AUlNTSUtLIzIykvT0dABSUlLYuHEjLi4utGjRghEjRtCoUaMS/YxFRESkYtNIjEg5Y7FYWLJkCU8//TQ//fQTVqsVb29vmjdvDsCgQYNYuXLlVbd7xx134ODgQOvWrTl8+DAApmny7LPP4ufnx6233sqBAwfs17y9vbFYLDg4OODj40NERASGYWCxWLBarfZ2+/Tpg6urK/Xq1aNbZAS/ts3nhqF+uDStZd+VLDExkfvuuw+Ali1b0rhxY3sSExERQc2aNalatSqtW7fm119//dufnYiIiFwfNBIjUs40b96c5ORkvv76a8aMGUNkZORl6zo5OVFQULgjWG5u7hXbdXH539qUC4fcxsfHc/ToUZKTk3F2dsbLy8vezu/rOzg42N87ODhgs9ns1wzDuKifP77/fX9/Fpejo+NFbYuIiIgURSMxIuXMwYMHcXNz49577yU2NpbVq1djtVr55ZdfAPjss8/o0qULUDh1LDk5GYCEhAR7G9WrV+f06dN/2ldWVhb169fH2dmZ5cuX/61RkAULFpCbm8vx48dZsWIFISEhl/TfuXNn4uPjAUhPT2fv3r20aNHiqvsSERERAY3EiJQ7qampjB49GgcHB5ydnfnwww/Jysqif//+2Gw2QkJCGDZsGADjxo3jn//8JxMmTCA0NNTeRu/evYmOjmbBggW8++67l+1r4MCB9O7dm+DgYAICAmjZsuVVx9u2bVt69uzJ3r17GTt2LJ6entxwww04OTnh7+9PTEwMw4cPZ9iwYVgsFpycnJg+ffpFIzAiIiIiV8O40jSPkhIcHGwmJSWVer8iUrzi4uIu2kBAREREpLgYhpFsmmZwUdc0EiMiZeLMxiOc+s7K+cw8HGu5UKO7l30jABEREZErURIjIn9bXFzc37rvzMYjZM7biZlfuCnB+cw8MuftBFAiIyIiIn9KC/tFpNSd+s5qT2AuMPMLOPWdtWwCEhERkQpFSYyIlLrzmXlXVS4iIiLye0piRKTUOdYqemeyy5WLiIiI/J6SGBEpdTW6e2E4X/zXj+HsQI3uXmUTkIiIiFQoWtgvIqXuwuJ97U4mIiIif4eSGBEpE9UC6ytpERERkb9F08lERERERKRCURIjIuVaXFwcEydOLOswREREpBxREiMi5ZbNZivrEERERKQcUhIjIqVixowZ+Pn54e/vz3333cevv/5KREQEfn5+REREsHfvXgBiYmJ44okn6Nq1K08//fRFbXz88cfcdttt5OTklMUjiIiISDmhJEZEStzWrVt55ZVXWLZsGZs2beLtt9/m0Ucf5f7772fz5s0MHDiQxx57zF4/PT2dJUuW8MYbb9jL3nvvPRYtWsT8+fNxdXUti8cQERGRckJJjIiUuGXLlhEdHU29evUAqFOnDmvWrOGee+4B4L777iMxMdFev3///jg6Otrff/bZZ3zzzTck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YAryl156yTF0Mz09na+//hoAHx8fvvzyS2655RbS09OB/LV4PDw8SEhI4PTp0wQGBtKpUydSU1NZunQpGzZsoHLlyhw9erTImCpUqMD48eML9MScW+s2ePBg+vTpQ9++fZk5cyZDhgxh6dKlABw6dIi1a9eSmppKly5d6N69e3F8bCJyAUpiRESusQstSKok5sZWxfcmJS2FqF+/PoGBgQD07t2b//znPxecgjw8PNzxc2BgIBERETzyyCM8/PDDAKxcuZKUlBRHL0hGRga7du0iJiaGfv36UblyZSB/uvMrtX79ej7++GMAHn/8cV544QXHtq5du1KuXDmaNGnCL7/8csXXEJErpyRGROQaO3X60GW1i9zo/joFubu7+wWnID93KvSoqCg2bNjAihUrsNvtJCcnY4zhrbfeIjQ0tMBxX3zxxXnXAnB1dXVM4PHXadev5D24ubk5fnZGbbGIqCZGROSaK2rhUS1IKmXVvn37HAnLggULaN269SVPQb57925atWrF+PHjqV27Nvv37yc0NJRp06Y5FpzduXMnJ06coFOnTsycOZOTJ08COIaTeXp6kpSUBFCghsXd3Z3MzMxCrxsQEMDChQsBmD9/Pm3btr3aj0FEriElMSIi15jXHcMpV65SgTYtSCplWePGjZkzZw42m42jR4/y7LPPsmjRIkaOHEmzZs2w2+188803hR47YsQIfHx88Pb2pl27djRr1oz+/fvTpEkTmjdvjre3N0899RQ5OTl07tyZLl264Ofnh91uZ9KkSQAMHz6cadOmERAQwJEjfy56GRISwrZt2xyF/eeaMmUKs2bNwmazMW/ePCZPnlx8H5CIXDZNsSwiUgwO/byMPbsncer0ISq61cXrjuGqh5EyKS0tjfvvv58tW7Y4OxQRKWUuNMWyamJERIqBFiQVufEs3XyAiV/u4GB6FvWqV2JEaEO6+t7i7LBEyiQNJxMREZFi4+npedW9MHFxcQWGm0VFRTF37lwgf1rkgwcPXtU5LsXSzQcY/fH3HEjPwgAH0rMY/fH3LN184NLfiIhcM+qJERERkesqNzcXFxeXS94/Li6OqlWrEhAQAMDAgQMd22bPno23tzf16tW74nNciolf7iArO7dAW1Z2LhO/3KHeGBEnUE+MiIiIXDNpaWk0atSIvn37YrPZ6N69OydPnsTT05Px48fTtm1b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5UWFChXo2bMny5YtK7DPtm3b6NixIwCNGjUiLS2NX375xRnhiojcMLTYpUgpdfz4capWrQrAhAkTOHToEJMnT3ZyVCJly6JFi/jiiy947733AJg3bx4bNmzg7bffduzz4osvcurUKd544w02btxIQEAAGzZsoEWLFs4KW0SkVLjQYpdaJ0akFEpJSWHSpEmsXLkSy7K46667HLOWicj1U9iDwL/WxY0aNYqhQ4dit9vx8fHB19cXV1f9+RURuRr6LSpSyqSkpLB8+XK8vLwYOHAgAOXLl+fQoUPUqVPHydGJlC1///vf2b9/v+P1Tz/9RL169QrsU61aNWbNmgXkJz233347t99++3WNU0TkRqOaGJFSZtWqVWRnZxdoy87OZtWqVU6KSKTs8vf3Z9euXezdu5czZ86wcOFCunTpUmCf9PR0zpw5A8B7771Hu3btqFatmjPCFRG5YagnRqSUycjIuKx2ESk+rq6uvP3224SGhpKbm8sTTzxB06ZNiYqKAmDgwIFs376dPn364OLiQpMmTZgxY4aToxYRKf2UxIiUMh4eHoUmLJqdTMQ57rvvPu67774CbWeHegK0adOGXbt2Xe+wRERuaEpiREqZjh07snz58gJDysqXL++YwlVESo7t8bHEL5xL5m9HcK9Vm6CefWgcFOLssERESj0lMSKljM1mA/JrYzIyMvDw8KBjx46OdhEpGbbHx7Jy+tvknDkNQOaRw6ycnj/1shIZEZGroyRGpBSy2WxKWkRKuPiFcx0JzFk5Z04Tv3CukhgRkauk2clERESKQeZvRy6rXURELp2SGBERkWLgXqv2ZbWLiMilUxIjIiJSDIJ69sG1gluBNtcKbgT17OOkiEREbhyqiRERESkGZ+teNDuZiMi1pyRGRESkmDQOClHSIiJSDDScTEREREREShUlMSIiIiIiUqooiRERERERkVJFSYyIiIiIiJQqSmJERERERKRUURIjIiIiIiKlipIYEREREREpVZTEiIiIiIhIqaIkRkREREREShUlMSIiIiIiUqooiRERERERkVJFSYyIiIiIiJQqV5XEWJZltyzrW8uyki3LSrQsq+W1CkxERERERKQwV9sT8zowzhhjB8b+8VpERERERKTYXG0SY4Bqf/zsARy8yvOJiIiIiIhckOtVHv8c8KVlWZPIT4gCrj4kERERERGRol00ibEsKwa4uZBNLwEdgWHGmMWWZT0CzADuLuI8A4ABALfeeusVBywiIiIiImWbZYy58oMtKwOobowxlmVZQIYxptrFjvPz8zOJiYlXfF0REREREbmxWZaVZIzxK2zb1dbEHATa//FzB2DXVZ5PRERERETkgq62JuZJYLJlWa7AKf4YLiYiIiIiIlJcriqJMcasBVpco1hEREREREQu6mqHk4mIiIiIiFxXSmJERERERKRUuarZya74opZ1GPjxul+4ZKkNHHF2EOJ0ug/kLN0LAroP5E+6FwR0H9xmjKlT2AanJDEClmUlFjVlnJQdug/kLN0LAroP5E+6FwR0H1yIhpOJiIiIiEipoiRGRERERERKFSUxzjPd2QFIiaD7QM7SvSCg+0D+pHtBQPdBkVQTIyIiIiIipYp6YkREREREpFRREuMklmXZLcv61rKsZMuyEi3LaunsmMR5LMt61rKsHZZlbbUs63VnxyPOY1nWcMuyjGVZtZ0diziHZVkTLctKtSwrxbKsJZZlVXd2THL9WJbV+Y+/Bz9YljXK2fGIc1iWVd+yrFjLsrb/8d1gqLNjKmmUxDjP68A4Y4wdGPvHaymDLMsKAR4EbMaYpsAkJ4ckTmJZVn3gHmCfs2MRp/oK8DbG2ICdwGgnxyPXiWVZLsBU4F6gCfCoZVlNnBuVOEkO8E9jTGOgNTBI90JBSmKcxwDV/vjZAzjoxFjEuZ4GJhhjTgMYY351cjziPG8CL5D/+0HKKGPMSmNMzh8vvwX+7sx45LpqCfxgjNljjDkDLCT/IZeUMcaYQ8aYTX/8nAlsB25xblQli5IY53kOmGhZ1n7yn7zrSVvZ1QAIsixrg2VZX1uW5e/sgOT6syyrC3DAGPOds2OREuUJ4HNnByHXzS3A/nNe/4S+uJZ5lmV5Ar7ABudGUrK4OjuAG5llWTHAzYVsegnoCAwzxiy2LOsRYAZw9/WMT66fi9wLrkAN8ruL/YEPLcvyMpo68IZzkfvgRaDT9Y1InOVC94IxZtkf+7xE/pCS+dczNnEqq5A2/S0owyzLqgosBp4zxhxzdjwliaZYdhLLsjKA6sYYY1mWBWQYY6pd7Di58ViW9QX5w8ni/ni9G2htjDns1MDkurEsywdYBZz8o+nv5A8xbWmM+dlpgYnTWJbVFxgIdDTGnLzY/nJjsCyrDRBpjAn94/VoAGPMa04NTJzCsqzywKfAl8aYN5wdT0mj4WTOcxBo/8fPHYBdToxFnGsp+fcAlmU1ACoAR5wakVxXxpjvjTE3GWM8jTGe5A8haa4EpmyyLKszMBLoogSmzEkA7rIs63bLsioAPYFPnByTOMEfD7hnANuVwBROw8mc50lgsmVZrsApYICT4xHnmQnMtCxrC3AG6KuhZCJl2tuAG/BV/vcYvjXGDHRuSHI9GGNyLMsaDHwJuAAzjTFbnRyWOEcg8DjwvWVZyX+0vWiM+cyJMZUoGk4mIiIiIiKlioaTiYiIiIhIqaIkRkREREREShUlMSIiIiIiUqooiRERERERkVJFSYyIiIiIiJQqSmJERERERKRUURIjIrSFcXwAAAAVSURBVCIiIiKlipIYEREREREpVf4/hLY2I1LvNvMAAAAASUVORK5CYII=
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In the previous picture, we can observe how the most similar words to &quot;woman&quot; and &quot;car&quot; are very close, while other bunch of words are distributed uniformly on the vector space.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-the-dataset&quot;&gt;Loading the dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-dataset&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Out IMdb reviews can be loaded from keras.dataset. But in this dataset the tokens has already been &quot;numericalized&quot;, but we want them as plain text, so we need to reverse them to the original tokens. Then, we load the dataset, load the vocabulary and we will use the vocab to get the original token for every single token in the whole dataset.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;keras.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;imdb&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;imdb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;word_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;imdb&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_word_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;reverse_word_index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;value&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;review&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reverse_word_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Using TensorFlow backend.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Vocabulary lenght: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Review example: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;review&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Label: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Vocabulary lenght:  88584
Review example:  [&amp;#39;&amp;#39;, &amp;#39;this&amp;#39;, &amp;#39;film&amp;#39;, &amp;#39;was&amp;#39;, &amp;#39;just&amp;#39;, &amp;#39;brilliant&amp;#39;, &amp;#39;casting&amp;#39;, &amp;#39;location&amp;#39;, &amp;#39;scenery&amp;#39;, &amp;#39;story&amp;#39;, &amp;#39;direction&amp;#39;, &amp;#34;everyone&amp;#39;s&amp;#34;, &amp;#39;really&amp;#39;, &amp;#39;suited&amp;#39;, &amp;#39;the&amp;#39;, &amp;#39;part&amp;#39;, &amp;#39;they&amp;#39;, &amp;#39;played&amp;#39;, &amp;#39;and&amp;#39;, &amp;#39;you&amp;#39;]
Label:  1
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Convert the train and test dataset to strings of words&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reverse_word_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reverse_word_index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;25000 25000
 this film was just brilliant casting location scenery story direction everyone&amp;#39;s really suited the part they played and you could just imagine being there robert redford&amp;#39;s is an amazing actor and now the same being director norman&amp;#39;s father came from the same scottish island as myself so i loved the fact there was a real connection with this film the witty remarks throughout the film were great it was just brilliant so much that i bought the film as soon as it was released for retail and would recommend it to everyone to watch and the fly fishing was amazing really cried at the end it was so sad and you know what they say if you cry at a film it must have been good and this definitely was also congratulations to the two little boy&amp;#39;s that played the part&amp;#39;s of norman and paul they were just brilliant children are often left out of the praising list i think because the stars that play them all grown up are such a big profile for the whole film but these children are amazing and should be praised for what they have done don&amp;#39;t you think the whole story was so lovely because it was true and was someone&amp;#39;s life after all that was shared with us all
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Applying-the-word-embedding-to-a-text-classification-task&quot;&gt;Applying the word embedding to a text classification task&lt;a class=&quot;anchor-link&quot; href=&quot;#Applying-the-word-embedding-to-a-text-classification-task&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now, we have our word representation, a vector for every word in our vocabulary. But we need to deal with full sentences so we need to create a sentence embedding, basically we need a vector that represent the whole sentence and every feature in the vector will be based on the word embeddings. There are many posibilities and we are notr going to cover this topic, so we apply a very simple method: the ith value in the sentence embedding will be the mean of the ith values in the word embedding of all the words in the sentence.&lt;/p&gt;
&lt;p&gt;We will create a class that will contain our vocabulary and glove vectors and then it will transform every review (a sentence in our example) to a vector representation as we describe previously.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Word2VecVectorizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Loading in word vectors...&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_vectors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Finished loading in word vectors&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# determine the dimensionality of vectors&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_vectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;king&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;emptycount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;tokens&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sentence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;vecs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;word&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokens&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;# throws KeyError if word not found&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;vec&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word_vectors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_vector&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;vecs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vec&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt; &lt;span class=&quot;ne&quot;&gt;KeyError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;pass&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vecs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vecs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;emptycount&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Numer of samples with no words found: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; / &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;emptycount&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;


  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Next, we create a Vectorizer object that will help us to transform our reviews to vectors, a numerical representation. Then we can use those vectors to feed our classifier.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Set a word vectorizer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vectorizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Word2VecVectorizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the sentence embeddings for the train dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_labels&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Get the sentence embeddings for the test dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectorizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_labels&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Loading in word vectors...
Finished loading in word vectors
Numer of samples with no words found: 0 / 25000
Numer of samples with no words found: 0 / 25000
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(25000, 100) (25000, 100)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Train-a-classifier-on-the-sentence-embeddings&quot;&gt;Train a classifier on the sentence embeddings&lt;a class=&quot;anchor-link&quot; href=&quot;#Train-a-classifier-on-the-sentence-embeddings&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;As text classification is just a type of classification problem we can apply some of the well-known classifiers to predict the label of a text. The next cells build different models to solve our classification task.&lt;/p&gt;
&lt;p&gt;But first we create some helper functions to plot the results:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the confussion matrix&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Plot the confussion matrix for the target labels and predictions &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Create a dataframe with the confussion matrix values&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
                  &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#plt.figure(figsize = (10,7))&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Plot the confussion matrix&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;font_scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#for label size&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heatmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;annot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.0f&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;annot_kws&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# font size&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# ROC Curve&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# plot no skill&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Calculate the points in the ROC curve&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Plot the ROC curve for the target labels and predictions&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresholds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;roc_auc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Receiver Operating Characteristic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;AUC = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%0.2f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roc_auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;lower right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;r--&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;True Positive Rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;False Positive Rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;A-random-forest-classifier&quot;&gt;A random forest classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#A-random-forest-classifier&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;First, we try with a simple model, a Random Forest. It can be considered as a baseline benchmark to any binary clasification problem.&lt;/p&gt;
&lt;p&gt;This notebook is about word embeddings, so we are not covering or interested in building the best classifier. We want to show us how to use the embeddings in a very simple way.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.ensemble&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# create the model, train it, print scores&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomForestClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_estimators&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;test score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;train score: 1.0
test score: 0.76
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Predicting the Test set results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;              precision    recall  f1-score   support

           0    0.76895   0.74336   0.75594     12500
           1    0.75163   0.77664   0.76393     12500

    accuracy                        0.76000     25000
   macro avg    0.76029   0.76000   0.75993     25000
weighted avg    0.76029   0.76000   0.75993     25000

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Suport-Vector-Machine-Classifier&quot;&gt;Suport Vector Machine Classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#Suport-Vector-Machine-Classifier&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;What-is-Support-Vector-Machines?&quot;&gt;What is Support Vector Machines?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-Support-Vector-Machines?&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;em&gt;The objective of the support vector machine algorithm is to find a hyperplane in an N-dimensional space(N — the number of features) that distinctly classifies the data points.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In a binary classification problem, to separate the two classes of data points, there are many possible hyperplanes that could be chosen. Our objective is to find a plane that has the maximum margin, i.e the maximum distance between data points of both classes. Maximizing the margin distance provides some reinforcement so that future data points can be classified with more confidence. Support vectors are data points that are closer to the hyperplane and influence the position and orientation of the hyperplane. Using these support vectors, we maximize the margin of the classifier.&lt;/p&gt;
&lt;p&gt;We can use SVM algorithm to predict if a review is positive or genative, it is just a binary classifcation problem. We use GridSearch to fine tune some of the hyperparameters of the model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.svm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define the parameters to tune&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; 
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;C&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;gamma&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;scale&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tune yyperparameters  using Grid Search and a SVM model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rbf&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_jobs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Once our model is trained we can evaluate the performance as we did previously:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Predicting the Test set results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;              precision    recall  f1-score   support

           0    0.81298   0.81688   0.81492     12500
           1    0.81600   0.81208   0.81403     12500

    accuracy                        0.81448     25000
   macro avg    0.81449   0.81448   0.81448     25000
weighted avg    0.81449   0.81448   0.81448     25000

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;XGBoost-classifier&quot;&gt;XGBoost classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#XGBoost-classifier&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;XGBoost is an implementation of gradient boosted decision trees designed for speed and performance that is dominative competitive machine learning. XGBoost is an advanced version of gradient boosting, rather than training all of the models in isolation of one another, boosting trains models in succession, with each new model being trained to correct the errors made by the previous ones. Models are added sequentially until no further improvements can be made.&lt;/p&gt;
&lt;p&gt;XGBoost provides a wrapper class to allow models to be treated like classifiers or regressors in the scikit-learn framework. This means we can use the full scikit-learn library with XGBoost models.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;lightgbm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LGBMClassifier&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f1_metric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ytrue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Return the F1 Score value for the preds and true values, ytrue &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;f1_score&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ytrue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;macro&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.06&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;n_estimators&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;colsample_bytree&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;metric&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;f1_score&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LGBMClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit or train the xgboost model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eval_set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eval_metric&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f1_metric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Show the results&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtrain&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytrain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;test score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[400]	valid_0&amp;#39;s f1_score: 0.939439	valid_1&amp;#39;s f1_score: 0.794031
[800]	valid_0&amp;#39;s f1_score: 0.98856	valid_1&amp;#39;s f1_score: 0.795111
[1200]	valid_0&amp;#39;s f1_score: 0.99912	valid_1&amp;#39;s f1_score: 0.795115
train score: 0.99996
test score: 0.7964
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Predicting the Test set results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Xtest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ytest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;              precision    recall  f1-score   support

           0    0.81298   0.81688   0.81492     12500
           1    0.81600   0.81208   0.81403     12500

    accuracy                        0.81448     25000
   macro avg    0.81449   0.81448   0.81448     25000
weighted avg    0.81449   0.81448   0.81448     25000

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Links&quot;&gt;Links&lt;a class=&quot;anchor-link&quot; href=&quot;#Links&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Link to blog post or aditional readings:&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://machinelearningmastery.com/what-are-word-embeddings/&quot;&gt;https://machinelearningmastery.com/what-are-word-embeddings/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://machinelearningmastery.com/develop-word-embeddings-python-gensim/&quot;&gt;https://machinelearningmastery.com/develop-word-embeddings-python-gensim/&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">Getting started with NLP: Tokenization, Term-Document Matrix, TF-IDF and Text classification</title><link href="https://edumunozsala.github.io/BlogEms/jupyter/nlp/classification/python/2020/07/31/Intro_NLP_1_TFIDF_Text_Classification.html" rel="alternate" type="text/html" title="Getting started with NLP: Tokenization, Term-Document Matrix, TF-IDF and Text classification" /><published>2020-07-31T00:00:00-05:00</published><updated>2020-07-31T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/jupyter/nlp/classification/python/2020/07/31/Intro_NLP_1_TFIDF_Text_Classification</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/jupyter/nlp/classification/python/2020/07/31/Intro_NLP_1_TFIDF_Text_Classification.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-31-Intro_NLP_1_TFIDF_Text_Classification.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Getting-started-with-NLP:-Traditional-approaches&quot;&gt;Getting started with NLP: Traditional approaches&lt;a class=&quot;anchor-link&quot; href=&quot;#Getting-started-with-NLP:-Traditional-approaches&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;h1 id=&quot;Tokenization,-Term-Document-Matrix,-TF-IDF-and-Text-classification&quot;&gt;Tokenization, Term-Document Matrix, TF-IDF and Text classification&lt;a class=&quot;anchor-link&quot; href=&quot;#Tokenization,-Term-Document-Matrix,-TF-IDF-and-Text-classification&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;In this notebook we continue to describe some traditional methods to address an NLP task, text classification.&lt;/p&gt;
&lt;p&gt;This is an easy and fast to build text classifier, built based on a traditional approach to NLP problems. The steps to follow are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;describe the process of tokenization&lt;/li&gt;
&lt;li&gt;how to build a Term-Document Matrix (using some methods like Counting words and TFIDF) as the numericalization method&lt;/li&gt;
&lt;li&gt;and then apply a machine learning classifier to predict or classify a tweet as real or fake.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;Problem-Description&quot;&gt;Problem Description&lt;a class=&quot;anchor-link&quot; href=&quot;#Problem-Description&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Twitter has become an important communication channel in times of emergency. The ubiquitousness of smartphones enables people to announce an emergency they’re observing in real-time. Because of this, more agencies are interested in programatically monitoring Twitter (i.e. disaster relief organizations and news agencies). But, it’s not always clear whether a person’s words are actually announcing a disaster.&lt;/p&gt;
&lt;p&gt;In this problem, you’re challenged to build a machine learning model that predicts which Tweets are about real disasters and which one’s aren’t. You’ll have access to a dataset of 10,000 tweets that were hand classified.&lt;/p&gt;
&lt;p&gt;This is a &lt;a href=&quot;https://www.kaggle.com/c/nlp-getting-started&quot;&gt;Kaggle competition&lt;/a&gt; to getting started in NLP.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Importing-the-libraries&quot;&gt;Importing the libraries&lt;a class=&quot;anchor-link&quot; href=&quot;#Importing-the-libraries&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Import utility libraries&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sn&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;span class=&quot;c1&quot;&gt;# Import libraries for text manipulation&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.feature_extraction.text&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TfidfVectorizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CountVectorizer&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.naive_bayes&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultinomialNB&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Import modules for evaluation purposes&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Import libraries for predcton&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;accuracy_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roc_auc_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;wordcloud&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WordCloud&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;We set the variables for data location&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Global parameters&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#root folder&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#data_folder=&amp;#39;.&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;data&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cleaned_train.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Variable for data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;abspath&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;root_folder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data_folder_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Both train and test set are in the root data directory&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test_path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DATA_PATH&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;#Relevant columns&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TEXT_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;text&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;target&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Loading-the-datasets&quot;&gt;Loading the datasets&lt;a class=&quot;anchor-link&quot; href=&quot;#Loading-the-datasets&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Each sample in the train and test set has the following information:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The text of a tweet&lt;/li&gt;
&lt;li&gt;A keyword from that tweet (although this may be blank!)&lt;/li&gt;
&lt;li&gt;The location the tweet was sent from (may also be blank)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;You are predicting whether a given tweet is about a real disaster or not. If so, predict a 1. If not, predict a 0.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;This notebook does not cover how to implement the best preprocessor to clean our tweets&lt;/strong&gt;. So we are going to feed our model with the tweet as is or only removing no alphanumeric characters. For a better results, we should inspect the tweets and apply some cleaning removing useless words, mispelling words, maybe the URIs,...&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Read the tweets of our train dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_filename&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id&lt;/th&gt;
      &lt;th&gt;keyword&lt;/th&gt;
      &lt;th&gt;location&lt;/th&gt;
      &lt;th&gt;text&lt;/th&gt;
      &lt;th&gt;target&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;our deeds are the reason of this earthquake ma...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;forest fire near la ronge sask . canada&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;all residents asked to 'shelter in place ' are...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;6&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;13,000 people receive wildfires evacuation ord...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;7&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;just got sent this photo from ruby alaska as s...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Extract only the text and target columns from our dataframe&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEXT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;text&lt;/th&gt;
      &lt;th&gt;target&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;our deeds are the reason of this earthquake ma...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;forest fire near la ronge sask . canada&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;all residents asked to 'shelter in place ' are...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;13,000 people receive wildfires evacuation ord...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;just got sent this photo from ruby alaska as s...&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Splitting-the-dataset-into-train-and-test-set&quot;&gt;Splitting the dataset into train and test set&lt;a class=&quot;anchor-link&quot; href=&quot;#Splitting-the-dataset-into-train-and-test-set&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;We split the train dataset into a train and validation dataset so we can evaluate the result and apply tricks like cross-validation. This job is done as in many others notebooks, using sklearn.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEXT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Show the size of our datasets&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;X Train Size:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;X Test Size:&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;X Train Size: (6090,)
X Test Size: (1523,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tokenization:-the-building-blocks-in-NLP&quot;&gt;Tokenization: the building blocks in NLP&lt;a class=&quot;anchor-link&quot; href=&quot;#Tokenization:-the-building-blocks-in-NLP&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Tokenization is a common task in Natural Language Processing. It’s a fundamental step in both traditional methods like Count Vectorizer and in deep Learning-based architectures like RNN or Transformers.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Given a character sequence and a defined document unit, tokenization is the task of chopping it up into pieces, called tokens , perhaps at the same time throwing away certain characters, such as punctuation. Here is an example of tokenization:&lt;/em&gt;[1]&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Input:Friends, Romans, Countrymen, lend me your ears;&amp;gt; &amp;gt;  Output:&quot;Friends&quot;, &quot;Romans&quot;, &quot;Countrymen&quot;, &quot;lend&quot;, &quot;me&quot;, &quot;your&quot;
These tokens are often loosely referred to as terms or words, but it is sometimes important to make a type/token distinction. A token is an instance of a sequence of characters in some particular document that are grouped together as a useful semantic unit for processing. A type is the class of all tokens containing the same character sequence. A term is a (perhaps normalized) type that is included in the IR system's dictionary. The set of index terms could be entirely distinct from the tokens.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Tokens can be either words, characters, or subwords. Hence, tokenization can be broadly classified into 3 types – word, character, and subword (n-gram characters) tokenization. The most common way of forming tokens is based on space. Assuming space as a delimiter, the tokenization of the sentence &quot;Here it comes&quot; results in 3 tokens &quot;Here&quot;, &quot;it&quot; and &quot;comes&quot;. As each token is a word, it becomes an example of Word tokenization.&lt;/p&gt;
&lt;p&gt;Tokenization is the foremost step while modeling text data. Tokenization is performed on the corpus to obtain tokens. The following tokens are then used to prepare a vocabulary. Vocabulary refers to the set of unique tokens in the corpus. Remember that vocabulary can be constructed by considering each unique token in the corpus or by considering the top K Frequently Occurring Words.&lt;/p&gt;
&lt;p&gt;One of the major issues with word tokenization is dealing with &lt;strong&gt;Out Of Vocabulary (OOV) words&lt;/strong&gt;. OOV words refer to the new words which are encountered at testing. These new words do not exist in the vocabulary.During test time, any word that is not present in the vocabulary will be mapped to a UNK token. This is how we can tackle the problem of OOV in word tokenizers. One problem with this approach is that the entire information of the word is lost as we are mapping OOV to UNK tokens. The structure of the word might be helpful in representing the word accurately. And another issue is that every OOV word gets the same representation.&lt;/p&gt;
&lt;p&gt;Another issue with word tokens is connected to the size of the vocabulary, pre-trained models are trained on a large volume of the text corpus so the vocabulary size explodes to thousands or hundred of thousands words.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Character Tokenization&lt;/strong&gt; splits a piece of text into a set of characters. Character Tokenizers handles OOV words coherently by preserving the information of the word. It breaks down the OOV word into characters and represents the word in terms of these characters. It also limits the size of the vocabulary. Want to talk a guess on the size of the vocabulary? 26 since the vocabulary contains a unique set of characters. Some especial character are usually include but the vocabulary size do not exceed one or two hundred words.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;In our example, the tokenization process is done inside the function used to process the text. The library sklearn and their modules will tokenize the text and then apply a technique to transform those tokens into a numerical representation.&lt;/em&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Creating-features-or-numericalizing-the-text:-Term-Document-Matrix&quot;&gt;Creating features or numericalizing the text: Term-Document Matrix&lt;a class=&quot;anchor-link&quot; href=&quot;#Creating-features-or-numericalizing-the-text:-Term-Document-Matrix&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;A document-term matrix or term-document matrix is a mathematical matrix that describes the frequency of terms that occur in a collection of documents. In a document-term matrix, rows correspond to documents in the collection and columns correspond to terms. There are various schemes for determining the value that each entry in the matrix should take. One such scheme is tf-idf. They are useful in the field of natural language processing.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;We can consider a &lt;strong&gt;Document Term Matrix (DTM)&lt;/strong&gt; as an implementation of the Bag of Words concept. Term Document Matrix is tracking the term frequency for each term by each document. You start with the Bag of Words representation of the documents and then for each document, you track the number of time a term exists. Term count is a common metric to  use in a Document Term Matrix  but it is not the only metric. It should be very easy to see that the DTM representation contains each distinct term from the corpus ( a collection of documents)  and the count of each distinct term in each document. A Document Term matrix can become a very large, sparse matrix (so much 0s than values) depending on the number of documents in the corpus and the number of terms in each document. We can now calculate basic statistics such as average term count, mean, median, mode, variance and standard deviation of the length of the documents. We can also tell which terms are more frequent in the collection of documents and can use that information to determine which terms more likely “represent” the document.&lt;/p&gt;
&lt;p&gt;Considering that our data is a collections of tweets (documents) in text format the process will need to tokenize the text to get a set of tokens (items in our vocabulary), in this stage we usually reduce the number of terms o tokens, removing those that seems to be not relevant. If our vocab contains too many words, many of them not relevant, we will spend many resources and our DTM could be useless to the process.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Count-Vectorizer&quot;&gt;Count Vectorizer&lt;a class=&quot;anchor-link&quot; href=&quot;#Count-Vectorizer&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Now it is time to convert a collection of text documents (our tweets) to a matrix of token/word counts. if you do not provide an a-priori dictionary and you do not use an analyzer that does some kind of feature selection then the number of features will be equal to the vocabulary size found by analyzing the data.&lt;/p&gt;
&lt;p&gt;We simply count the times that the term appears in the document and it will be the value of their corresponding cell.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create a Counter of tokens&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;count_vectorizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CountVectorizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode_error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lowercase&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Apply it on the train data to get the vocabulary and the mapping. This vocab and mapping is then applied to the test set.&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Before, we convert to Unicode to avoid issues with CountVectorizer&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count_vectorizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;count_vectorizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Train size: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Test size: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Train size:  (6090, 5619)
Test size:  (1523, 5619)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Our term-document matrix is a 6090 x 12063 matrix (this value can vary depending on text reprocessing applied), 6090 documents or tweets and a dictionary of size 12063.&lt;/p&gt;
&lt;p&gt;Lets plot some item in the vocabulary. We need the vocaulary to translate from the integer value of a word to the corresponding word, it is created in the function or process to write the term document matrix and we can use it to &quot;reverse&quot; the data from numbers to text.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered celltag_outputPrepend&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Extract the vocabulary as a list of (word, frequency)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;count_vectorizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulary_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[(&amp;#39;ted&amp;#39;, 4903), (&amp;#39;cruz&amp;#39;, 1324), (&amp;#39;fires&amp;#39;, 2003), (&amp;#39;back&amp;#39;, 538), (&amp;#39;at&amp;#39;, 479), (&amp;#39;jeb&amp;#39;, 2710), (&amp;#39;bush&amp;#39;, 863), (&amp;#39;lose&amp;#39;, 3012), (&amp;#39;because&amp;#39;, 611), (&amp;#39;of&amp;#39;, 3511)]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;TF-IDF&quot;&gt;TF-IDF&lt;a class=&quot;anchor-link&quot; href=&quot;#TF-IDF&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another technique to create the DTM is the &lt;strong&gt;TF-IDF&lt;/strong&gt;. In information retrieval, tf–idf or TFIDF, short for &lt;em&gt;term frequency–inverse document frequency&lt;/em&gt;, is a numerical statistic that is intended to reflect how important a word is to a document in a collection or corpus. It is often used as a weighting factor in searches of information retrieval, text mining, and user modeling. The tf–idf value increases proportionally to the number of times a word appears in the document and is offset by the number of documents in the corpus that contain the word, which helps to adjust for the fact that some words appear more frequently in general. tf–idf is one of the most popular term-weighting schemes today.&lt;/p&gt;
&lt;p&gt;TF-IDF is the product of two statistics, &lt;strong&gt;term frequency&lt;/strong&gt; and &lt;strong&gt;inverse document frequency&lt;/strong&gt;. There are various ways for determining the exact values of both statistics, for example:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The term frequency of a word in a document. There are several ways of calculating this frequency, with the simplest being a raw count of instances a word appears in a document. Then, there are ways to adjust the frequency, by length of a document, or by the raw frequency of the most frequent word in a document.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The inverse document frequency of the word across a set of documents. This means, how common or rare a word is in the entire document set. The closer it is to 0, the more common a word is. This metric can be calculated by taking the total number of documents, dividing it by the number of documents that contain a word, and calculating the logarithm.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
$$TF-IDF = tf_{i,j} x log(\frac{N}{df_i})$$
&lt;/p&gt;
&lt;p&gt;where $N$ = total number of documents, $tf_{i,j}$ = number of ocurrences of i in j, $df_i$ = number of documents containing i&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# try multiple ways of calculating features&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Create the numericalizer TFIDF for lowercase&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tfidf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TfidfVectorizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;decode_error&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lowercase&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;min_df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Numericalize the train dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tfidf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Numericalize the test dataset&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tfidf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;U&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Train size: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Test size: &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Train size:  (6090, 5619)
Test size:  (1523, 5619)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Create-and-train-the-models&quot;&gt;Create and train the models&lt;a class=&quot;anchor-link&quot; href=&quot;#Create-and-train-the-models&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Once you’ve transformed words into numbers, in a way that’s machine learning algorithms can understand, the TF-IDF score (or other vectorizer method) can be fed to classification algorithms such as Naive Bayes and Support Vector Machines, greatly improving the results of more basic methods like word counts.&lt;/p&gt;
&lt;h3 id=&quot;Naive-Bayes&quot;&gt;Naive Bayes&lt;a class=&quot;anchor-link&quot; href=&quot;#Naive-Bayes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;We are going to use a traditional classifier used frequently in text classification: Naive Bayes using multinomial models. 
The multinomial Naive Bayes classifier is suitable for classification with discrete features (e.g., word counts for text classification). The multinomial distribution normally requires integer feature counts. However, in practice, fractional counts such as tf-idf may also work.&lt;/p&gt;
&lt;p&gt;In other notebook we will talk about Naive Bayes and Bayes rule, describing why they produce great resuls in NLP task.&lt;/p&gt;
&lt;p&gt;Just for comparison purposes, we will build others classifier for binary classfication to check if our model performance is good enough for this task, as an initial soluction to improve.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# create the model, train it on the train dataset and print the scores&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;MultinomialNB&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;test score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;train score: 0.8596059113300493
test score: 0.7944845699277742
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Evaluate the Naive Bayes classifier, but first we create some helper functions to plot the results&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Create the confussion matrix&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Plot the confussion matrix for the target labels and predictions &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# Create a dataframe with the confussion matrix values&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;df_cm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
                  &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#plt.figure(figsize = (10,7))&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Plot the confussion matrix&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;font_scale&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#for label size&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;heatmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df_cm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;annot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fmt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;.0f&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;annot_kws&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;size&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# font size&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# ROC Curve&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# plot no skill&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Calculate the points in the ROC curve&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Plot the ROC curve for the target labels and predictions&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;fpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thresholds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos_label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;roc_auc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Receiver Operating Characteristic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;AUC = &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%0.2f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;roc_auc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;lower right&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;r--&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;True Positive Rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;False Positive Rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Predicting the Test set results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;              precision    recall  f1-score   support

           0    0.77897   0.90293   0.83638       886
           1    0.82661   0.64364   0.72374       637

    accuracy                        0.79448      1523
   macro avg    0.80279   0.77329   0.78006      1523
weighted avg    0.79890   0.79448   0.78927      1523

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Suport-Vector-Machine-Classifier&quot;&gt;Suport Vector Machine Classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#Suport-Vector-Machine-Classifier&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;What-is-Support-Vector-Machines?&quot;&gt;What is Support Vector Machines?&lt;a class=&quot;anchor-link&quot; href=&quot;#What-is-Support-Vector-Machines?&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;em&gt;The objective of the support vector machine algorithm is to find a hyperplane in an N-dimensional space(N — the number of features) that distinctly classifies the data points.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;In a binary classification problem, to separate the two classes of data points, there are many possible hyperplanes that could be chosen. Our objective is to find a plane that has the maximum margin, i.e the maximum distance between data points of both classes. Maximizing the margin distance provides some reinforcement so that future data points can be classified with more confidence. Support vectors are data points that are closer to the hyperplane and influence the position and orientation of the hyperplane. Using these support vectors, we maximize the margin of the classifier.&lt;/p&gt;
&lt;p&gt;We can use SVM algorithm to predict if a tweet is fake or real, it is just a binary classifcation problem.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.svm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Define the parameters to tune&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; 
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;C&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;gamma&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;scale&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# Tune yyperparameters  using Grid Search and a SVM model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;rbf&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_jobs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Once our model is trained we can evaluate the performance as we did previously:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Predicting the Test set results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;              precision    recall  f1-score   support

           0    0.79492   0.91874   0.85236       886
           1    0.85571   0.67033   0.75176       637

    accuracy                        0.81484      1523
   macro avg    0.82532   0.79453   0.80206      1523
weighted avg    0.82035   0.81484   0.81028      1523

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAXAAAAD/CAYAAADoiI2GAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAd10lEQVR4nO3dfVhUdd4/8DdP4wjD2PoDBgs0lMC4L0PDB7pvCbMVTWwTK/KBfKKVkqflIXOt0Ey7dVcaFyHDBRKNWK02rVj31527/aL73iTsZ5bgw2qQa+NM9LAjMnKYh/sP18kJdECFw5fzfl3XXJfzPd8z34//fPz4Od9zjofD4XCAiIiE4yl3AEREdG2YwImIBMUETkQkKCZwIiJBMYETEQmKCZyISFDeci7e0XJKzuWpHxp8c5zcIVA/ZZXOXNf5Pck3PgEjr2utviJrAici6jN2m9wR3HBM4ESkDA673BHccEzgRKQMdiZwIiIhOViBExEJymaVO4IbjgmciJSBFzGJiATFFgoRkaB4EZOISEy8iElEJCpW4EREgrJ1yB3BDccETkTKwBYKEZGgeqGFcuDAASxcuLDLYyEhIdi/fz9yc3NRU1Pjckyn0+HDDz/8V1h2FBcX4/XXX4fZbEZMTAxWr16NESNGuF2fCZyIlKEXKvBx48bho48+chk7fvw4li1bhrS0NADAsWPHkJWVheTkZOccLy8v559LSkpQXV2NDRs2QKfTobCwEKmpqaipqcGgQYOuuj4TOBEpQy9U4CqVCoGBgc7vHR0deOGFFzBt2jQkJydDkiQ0NTVhzJgxLvMukSQJFRUVyM/PR3x8PABAr9dj8uTJ2LdvH2bPnn3V9flCByJSBIe9o9ufa7Vz504YDAb8+te/BgCcPHkSVqsV4eHhXc5vbGxEW1sbYmNjnWMajQZRUVGor693ux4rcCJShl7eRmixWFBaWoqFCxdCp9MBuNg+8fb2RmlpKWpra+Hl5YX4+HhkZ2fD398fRqMRAJzzLwkKCoLBYHC7JhM4ESlDD3rgZrMZZrO507hWq4VWq+3ynL1796K9vd3louaJEycAXLyg+fLLL6O5uRkbN27E0aNHsWPHDlgsFgAXWzGXU6lUkCTJbZxM4ESkDD14mFVlZSWKi4s7jWdkZCAzM7PLc/bu3Ytp06Zh6NChzrG8vDykpaU5k35ERAQCAgIwd+5cHDp0CGq1GsDFXvjlSVySJPj6+rqNkwmciJShBxX4okWLkJSU1Gn8StX3d999h0OHDuHxxx93Gff09Ox0TmRkJADAYDAgNDQUAGAymaDRaJxzTCbTFfvml2MCJyJl6EEP/Gqtkq58+umn8PDwwIQJE1zG09PTYbfbsXXrVufY4cOHAQDh4eEICwuDRqNBXV0dRo68+CLl1tZWNDQ0YP78+W7XZQInImXoxRc6NDQ0IDQ0tFPbY+bMmcjNzcW2bdswY8YMnDp1CmvXrsX06dOdlXhKSgr0ej0CAgIQEhKCwsJC6HQ6JCQkuF2XCZyIlKEXd6F88803GDJkSKfxxMRE2O12lJWVoaSkBP7+/khMTEROTo5zTlZWFmw2GwoKCmCxWBATE4OysrJOFza74uFwOBw39G/SAx0tp+RamvqpwTfHyR0C9VNW6cx1nW/5cHu35w6+e/F1rdVXWIETkTLwcbJERILi0wiJiATFCpyISFC9uAtFLkzgRKQMbKEQEQmKLRQiIkExgRMRCYotFCIiQfEiJhGRoNhCISISFFsoRESCYgVORCQoJnAiIkHJ9+DVXsMETkTKYOUuFCIiMfEiJhGRoNgDJyISFHvgRESCYgVORCQoJnAiIjE5bDa5Q7jhmMCJSBlYgRMRCYrbCImIBGXnLhQiIjGxhULXqsNqxdPrCnHGYISXpyfWrMzGyBGhAICNvyvFrcND8EhSonO+3W7H8idX457JsS7jNDAtfDQZixY+DABQq9WIjo7Cf8T9Ar/TPw+bzYb2dgmLl2bDZGqROVKBKfEipiRJ+POf/4z6+noYDAa0t7fD19cXwcHBmDhxIhISEuDtzX8H3Kn92yew2WyoKn0R/1P3KYpKK1HwZAZWrStE01f/wJL5D7nML9q2A/80n5MpWuprO3buxo6duwEARb9bj1e2/wH6wueQnfMsPvvsCH75WApW5Kcjf8VzMkcqMKVV4F999RVSU1PR0tKCqKgoBAUFYejQoZAkCSdOnMDevXuxZcsW/P73v0dISEhfxSykEaG3wGq1wW634/z5Nnh7e6HNcgHLly5A7cf1LnPf+2stPD09MDl2vEzRklxi7rwD/xYVgazsp/FuzX/h7FkTAMDb2wsX2ttljk5wSuuBP/fccwgLC8Nbb70FjUbT6XhraytycnLw/PPPo7S0tNeCHAh8Bw/G12eNuH/+Mnz/wz9R8tvnEHJzMEJuDnZJ4CdONaHmvQ+gX/80tr7ymowRkxxWrszE8+v0AOBM3nfFjsfy5Utwz9Q5coYmPqXtQjl48CB2797dZfIGAI1Gg7y8PMyfP79XghtIdu56C/8+MQY5TyyBwfgNUrNW4q0dWzFokMpl3tv79sPU8i2WZq3E1wYjfHx8cMswHatxBRgyRIvIyHB88P/+xzn28MO/wK9XZuIXDyxES8t3MkY3ACitAtdqtTAajYiIiLjinDNnzsDX1/eGBzbQaP01zmsFQ7T+sFqtsHXRk8tLT3X+uaT8VQQM/RmTt0LExU3C/v21zu/z58/BssdScO/PH8b33/8gY2QDg0NpPfCHHnoIK1euRGZmJiZOnIjg4GCoVCpIkgSTyYS6ujq8+OKLSE5O7qt4hbXwkSQ8+596LHwiHx1WK7LTFsN3sFrusKgfiYwYhS+//AoA4Onpic0vrsVXp7/GG7t/DwD4sPZjPLe2UM4QxTYAd6F4OBxXfsaiw+FAcXExXnnlFVgslk7H/fz8sGDBAmRnZ8PT07PHi3e0nOrxOTSwDb45Tu4QqJ+ySmeu6/zzaxd0e65fQVWPfnvPnj3Ytm0bTp8+jeHDhyMjIwP33XcfAKCxsREvvPACPv/8c9x000149NFHkZr64/+07XY7iouL8frrr8NsNiMmJgarV6/GiBEj3K571Qrcw8MDmZmZSEtLw9GjR2E0GmGxWKBWqxEcHIzRo0dDpVJd7SeIiPqHXmqh7N27F6tWrcJTTz2FKVOm4E9/+hNyc3MRFBSEsLAwLF68GNOmTcOaNWtw+PBhrFmzBv7+/s7ORUlJCaqrq7FhwwbodDoUFhYiNTUVNTU1GDRo0FXXvmoF3ttYgdNPsQKnK7nuCrxgbrfn+q39Q7fmORwO3Hvvvfj5z3+OVatWOcdTU1Nx5513wsvLC6+++io++OAD5zWwzZs3491338X7778PSZIwadIk5OfnY8GCi/9DaG1txeTJk7FmzRrMnj37quv3vO9BRCQih737n246deoUzpw5g1mzZrmMl5eXIz09HfX19Rg/frzLzY6TJk3C6dOnYTQa0djYiLa2NsTGxjqPazQaREVFob7e9f6QrjCBE5Ey2B3d/3RTU1MTgIt3rC9btgx33XUXHn74YfzlL38BABiNRgQHB7ucExQUBAAwGAwwGo0AAJ1O12mOwWBwuz7vgSciRXBYu78LxWw2w2w2dxrXarXQarXO762trQCAFStWID09HTk5OXjvvfewfPlylJeX48KFC52uE1763t7e7twc0tUcSZLcxskETkTK0IPKurKyEsXFxZ3GMzIykJmZ6fzu4+MDAFiyZAkefPBBAMDtt9+OL774AhUVFVCr1Z0S8aXvvr6+UKvVzrHLk7gkSd26v4YJnIiUoQe97UWLFiEpKanT+OXVNwBne+SnNzvedttt2L9/P4YPHw6TyeRy7NL34OBgXNpDYjKZXO54N5lMCA8PdxsnEzgRKUMPKvCftkquJCoqCn5+fvj8888xadIk5/jx48cxfPhwTJgwAVVVVbBarc4LmR9//DFuvfVWBAYGYsiQIdBoNKirq8PIkSMBXGzLNDQ0dOsRJUzgRKQIjl54FoparcZjjz2Gl156CUFBQRg7dixqamrw0Ucf4ZVXXkFERATKysqwatUqLFu2DF988QW2b9+O1atXA7jY605JSYFer0dAQABCQkJQWFgInU6HhIQEt+szgRORMvTgImZPLF++HL6+vigqKsLZs2cxcuRIbNmyBXfddReAi1sK169fj6SkJAQGBiIvLw9z5vz4ZMmsrCzYbDYUFBTAYrEgJiYGZWVl3bpJkjfyUL/CG3noSq73Rp5zy+/r9lz/l/Zd11p9hRU4ESmD0h4nS0Q0UMjYbOg1TOBEpAyswImIBMUETkQkJodVYW/kISIaMAZe/mYCJyJl6I0beeTGBE5EysAETkQkKLZQiIjExBYKEZGgHFYmcCIiMbGFQkQkph68z0EYTOBEpAxM4EREYmIFTkQkKIdV7ghuPCZwIlIEVuBERIJiAiciEpXDQ+4IbjgmcCJSBFbgRESCcthZgRMRCcluYwInIhISWyhERIJiC4WISFCOgfcwQiZwIlIGVuBERILiRUwiIkGxAiciEpSDd2ISEYmJ2wiJiARlZwVORCSmgdhC8ZQ7ACKivmC3eXT7c62+/PJLjBs3Dq+//rpzLDc3F5GRkS6fu++++8e47HYUFRUhLi4O0dHRWLp0KZqbm7u1HitwIlKE3t6F0tHRgfz8fLS1tbmMHzt2DFlZWUhOTnaOeXl5Of9cUlKC6upqbNiwATqdDoWFhUhNTUVNTQ0GDRp01TVZgRORItgdHt3+XIstW7bAz8/PZUySJDQ1NWHMmDEIDAx0foYOHeo8XlFRgYyMDMTHx2P06NHQ6/VoaWnBvn373K7JBE5EiuBweHT701OffPIJdu3ahY0bN7qMnzx5ElarFeHh4V2e19jYiLa2NsTGxjrHNBoNoqKiUF9f73ZdtlCISBF661koZrMZK1aswDPPPINhw4a5HDt27Bi8vb1RWlqK2tpaeHl5IT4+HtnZ2fD394fRaAQA6HQ6l/OCgoJgMBjcrs0ETkSK0JPWiNlshtls7jSu1Wqh1WpdxtasWYOxY8fi/vvv7zT/xIkTAICQkBC8/PLLaG5uxsaNG3H06FHs2LEDFosFAKBSqVzOU6lUkCTJbZxM4ESkCPYeXMSsrKxEcXFxp/GMjAxkZmY6v+/Zswf19fV45513uvydvLw8pKWlOZN+REQEAgICMHfuXBw6dAhqtRrAxV745UlckiT4+vq6jVPWBD5rXLqcy1M/9Nehd8kdAg1QPanAFy1ahKSkpE7jP62+33zzTXz77beYMmWKy/jatWuxfft21NTUdDonMjISAGAwGBAaGgoAMJlM0Gg0zjkmk+mKffPLsQInIkXoycXJrlolXdm0aRMuXLjgMpaQkICMjAzMmjUL6enpsNvt2Lp1q/P44cOHAQDh4eEICwuDRqNBXV0dRo4cCQBobW1FQ0MD5s+f73Z9JnAiUoTeuJX+pxcfLxk6dChuueUWzJw5E7m5udi2bRtmzJiBU6dOYe3atZg+fbqzEk9JSYFer0dAQABCQkJQWFgInU6HhIQEt+szgRORIsjxQp7ExETY7XaUlZWhpKQE/v7+SExMRE5OjnNOVlYWbDYbCgoKYLFYEBMTg7Kysk4XNrvi4XDI96Kh6aH3ybU09VPPdPi5n0SKFHf2jes6/7+DH+r23P+4zrX6CitwIlKEAfg0WSZwIlIGBwbe0wiZwIlIEex8Kz0RkZjsrMCJiMTEFgoRkaBsTOBERGLiLhQiIkExgRMRCYo9cCIiQfXyKzFlwQRORIrAbYRERIKyyR1AL2ACJyJFsHuwAiciEtIAvJOeCZyIlIHbCImIBMVdKEREguKt9EREgmIFTkQkKPbAiYgExV0oRESCYguFiEhQbKEQEQnKxgqciEhMrMCJiATFBE5EJCjuQiEiEhR3oRARCYotFCIiQfGFDkREgmILhYhIUGyhEBEJaiDuQvGUOwAior5gh6Pbn54wGo3Izc3FpEmTMG7cOCxbtgwnTpxwHm9sbMSjjz6KsWPHYsqUKSgvL3eNy25HUVER4uLiEB0djaVLl6K5ublbazOBE5Ei2Hrw6S6Hw4Ff/vKXOHv2LMrLy/HGG29ArVZj8eLFOH/+PL777jssXrwYI0aMwJtvvons7GwUFRVh9+7dzt8oKSlBdXU11q1bh127dsHLywupqalob293uz5bKESkCL3RA29pacGoUaOQlZWFsLAwAMDy5cvxwAMP4Pjx4zhw4AB8fHywZs0aeHt7Y9SoUWhubsa2bduQnJwMSZJQUVGB/Px8xMfHAwD0ej0mT56Mffv2Yfbs2VddnxU4ESmC3aP7n+4KDAyEXq93Ju+WlhaUl5cjKCgIERERqK+vx/jx4+Ht/WOtPGnSJJw+fRpGoxGNjY1oa2tDbGys87hGo0FUVBTq6+vdrs8KnIgUoSe9bbPZDLPZ3Glcq9VCq9V2ec7KlSvx1ltvQaVSYevWrfDz84PRaER4eLjLvKCgIACAwWCAyWQCAOh0uk5zDAaD2ziZwIlIEXpyabKyshLFxcWdxjMyMpCZmdnlOampqViwYAFee+01pKeno6qqChcuXIBKpXKZd+l7e3s7LBaLy9jlcyRJchsnEzgRKUJPeuCLFi1CUlJSp/ErVd8AcNtttwEA1q9fj88++ww7d+6EWq3ulIgvfff19YVarXaOXZ7EJUmCr6+v2ziZwIlIEWw9qMGv1iq5nMlkwoEDBzBr1ix4eFxsnnt6eiI8PBxGoxHBwcHONsnl5wBAcHAwHA6Hc0yj0bjM+WnrpSu8iElEimDvwae7DAYD8vPzcfDgQedYR0cHGhoaMGrUKEyYMAEHDx6E1Wp1Hv/4449x6623IjAwEKNHj4ZGo0FdXZ3zeGtrKxoaGjBx4kS36zOBE5Ei9MaNPGPGjMGkSZNQUFCA+vp6HD9+HE899RR++OEHLF68GA8++CAsFgtWrVqFv//979izZw+2b9+OtLQ0ABd73SkpKdDr9Xj//fdx9OhR5OTkQKfTISEhwe36bKEQkSL0xq30np6e2LJlCzZt2oRf/epXOHfuHMaPH4+qqiqEhoYCAMrLy7F+/XokJSUhMDAQeXl5mDNnjvM3srKyYLPZUFBQAIvFgpiYGJSVlXW6sNkVD8elJowMpofeJ9fS1E890+EndwjUT8WdfeO6zs++dW635/6u6Q/XtVZfYQVORIrQk4uYomACJyJF6OlDqkTABN5HvLy9kLspB8GhOviofPBaUTU+/q8DAIC01cvwj5P/QM2rfwIA3DdvBmam3Aeb1Y7qomoc2F93tZ8mwfkEaDHu//4Gnz+yFp6DVBi1PhUOux2O9g4cy9wCle5nGPn8Eud87Z23oWHJb/D9Xw/JGLV4Bl76ZgLvM/fOmYpz35/Db3+1Cf43+eOlPxej8eBRPLk5D7eMDMEbJy/2934W+DM8sPQXyEzMhs8gH7z4x034tPb/o0PqkPlvQL3Bw9sL4b9Jg+3CxZs7Rq1bgpNPl+P8kSYEPzoNIRmz8eWaSnw+ZzUAIOD+uyCd/Y7J+xoMxAqc2wj7yIfv1qJy0w7nd5vVBrWfGjtfrML+N/c7xyPHRqDhkwZ0SB1oO9eGr5sMCLs9TI6QqQ+ErV4Iw473IBm/BwA0pulx/kgTgIvJ3d7+4z/cnr6DMOLJZJx8pkKOUIXXG/vA5ea2Ap8/f77zDiN3qqqqrjuggepC2wUAwGC/wXi29GlUbtoB42kjjKeNmHDPeOc8X40vzp9rc363tLbBz9/9LbUknqBHpqDjWzN++OAzhGZd3FbWYfoBAOA/PhI3L5mBw0kFzvnB8+7FN+/8DdbvzskSr+gcA7ACd5vA4+PjsXnzZowcORJ33HFHX8Q0YAUOC0BB2bN4Z0cN/rrngy7ntLW2YbBmsPP7YI0vWs3n+yhC6kvBc6cCcOCmu++A5t9uReSWTBxZuBFD/j0Kw7MfxJGUF9Dx7Y9PxAt8MA6Nj22SL2DBKXIXSlpaGjQaDQoLC1FaWoqQkJC+iGvAuSngJrxQtR4lz27Fof++cv/y2KHjWLxiEXwG+cBH5YPh4aFoOtbUd4FSn7m8uh7zx+fw9xWluOnuMRj2aAIOz1kN6w+tzuNe/r7wVHlD+vpbOUIdEERqjXRXty5iLliwALW1tdi8eTM2bWIFcC3mZjwCzRAN5mfPw/zseQCAZxY+C+mC65PKvv/me+yteBuFb26Cp4cHtv+mEh3tvICpBB5enhi1binaz7Tg9oonAQD//NsRfPXb3Rg8ahgunP5G5gjFZpfvnsVe0+07MU0mE44cOYJ77rnnhi3OOzHpp3gnJl3J9d6JmTJijvtJ//Jq8x+va62+0u1thEFBQc43SRARiWYgbiPkPnAiUgRF7kIhIhoIrEzgRERiYgVORCQoxW4jJCISnYyvPug1TOBEpAjchUJEJChF3kpPRDQQsAInIhIUe+BERILiLhQiIkFxHzgRkaDYAyciEpTNMfCaKEzgRKQIbKEQEQlqIL7QgQmciBRh4KVvJnAiUghexCQiEhQTOBGRoLgLhYhIUNyFQkQkqIH4LBRPuQMgIuoLdji6/blWpaWlmDdvnstYbm4uIiMjXT533333j3HZ7SgqKkJcXByio6OxdOlSNDc3d2s9VuBEpAi9XYFXVVVBr9dj3LhxLuPHjh1DVlYWkpOTnWNeXl7OP5eUlKC6uhobNmyATqdDYWEhUlNTUVNTg0GDBl11TSZwIlIEWy89j9BoNGL16tU4cOAAwsLCXI5JkoSmpiaMGTMGgYGBnc6VJAkVFRXIz89HfHw8AECv12Py5MnYt28fZs+efdW12UIhIkWwOxzd/vTEkSNH4Ofnh7fffhvR0dEux06ePAmr1Yrw8PAuz21sbERbWxtiY2OdYxqNBlFRUaivr3e7NitwIlKEnuxCMZvNMJvNnca1Wi20Wq3L2NSpUzF16tQuf+fYsWPw9vZGaWkpamtr4eXlhfj4eGRnZ8Pf3x9GoxEAoNPpXM4LCgqCwWBwGycTOBEpQk8q68rKShQXF3caz8jIQGZmZrd/58SJEwCAkJAQvPzyy2hubsbGjRtx9OhR7NixAxaLBQCgUqlczlOpVJAkye3vM4ETkSL0pAJftGgRkpKSOo3/tPp2Jy8vD2lpac7zIiIiEBAQgLlz5+LQoUNQq9UALvbCL0/ikiTB19fX7e8zgRORIvSkAu+qVXItPD09O/1OZGQkAMBgMCA0NBQAYDKZoNFonHNMJtMV++Yuv3/dERIRCcDmsHf7c6Okp6fjiSeecBk7fPgwACA8PByjR4+GRqNBXV2d83hraysaGhowceJEt7/PCpyIFEGOW+lnzpyJ3NxcbNu2DTNmzMCpU6ewdu1aTJ8+3VmJp6SkQK/XIyAgACEhISgsLIROp0NCQoLb32cCJyJFcMjwMKvExETY7XaUlZWhpKQE/v7+SExMRE5OjnNOVlYWbDYbCgoKYLFYEBMTg7Kysk4XNrvi4ZDxAQHTQ++Ta2nqp57p8JM7BOqn4s6+cV3nj/g/d3R7bvO3h69rrb7CCpyIFGEgPsyKCZyIFIEvdCAiEpTNzhc6EBEJiS90ICISFHvgRESCYg+ciEhQrMCJiATFi5hERIJiC4WISFBsoRARCaqnr0oTARM4ESkC94ETEQmKFTgRkaDsMjxOtrcxgRORIvAiJhGRoAZiApf1hQ5ERHTt+FJjIiJBMYETEQmKCZyISFBM4EREgmICJyISFBM4EZGgmMCJiATFBE5EJCgmcCIiQTGBy8hut6OoqAhxcXGIjo7G0qVL0dzcLHdY1I+UlpZi3rx5codB/RQTuIxKSkpQXV2NdevWYdeuXfDy8kJqaira29vlDo36gaqqKuj1ernDoH6MCVwmkiShoqICGRkZiI+Px+jRo6HX69HS0oJ9+/bJHR7JyGg04vHHH8emTZsQFhYmdzjUjzGBy6SxsRFtbW2IjY11jmk0GkRFRaG+vl7GyEhuR44cgZ+fH95++21ER0fLHQ71Y3ycrEyMRiMAQKfTuYwHBQXBYDDIERL1E1OnTsXUqVPlDoMEwApcJhaLBQCgUqlcxlUqFSRJkiMkIhIME7hM1Go1AHRK1pIkwdfXV46QiEgwTOAyGTZsGADAZDK5jJtMpk5tFSKirjCBy2T06NHQaDSoq6tzjrW2tqKhoQETJ06UMTIiEgUvYspEpVIhJSUFer0eAQEBCAkJQWFhIXQ6HRISEuQOj4gEwAQuo6ysLNhsNhQUFMBisSAmJgZlZWWdLmwSEXWFLzUmIhIUe+BERIJiAiciEhQTOBGRoJjAiYgExQRORCQoJnAiIkExgRMRCYoJnIhIUEzgRESC+l/laOzcot68wQAAAABJRU5ErkJggg==
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZkAAAEkCAYAAAD98UxlAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAgAElEQVR4nOzdd1iTV/sH8G8SCAESEvYKggiBigLKEkcpojiqdda996pa0ar9va6+tupbVxVnW0eVYqtYq6KtrVZbq6hUrVptKw4IM2wII/P8/ohEI6BBgQQ4n+vyuiR5kufmIcmd5zz3uQ+DEEJAURRFUQ2AaegAKIqiqOaLJhmKoiiqwdAkQ1EURTUYmmQoiqKoBkOTDEVRFNVgaJKhqEZAizgbhqGPq6H33xTQJGNElixZAh8fn2r/OnTogLfffhuxsbFQqVQGiW3r1q3w8fGBUqk0yP6rPHjwAEuXLkVkZCTatWuHN998E7Nnz8bly5cNGteLnD17FgsXLtT+fPToUfj4+CA1NbXRYpDL5di/fz/effddhISEIDg4GEOHDsXhw4d1/qZXrlyBj48PLl261GixvarDhw/jk08+qZfnquvrWy6XY+3atTh27Jj2trFjx2LkyJH1Ek9zYmLoAChdNjY22Lp1q85tRUVFOHXqFLZu3QqZTIaYmJhGj2vIkCEIDw+HiYnhXjKJiYlYsmQJ2rRpgxkzZqBVq1bIy8vDiRMnMGHCBEyePBkffPCBweKrzb59+3Q+vCIiIhAXFwcnJ6dG2X9BQQGmTJkCsViMUaNGYebMmQCA3377DStWrMDFixexceNGsFisRomnvuzYsQMdO3asl+eq6+tbIpFg7969WL16tfa2//znP/USS3NDk4yRMTU1RXBwcLXbe/TogYyMDBw5csQgScbFxQUuLi6Nvt8qf//9NxYvXoy+ffvik08+0fkw6N+/P3bv3o0NGzbA09MTQ4cONVic+rC1tYWtrW2j7W/p0qXIyMjAoUOH0KZNG+3t3bt3h5eXFz766CN069bN6I9bQ6qP17ePj089RdO80OGyJoTL5Va77fr16xg7diwCAwMREhKCmJgY5OTk6GyTl5eHpUuXonPnzujQoQNGjBiBpKQknW0SEhLQv39/7RDUhg0bIJfLtfc/O5ywa9cu+Pn5oaCgQOc5jh07Bh8fHzx+/BgAkJ2djZiYGISFhSEgIABjxozBzZs3dR7j4+OD7du3Y/jw4fD398e6detq/N137twJc3NzrFixosZvm1OnToW/vz+2b9+uHScfO3YsFi5ciN27d6NLly7o2LEjZsyYAbFYrPPY14nz2rVrmDx5MkJCQtCuXTt0794dW7Zs0Q5rdu/eHVevXsX169fh4+OD9PT0asNlS5YswYQJE3D8+HH06dMH7dq1Q+/evXH8+HGdGB48eICpU6eiY8eO6NKlCz777DMsXboUY8eOrfGYAcA///yD8+fPY8qUKToJpsqIESMwevRoWFtb69yempqK6dOnIzAwEGFhYVixYgUqKiq091dWVmLDhg2Ijo5Gu3bt0LFjR0ycOBF3797VbrN161b07NkTu3fvRlhYGDp37ozs7Gy9HgsAt2/fxpQpUxAUFISwsDC899572r+dj48PMjIycOLECZ0P95SUFMyYMQMdO3ZEhw4dMH36dDx8+FB7f3p6Onx8fPDVV1+hf//+CAgIwFdffVVtuEwsFmPOnDno1KkT/P39MWjQIJw8eRKAZkgxKioKgObsper4Pz9cplAoEBsbi549e8Lf3x+9e/fG119/XevfqtkilNFYvHgx6datG1EoFNp/MpmMZGVlkV27dhEfHx+ydu1a7fbJycnEz8+PjBkzhpw5c4YcPXqUREZGkh49epDS0lJCCCHl5eWkZ8+epEuXLuTrr78mFy5cINOnTyft2rUjd+/eJYQQ8vnnnxORSESWLVtGzp8/T3bv3k38/f3J3LlztfvasmULEYlERKFQkMzMTOLr60vi4uJ04p80aRIZNmwYIYSQgoICEhERQSIjI8mRI0fImTNnyLhx40j79u3J7du3tY8RiUTEz8+PbNmyhZw9e1bnvioqlYoEBQWR995774XHb+/evUQkEpG//vqLEELImDFjSEhICOnevTs5fvw4+e6778ibb75JIiIiiFQqfe047927R9q2bUvee+89cv78efLLL7+QBQsWEJFIRI4dO0YIIeTWrVtkwIABpF+/fuTatWtEJpORhIQEIhKJyOPHj7V/9+DgYNKjRw+SkJBAzp8/T0aPHk18fHzIw4cPCSGE5Ofnk06dOpHevXuTkydPkuPHj5OePXuS9u3bkzFjxtR6THbt2kVEIhFJSUl54bGrkpSUREQiEWnXrh3ZuHEjuXjx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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This simple SVM increase the performance of our model.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;XGBoost-classifier&quot;&gt;XGBoost classifier&lt;a class=&quot;anchor-link&quot; href=&quot;#XGBoost-classifier&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;XGBoost is an implementation of gradient boosted decision trees designed for speed and performance that is dominative competitive machine learning. This is a good dataset for a first XGBoost model because all of the input variables are numeric and the problem is a simple binary classification problem.&lt;/p&gt;
&lt;p&gt;XGBoost is an advanced version of gradient boosting, rather than training all of the models in isolation of one another, boosting trains models in succession, with each new model being trained to correct the errors made by the previous ones. Models are added sequentially until no further improvements can be made.&lt;/p&gt;
&lt;p&gt;XGBoost provides a wrapper class to allow models to be treated like classifiers or regressors in the scikit-learn framework. This means we can use the full scikit-learn library with XGBoost models.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;lightgbm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LGBMClassifier&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;f1_metric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ytrue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;#39;&amp;#39;&amp;#39; Return the F1 Score value for the preds and true values, ytrue &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;f1_score&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preds&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;int&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ytrue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;macro&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;learning_rate&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.06&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;n_estimators&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1500&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;colsample_bytree&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;metric&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;f1_score&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;LGBMClassifier&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Fit or train the xgboost model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eval_set&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)],&lt;/span&gt;
             &lt;span class=&quot;n&quot;&gt;verbose&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;400&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;eval_metric&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;f1_metric&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Show the results&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;train score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;test score:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;C:\Users\edumu\Anaconda3\lib\site-packages\sklearn\metrics\classification.py:1439: UndefinedMetricWarning: F-score is ill-defined and being set to 0.0 in labels with no true samples.
  &amp;#39;recall&amp;#39;, &amp;#39;true&amp;#39;, average, warn_for)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[400]	valid_0&amp;#39;s f1_score: 0.919876	valid_1&amp;#39;s f1_score: 0.770098
[800]	valid_0&amp;#39;s f1_score: 0.956615	valid_1&amp;#39;s f1_score: 0.764821
[1200]	valid_0&amp;#39;s f1_score: 0.970297	valid_1&amp;#39;s f1_score: 0.75265
train score: 0.9765188834154351
test score: 0.7616546290216678
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now, we can predict on the test dataset to get the results and compare with others methods.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Predicting the Test set results&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;full_clf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;digits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_confussion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plot_roc_curve&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;              precision    recall  f1-score   support

           0    0.79492   0.91874   0.85236       886
           1    0.85571   0.67033   0.75176       637

    accuracy                        0.81484      1523
   macro avg    0.82532   0.79453   0.80206      1523
weighted avg    0.82035   0.81484   0.81028      1523

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZkAAAEkCAYAAAD98UxlAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAgAElEQVR4nOzdd1iTV/sH8G8SCAESEvYKggiBigLKEkcpojiqdda996pa0ar9va6+tupbVxVnW0eVYqtYq6KtrVZbq6hUrVptKw4IM2wII/P8/ohEI6BBgQQ4n+vyuiR5kufmIcmd5zz3uQ+DEEJAURRFUQ2AaegAKIqiqOaLJhmKoiiqwdAkQ1EURTUYmmQoiqKoBkOTDEVRFNVgaJKhqEZAizgbhqGPq6H33xTQJGNElixZAh8fn2r/OnTogLfffhuxsbFQqVQGiW3r1q3w8fGBUqk0yP6rPHjwAEuXLkVkZCTatWuHN998E7Nnz8bly5cNGteLnD17FgsXLtT+fPToUfj4+CA1NbXRYpDL5di/fz/effddhISEIDg4GEOHDsXhw4d1/qZXrlyBj48PLl261GixvarDhw/jk08+qZfnquvrWy6XY+3atTh27Jj2trFjx2LkyJH1Ek9zYmLoAChdNjY22Lp1q85tRUVFOHXqFLZu3QqZTIaYmJhGj2vIkCEIDw+HiYnhXjKJiYlYsmQJ2rRpgxkzZqBVq1bIy8vDiRMnMGHCBEyePBkffPCBweKrzb59+3Q+vCIiIhAXFwcnJ6dG2X9BQQGmTJkCsViMUaNGYebMmQCA3377DStWrMDFixexceNGsFisRomnvuzYsQMdO3asl+eq6+tbIpFg7969WL16tfa2//znP/USS3NDk4yRMTU1RXBwcLXbe/TogYyMDBw5csQgScbFxQUuLi6Nvt8qf//9NxYvXoy+ffvik08+0fkw6N+/P3bv3o0NGzbA09MTQ4cONVic+rC1tYWtrW2j7W/p0qXIyMjAoUOH0KZNG+3t3bt3h5eXFz766CN069bN6I9bQ6qP17ePj089RdO80OGyJoTL5Va77fr16xg7diwCAwMREhKCmJgY5OTk6GyTl5eHpUuXonPnzujQoQNGjBiBpKQknW0SEhLQv39/7RDUhg0bIJfLtfc/O5ywa9cu+Pn5oaCgQOc5jh07Bh8fHzx+/BgAkJ2djZiYGISFhSEgIABjxozBzZs3dR7j4+OD7du3Y/jw4fD398e6detq/N137twJc3NzrFixosZvm1OnToW/vz+2b9+uHScfO3YsFi5ciN27d6NLly7o2LEjZsyYAbFYrPPY14nz2rVrmDx5MkJCQtCuXTt0794dW7Zs0Q5rdu/eHVevXsX169fh4+OD9PT0asNlS5YswYQJE3D8+HH06dMH7dq1Q+/evXH8+HGdGB48eICpU6eiY8eO6NKlCz777DMsXboUY8eOrfGYAcA///yD8+fPY8qUKToJpsqIESMwevRoWFtb69yempqK6dOnIzAwEGFhYVixYgUqKiq091dWVmLDhg2Ijo5Gu3bt0LFjR0ycOBF3797VbrN161b07NkTu3fvRlhYGDp37ozs7Gy9HgsAt2/fxpQpUxAUFISwsDC899572r+dj48PMjIycOLECZ0P95SUFMyYMQMdO3ZEhw4dMH36dDx8+FB7f3p6Onx8fPDVV1+hf//+CAgIwFdffVVtuEwsFmPOnDno1KkT/P39MWjQIJw8eRKAZkgxKioKgObsper4Pz9cplAoEBsbi549e8Lf3x+9e/fG119/XevfqtkilNFYvHgx6datG1EoFNp/MpmMZGVlkV27dhEfHx+ydu1a7fbJycnEz8+PjBkzhpw5c4YcPXqUREZGkh49epDS0lJCCCHl5eWkZ8+epEuXLuTrr78mFy5cINOnTyft2rUjd+/eJYQQ8vnnnxORSESWLVtGzp8/T3bv3k38/f3J3LlztfvasmULEYlERKFQkMzMTOLr60vi4uJ04p80aRIZNmwYIYSQgoICEhERQSIjI8mRI0fImTNnyLhx40j79u3J7du3tY8RiUTEz8+PbNmyhZw9e1bnvioqlYoEBQWR995774XHb+/evUQkEpG//vqLEELImDFjSEhICOnevTs5fvw4+e6778ibb75JIiIiiFQqfe047927R9q2bUvee+89cv78efLLL7+QBQsWEJFIRI4dO0YIIeTWrVtkwIABpF+/fuTatWtEJpORhIQEIhKJyOPHj7V/9+DgYNKjRw+SkJBAzp8/T0aPHk18fHzIw4cPCSGE5Ofnk06dOpHevXuTkydPkuPHj5OePXuS9u3bkzFjxtR6THbt2kVEIhFJSUl54bGrkpSUREQiEWnXrh3ZuHEjuXjx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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;So, we can observe that applying some &quot;old&quot; and simple techniques without &quot;fine-tune&quot; we obtain a classifier in a few lines of code and no more than one hour of processing time. And this classifier can predict with a relatively high confidence when a tweet is announcing a fake or real disaster.&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Visualize-some-results-from-our-text&quot;&gt;Visualize some results from our text&lt;a class=&quot;anchor-link&quot; href=&quot;#Visualize-some-results-from-our-text&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Another tool we can use to analyze the results is a WordCloud where we can draw the most relevant words in the fake tweets and real tweets.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# visualize the data on a WordCloud&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;visualize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TARGET_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;TEXT_COLUMN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;msg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;wordcloud&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;WordCloud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;height&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;generate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;imshow&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;wordcloud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;off&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;visualize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;visualize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Some-links-to-review:&quot;&gt;Some links to review:&lt;a class=&quot;anchor-link&quot; href=&quot;#Some-links-to-review:&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;[1]: &lt;a href=&quot;https://nlp.stanford.edu/IR-book/html/htmledition/tokenization-1.html&quot;&gt;https://nlp.stanford.edu/IR-book/html/htmledition/tokenization-1.html&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;[2]: &lt;a href=&quot;https://www.analyticsvidhya.com/blog/2020/05/what-is-tokenization-nlp/&quot;&gt;https://www.analyticsvidhya.com/blog/2020/05/what-is-tokenization-nlp/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://www.darrinbishop.com/blog/2017/10/text-analytics-document-term-matrix/&quot;&gt;http://www.darrinbishop.com/blog/2017/10/text-analytics-document-term-matrix/&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">A guided introduction to building a Deep Recurrent Neural Network (DRNN) from scratch</title><link href="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/tensorflow1/2020/07/23/Deep_RNN_tensorflow1.html" rel="alternate" type="text/html" title="A guided introduction to building a Deep Recurrent Neural Network (DRNN) from scratch" /><published>2020-07-23T00:00:00-05:00</published><updated>2020-07-23T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/tensorflow1/2020/07/23/Deep_RNN_tensorflow1</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/rnn/tensorflow1/2020/07/23/Deep_RNN_tensorflow1.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-23-Deep_RNN_tensorflow1.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Deep-Recurrent-Neural-Network-using-TensorFlow-1-and-Keras-lybrary&quot;&gt;Deep Recurrent Neural Network using TensorFlow 1 and Keras lybrary&lt;a class=&quot;anchor-link&quot; href=&quot;#Deep-Recurrent-Neural-Network-using-TensorFlow-1-and-Keras-lybrary&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;This notebook explain and describe how to desing a deep RNN and then introduce us to the LSTM and GRU cells, a more advanced RNN designed to solve some well-known limitations of the deep, large, RNN. As the previous notebook, the texts and code section are extracted from the great book  &quot;Hands-on Machine Learning with Scikit Learn ad Tensorflow First Edition&quot;. We highly encourage you to read it.&lt;/p&gt;
&lt;p&gt;It is quite common to stack multiple layers of cells. This gives you a deep RNN.
To implement a deep RNN in TensorFlow, you can create several cells and stack them
into a MultiRNNCell. In the following code we stack three identical cells&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# To plot pretty figures&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;axes.labelsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;xtick.labelsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ytick.labelsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Ignore and hide warnings&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;warnings&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;warnings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filterwarnings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# to make this notebook&amp;#39;s output stable across runs&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_default_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_random_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# This will be defined in every example&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Ts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ys&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Multi-RNNCell&quot;&gt;Multi RNNCell&lt;a class=&quot;anchor-link&quot; href=&quot;#Multi-RNNCell&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Now we can create our multiple layer RNN using a MultiRNNCell and unrolling it.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
          &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;multi_layer_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_layer_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The states variable is a tuple containing one tensor per layer,
each representing the final state of that layer’s cell (with shape [batch_size, n_neu
rons]). If you set state_is_tuple=False when creating the MultiRNNCell, then
states becomes a single tensor containing the states from every layer, concatenated
along the column axis (i.e., its shape is [batch_size, n_layers * n_neurons]).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(2, 5, 100)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Applying-Dropout&quot;&gt;Applying Dropout&lt;a class=&quot;anchor-link&quot; href=&quot;#Applying-Dropout&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;If you build a very deep RNN, it may end up overfitting the training set. To prevent
that, a common technique is to apply dropout. You can
simply add a dropout layer before or after the RNN as usual, but if you also want to
apply dropout between the RNN layers, you need to use a DropoutWrapper.&lt;/p&gt;
&lt;p&gt;The following
code applies dropout to the inputs of each layer in the RNN:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;keep_prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cells_drop&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DropoutWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_keep_prob&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keep_prob&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cells&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;multi_layer_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cells_drop&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_layer_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From C:\Users\edumu\AppData\Roaming\Python\Python36\site-packages\tensorflow\python\ops\rnn_cell_impl.py:1259: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The rest of the construction phase is like earlier&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;square&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AdamOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From &amp;lt;ipython-input-10-c73e340fa897&amp;gt;:4: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Unfortunately, this code is only usable for training, because the DropoutWrapper class has no training parameter, so it always applies dropout, even when the model is not being trained, so we must first train the model, then create a different model for testing, without the DropoutWrapper.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Training MSE:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./my_dropout_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0 Training MSE: 16.623817
100 Training MSE: 4.6660967
200 Training MSE: 3.925847
300 Training MSE: 3.512689
400 Training MSE: 2.8907187
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now that the model is trained, we need to create the model again, but without the DropoutWrapper for testing:
&lt;strong&gt;Another option is set keep_prob to 1.0 in a new model for testing__&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;keep_prob&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
         &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;multi_layer_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cells&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_layer_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;square&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./my_dropout_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Testing the model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;bo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;prediction&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;upper left&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From C:\Users\edumu\AppData\Roaming\Python\Python36\site-packages\tensorflow\python\training\saver.py:1266: checkpoint_exists (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to check for files with this prefix.
INFO:tensorflow:Restoring parameters from ./my_dropout_time_series_model
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_svg output_subarea &quot;&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot; standalone=&quot;no&quot;?&gt;
&amp;lt;!DOCTYPE svg PUBLIC &quot;-//W3C//DTD SVG 1.1//EN&quot;
  &quot;http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd&quot;&amp;gt;
&lt;!-- Created with matplotlib (https://matplotlib.org/) --&gt;
&lt;svg height=&quot;284.640938pt&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 373.890625 284.640938&quot; width=&quot;373.890625pt&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot;&gt;
 &lt;defs&gt;
  &lt;style type=&quot;text/css&quot;&gt;
*{stroke-linecap:butt;stroke-linejoin:round;}
  &lt;/style&gt;
 &lt;/defs&gt;
 &lt;g id=&quot;figure_1&quot;&gt;
  &lt;g id=&quot;patch_1&quot;&gt;
   &lt;path d=&quot;M 0 284.640938 
L 373.890625 284.640938 
L 373.890625 0 
L 0 0 
z
&quot; style=&quot;fill:none;&quot; /&gt;
  &lt;/g&gt;
  &lt;g id=&quot;axes_1&quot;&gt;
   &lt;g id=&quot;patch_2&quot;&gt;
    &lt;path d=&quot;M 31.890625 241.277813 
L 366.690625 241.277813 
L 366.690625 23.837812 
L 31.890625 23.837812 
z
&quot; style=&quot;fill:#ffffff;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_1&quot;&gt;
    &lt;g id=&quot;xtick_1&quot;&gt;
     &lt;g id=&quot;line2d_1&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L 0 3.5 
&quot; id=&quot;mea35983720&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;90.589326&quot; xlink:href=&quot;#mea35983720&quot; y=&quot;241.277813&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_1&quot;&gt;
      &lt;!-- 12.5 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 12.40625 8.296875 
L 28.515625 8.296875 
L 28.515625 63.921875 
L 10.984375 60.40625 
L 10.984375 69.390625 
L 28.421875 72.90625 
L 38.28125 72.90625 
L 38.28125 8.296875 
L 54.390625 8.296875 
L 54.390625 0 
L 12.40625 0 
z
&quot; id=&quot;DejaVuSans-49&quot; /&gt;
       &lt;path d=&quot;M 19.1875 8.296875 
L 53.609375 8.296875 
L 53.609375 0 
L 7.328125 0 
L 7.328125 8.296875 
Q 12.9375 14.109375 22.625 23.890625 
Q 32.328125 33.6875 34.8125 36.53125 
Q 39.546875 41.84375 41.421875 45.53125 
Q 43.3125 49.21875 43.3125 52.78125 
Q 43.3125 58.59375 39.234375 62.25 
Q 35.15625 65.921875 28.609375 65.921875 
Q 23.96875 65.921875 18.8125 64.3125 
Q 13.671875 62.703125 7.8125 59.421875 
L 7.8125 69.390625 
Q 13.765625 71.78125 18.9375 73 
Q 24.125 74.21875 28.421875 74.21875 
Q 39.75 74.21875 46.484375 68.546875 
Q 53.21875 62.890625 53.21875 53.421875 
Q 53.21875 48.921875 51.53125 44.890625 
Q 49.859375 40.875 45.40625 35.40625 
Q 44.1875 33.984375 37.640625 27.21875 
Q 31.109375 20.453125 19.1875 8.296875 
z
&quot; id=&quot;DejaVuSans-50&quot; /&gt;
       &lt;path d=&quot;M 10.6875 12.40625 
L 21 12.40625 
L 21 0 
L 10.6875 0 
z
&quot; id=&quot;DejaVuSans-46&quot; /&gt;
       &lt;path d=&quot;M 10.796875 72.90625 
L 49.515625 72.90625 
L 49.515625 64.59375 
L 19.828125 64.59375 
L 19.828125 46.734375 
Q 21.96875 47.46875 24.109375 47.828125 
Q 26.265625 48.1875 28.421875 48.1875 
Q 40.625 48.1875 47.75 41.5 
Q 54.890625 34.8125 54.890625 23.390625 
Q 54.890625 11.625 47.5625 5.09375 
Q 40.234375 -1.421875 26.90625 -1.421875 
Q 22.3125 -1.421875 17.546875 -0.640625 
Q 12.796875 0.140625 7.71875 1.703125 
L 7.71875 11.625 
Q 12.109375 9.234375 16.796875 8.0625 
Q 21.484375 6.890625 26.703125 6.890625 
Q 35.15625 6.890625 40.078125 11.328125 
Q 45.015625 15.765625 45.015625 23.390625 
Q 45.015625 31 40.078125 35.4375 
Q 35.15625 39.890625 26.703125 39.890625 
Q 22.75 39.890625 18.8125 39.015625 
Q 14.890625 38.140625 10.796875 36.28125 
z
&quot; id=&quot;DejaVuSans-53&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(77.229951 257.395938)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-49&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
       &lt;use x=&quot;127.246094&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-53&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_2&quot;&gt;
     &lt;g id=&quot;line2d_2&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;163.056859&quot; xlink:href=&quot;#mea35983720&quot; y=&quot;241.277813&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_2&quot;&gt;
      &lt;!-- 13.0 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 40.578125 39.3125 
Q 47.65625 37.796875 51.625 33 
Q 55.609375 28.21875 55.609375 21.1875 
Q 55.609375 10.40625 48.1875 4.484375 
Q 40.765625 -1.421875 27.09375 -1.421875 
Q 22.515625 -1.421875 17.65625 -0.515625 
Q 12.796875 0.390625 7.625 2.203125 
L 7.625 11.71875 
Q 11.71875 9.328125 16.59375 8.109375 
Q 21.484375 6.890625 26.8125 6.890625 
Q 36.078125 6.890625 40.9375 10.546875 
Q 45.796875 14.203125 45.796875 21.1875 
Q 45.796875 27.640625 41.28125 31.265625 
Q 36.765625 34.90625 28.71875 34.90625 
L 20.21875 34.90625 
L 20.21875 43.015625 
L 29.109375 43.015625 
Q 36.375 43.015625 40.234375 45.921875 
Q 44.09375 48.828125 44.09375 54.296875 
Q 44.09375 59.90625 40.109375 62.90625 
Q 36.140625 65.921875 28.71875 65.921875 
Q 24.65625 65.921875 20.015625 65.03125 
Q 15.375 64.15625 9.8125 62.3125 
L 9.8125 71.09375 
Q 15.4375 72.65625 20.34375 73.4375 
Q 25.25 74.21875 29.59375 74.21875 
Q 40.828125 74.21875 47.359375 69.109375 
Q 53.90625 64.015625 53.90625 55.328125 
Q 53.90625 49.265625 50.4375 45.09375 
Q 46.96875 40.921875 40.578125 39.3125 
z
&quot; id=&quot;DejaVuSans-51&quot; /&gt;
       &lt;path d=&quot;M 31.78125 66.40625 
Q 24.171875 66.40625 20.328125 58.90625 
Q 16.5 51.421875 16.5 36.375 
Q 16.5 21.390625 20.328125 13.890625 
Q 24.171875 6.390625 31.78125 6.390625 
Q 39.453125 6.390625 43.28125 13.890625 
Q 47.125 21.390625 47.125 36.375 
Q 47.125 51.421875 43.28125 58.90625 
Q 39.453125 66.40625 31.78125 66.40625 
z
M 31.78125 74.21875 
Q 44.046875 74.21875 50.515625 64.515625 
Q 56.984375 54.828125 56.984375 36.375 
Q 56.984375 17.96875 50.515625 8.265625 
Q 44.046875 -1.421875 31.78125 -1.421875 
Q 19.53125 -1.421875 13.0625 8.265625 
Q 6.59375 17.96875 6.59375 36.375 
Q 6.59375 54.828125 13.0625 64.515625 
Q 19.53125 74.21875 31.78125 74.21875 
z
&quot; id=&quot;DejaVuSans-48&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(149.697484 257.395938)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-49&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
       &lt;use x=&quot;127.246094&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_3&quot;&gt;
     &lt;g id=&quot;line2d_3&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;235.524391&quot; xlink:href=&quot;#mea35983720&quot; y=&quot;241.277813&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_3&quot;&gt;
      &lt;!-- 13.5 --&gt;
      &lt;g transform=&quot;translate(222.165016 257.395938)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-49&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-51&quot; /&gt;
       &lt;use x=&quot;127.246094&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-53&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;xtick_4&quot;&gt;
     &lt;g id=&quot;line2d_4&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;307.991924&quot; xlink:href=&quot;#mea35983720&quot; y=&quot;241.277813&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_4&quot;&gt;
      &lt;!-- 14.0 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 37.796875 64.3125 
L 12.890625 25.390625 
L 37.796875 25.390625 
z
M 35.203125 72.90625 
L 47.609375 72.90625 
L 47.609375 25.390625 
L 58.015625 25.390625 
L 58.015625 17.1875 
L 47.609375 17.1875 
L 47.609375 0 
L 37.796875 0 
L 37.796875 17.1875 
L 4.890625 17.1875 
L 4.890625 26.703125 
z
&quot; id=&quot;DejaVuSans-52&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(294.632549 257.395938)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-49&quot; /&gt;
       &lt;use x=&quot;63.623047&quot; xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
       &lt;use x=&quot;127.246094&quot; xlink:href=&quot;#DejaVuSans-46&quot; /&gt;
       &lt;use x=&quot;159.033203&quot; xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_5&quot;&gt;
     &lt;!-- Time --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M -0.296875 72.90625 
L 61.375 72.90625 
L 61.375 64.59375 
L 35.5 64.59375 
L 35.5 0 
L 25.59375 0 
L 25.59375 64.59375 
L -0.296875 64.59375 
z
&quot; id=&quot;DejaVuSans-84&quot; /&gt;
      &lt;path d=&quot;M 9.421875 54.6875 
L 18.40625 54.6875 
L 18.40625 0 
L 9.421875 0 
z
M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 64.59375 
L 9.421875 64.59375 
z
&quot; id=&quot;DejaVuSans-105&quot; /&gt;
      &lt;path d=&quot;M 52 44.1875 
Q 55.375 50.25 60.0625 53.125 
Q 64.75 56 71.09375 56 
Q 79.640625 56 84.28125 50.015625 
Q 88.921875 44.046875 88.921875 33.015625 
L 88.921875 0 
L 79.890625 0 
L 79.890625 32.71875 
Q 79.890625 40.578125 77.09375 44.375 
Q 74.3125 48.1875 68.609375 48.1875 
Q 61.625 48.1875 57.5625 43.546875 
Q 53.515625 38.921875 53.515625 30.90625 
L 53.515625 0 
L 44.484375 0 
L 44.484375 32.71875 
Q 44.484375 40.625 41.703125 44.40625 
Q 38.921875 48.1875 33.109375 48.1875 
Q 26.21875 48.1875 22.15625 43.53125 
Q 18.109375 38.875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.1875 51.21875 25.484375 53.609375 
Q 29.78125 56 35.6875 56 
Q 41.65625 56 45.828125 52.96875 
Q 50 49.953125 52 44.1875 
z
&quot; id=&quot;DejaVuSans-109&quot; /&gt;
      &lt;path d=&quot;M 56.203125 29.59375 
L 56.203125 25.203125 
L 14.890625 25.203125 
Q 15.484375 15.921875 20.484375 11.0625 
Q 25.484375 6.203125 34.421875 6.203125 
Q 39.59375 6.203125 44.453125 7.46875 
Q 49.3125 8.734375 54.109375 11.28125 
L 54.109375 2.78125 
Q 49.265625 0.734375 44.1875 -0.34375 
Q 39.109375 -1.421875 33.890625 -1.421875 
Q 20.796875 -1.421875 13.15625 6.1875 
Q 5.515625 13.8125 5.515625 26.8125 
Q 5.515625 40.234375 12.765625 48.109375 
Q 20.015625 56 32.328125 56 
Q 43.359375 56 49.78125 48.890625 
Q 56.203125 41.796875 56.203125 29.59375 
z
M 47.21875 32.234375 
Q 47.125 39.59375 43.09375 43.984375 
Q 39.0625 48.390625 32.421875 48.390625 
Q 24.90625 48.390625 20.390625 44.140625 
Q 15.875 39.890625 15.1875 32.171875 
z
&quot; id=&quot;DejaVuSans-101&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(181.948125 274.529375)scale(0.14 -0.14)&quot;&gt;
      &lt;use xlink:href=&quot;#DejaVuSans-84&quot; /&gt;
      &lt;use x=&quot;61.037109&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
      &lt;use x=&quot;88.820312&quot; xlink:href=&quot;#DejaVuSans-109&quot; /&gt;
      &lt;use x=&quot;186.232422&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;matplotlib.axis_2&quot;&gt;
    &lt;g id=&quot;ytick_1&quot;&gt;
     &lt;g id=&quot;line2d_5&quot;&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 0 0 
L -3.5 0 
&quot; id=&quot;ma724558c7c&quot; style=&quot;stroke:#000000;stroke-width:0.8;&quot; /&gt;
      &lt;/defs&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;31.890625&quot; xlink:href=&quot;#ma724558c7c&quot; y=&quot;204.018207&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_6&quot;&gt;
      &lt;!-- −2 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 10.59375 35.5 
L 73.1875 35.5 
L 73.1875 27.203125 
L 10.59375 27.203125 
z
&quot; id=&quot;DejaVuSans-8722&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(7.2 208.57727)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-8722&quot; /&gt;
       &lt;use x=&quot;83.789062&quot; xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_2&quot;&gt;
     &lt;g id=&quot;line2d_6&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;31.890625&quot; xlink:href=&quot;#ma724558c7c&quot; y=&quot;164.600948&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_7&quot;&gt;
      &lt;!-- 0 --&gt;
      &lt;g transform=&quot;translate(17.255625 169.16001)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-48&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_3&quot;&gt;
     &lt;g id=&quot;line2d_7&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;31.890625&quot; xlink:href=&quot;#ma724558c7c&quot; y=&quot;125.183689&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_8&quot;&gt;
      &lt;!-- 2 --&gt;
      &lt;g transform=&quot;translate(17.255625 129.742751)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-50&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_4&quot;&gt;
     &lt;g id=&quot;line2d_8&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;31.890625&quot; xlink:href=&quot;#ma724558c7c&quot; y=&quot;85.766429&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_9&quot;&gt;
      &lt;!-- 4 --&gt;
      &lt;g transform=&quot;translate(17.255625 90.325492)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-52&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;ytick_5&quot;&gt;
     &lt;g id=&quot;line2d_9&quot;&gt;
      &lt;g&gt;
       &lt;use style=&quot;stroke:#000000;stroke-width:0.8;&quot; x=&quot;31.890625&quot; xlink:href=&quot;#ma724558c7c&quot; y=&quot;46.34917&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
     &lt;g id=&quot;text_10&quot;&gt;
      &lt;!-- 6 --&gt;
      &lt;defs&gt;
       &lt;path d=&quot;M 33.015625 40.375 
Q 26.375 40.375 22.484375 35.828125 
Q 18.609375 31.296875 18.609375 23.390625 
Q 18.609375 15.53125 22.484375 10.953125 
Q 26.375 6.390625 33.015625 6.390625 
Q 39.65625 6.390625 43.53125 10.953125 
Q 47.40625 15.53125 47.40625 23.390625 
Q 47.40625 31.296875 43.53125 35.828125 
Q 39.65625 40.375 33.015625 40.375 
z
M 52.59375 71.296875 
L 52.59375 62.3125 
Q 48.875 64.0625 45.09375 64.984375 
Q 41.3125 65.921875 37.59375 65.921875 
Q 27.828125 65.921875 22.671875 59.328125 
Q 17.53125 52.734375 16.796875 39.40625 
Q 19.671875 43.65625 24.015625 45.921875 
Q 28.375 48.1875 33.59375 48.1875 
Q 44.578125 48.1875 50.953125 41.515625 
Q 57.328125 34.859375 57.328125 23.390625 
Q 57.328125 12.15625 50.6875 5.359375 
Q 44.046875 -1.421875 33.015625 -1.421875 
Q 20.359375 -1.421875 13.671875 8.265625 
Q 6.984375 17.96875 6.984375 36.375 
Q 6.984375 53.65625 15.1875 63.9375 
Q 23.390625 74.21875 37.203125 74.21875 
Q 40.921875 74.21875 44.703125 73.484375 
Q 48.484375 72.75 52.59375 71.296875 
z
&quot; id=&quot;DejaVuSans-54&quot; /&gt;
      &lt;/defs&gt;
      &lt;g transform=&quot;translate(17.255625 50.908233)scale(0.12 -0.12)&quot;&gt;
       &lt;use xlink:href=&quot;#DejaVuSans-54&quot; /&gt;
      &lt;/g&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_10&quot;&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 0 5 
C 1.326016 5 2.597899 4.473168 3.535534 3.535534 
C 4.473168 2.597899 5 1.326016 5 0 
C 5 -1.326016 4.473168 -2.597899 3.535534 -3.535534 
C 2.597899 -4.473168 1.326016 -5 0 -5 
C -1.326016 -5 -2.597899 -4.473168 -3.535534 -3.535534 
C -4.473168 -2.597899 -5 -1.326016 -5 0 
C -5 1.326016 -4.473168 2.597899 -3.535534 3.535534 
C -2.597899 4.473168 -1.326016 5 0 5 
z
&quot; id=&quot;mea819fdfe2&quot; style=&quot;stroke:#0000ff;&quot; /&gt;
    &lt;/defs&gt;
    &lt;g clip-path=&quot;url(#p82d3d07fcd)&quot;&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;47.108807&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;231.394176&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;62.326989&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;223.542129&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;77.54517&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;205.070872&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;92.763352&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;178.836158&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;107.981534&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;149.713386&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;123.199716&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;123.308135&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;138.417898&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;104.470951&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;153.63608&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;96.016168&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;168.854261&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;97.989573&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;184.072443&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;107.681875&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;199.290625&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;120.384042&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;214.508807&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;130.680774&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;229.726989&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;133.933406&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;244.94517&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;127.552512&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;260.163352&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;111.717171&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;275.381534&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;89.346871&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;290.599716&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;65.333364&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;305.817898&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;45.239136&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;321.03608&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;33.812855&quot; /&gt;
     &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;336.254261&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;33.721449&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_11&quot;&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 0 -5 
L -1.12257 -1.545085 
L -4.755283 -1.545085 
L -1.816356 0.59017 
L -2.938926 4.045085 
L -0 1.90983 
L 2.938926 4.045085 
L 1.816356 0.59017 
L 4.755283 -1.545085 
L 1.12257 -1.545085 
z
&quot; id=&quot;m627b4b924d&quot; style=&quot;stroke:#ffffff;stroke-linejoin:bevel;&quot; /&gt;
    &lt;/defs&gt;
    &lt;g clip-path=&quot;url(#p82d3d07fcd)&quot;&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;62.326989&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;223.542129&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;77.54517&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;205.070872&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;92.763352&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;178.836158&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;107.981534&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;149.713386&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;123.199716&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;123.308135&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;138.417898&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;104.470951&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;153.63608&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;96.016168&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;168.854261&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;97.989573&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;184.072443&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;107.681875&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;199.290625&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;120.384042&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;214.508807&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;130.680774&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;229.726989&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;133.933406&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;244.94517&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;127.552512&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;260.163352&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;111.717171&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;275.381534&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;89.346871&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;290.599716&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;65.333364&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;305.817898&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;45.239136&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;321.03608&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;33.812855&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;336.254261&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;33.721449&quot; /&gt;
     &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;351.472443&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;44.840194&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;line2d_12&quot;&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 0 2.5 
C 0.663008 2.5 1.29895 2.236584 1.767767 1.767767 
C 2.236584 1.29895 2.5 0.663008 2.5 0 
C 2.5 -0.663008 2.236584 -1.29895 1.767767 -1.767767 
C 1.29895 -2.236584 0.663008 -2.5 0 -2.5 
C -0.663008 -2.5 -1.29895 -2.236584 -1.767767 -1.767767 
C -2.236584 -1.29895 -2.5 -0.663008 -2.5 0 
C -2.5 0.663008 -2.236584 1.29895 -1.767767 1.767767 
C -1.29895 2.236584 -0.663008 2.5 0 2.5 
z
&quot; id=&quot;mc42a00adea&quot; style=&quot;stroke:#ff0000;&quot; /&gt;
    &lt;/defs&gt;
    &lt;g clip-path=&quot;url(#p82d3d07fcd)&quot;&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;62.326989&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;199.042487&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;77.54517&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;195.728357&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;92.763352&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;174.073978&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;107.981534&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;164.82086&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;123.199716&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;140.230776&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;138.417898&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;136.272765&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;153.63608&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;136.606812&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;168.854261&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;124.353449&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;184.072443&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;133.968385&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;199.290625&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;149.392308&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;214.508807&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;153.70369&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;229.726989&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;155.66239&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;244.94517&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;131.746119&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;260.163352&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;107.431006&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;275.381534&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;100.400046&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;290.599716&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;92.269143&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;305.817898&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;73.854098&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;321.03608&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;71.280706&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;336.254261&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;83.595827&quot; /&gt;
     &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;351.472443&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;102.421481&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_3&quot;&gt;
    &lt;path d=&quot;M 31.890625 241.277812 
L 31.890625 23.837812 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_4&quot;&gt;
    &lt;path d=&quot;M 366.690625 241.277812 
L 366.690625 23.837812 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_5&quot;&gt;
    &lt;path d=&quot;M 31.890625 241.277813 
L 366.690625 241.277813 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;patch_6&quot;&gt;
    &lt;path d=&quot;M 31.890625 23.837812 
L 366.690625 23.837812 
&quot; style=&quot;fill:none;stroke:#000000;stroke-linecap:square;stroke-linejoin:miter;stroke-width:0.8;&quot; /&gt;
   &lt;/g&gt;
   &lt;g id=&quot;text_11&quot;&gt;
    &lt;!-- Testing the model --&gt;
    &lt;defs&gt;
     &lt;path d=&quot;M 44.28125 53.078125 
L 44.28125 44.578125 
Q 40.484375 46.53125 36.375 47.5 
Q 32.28125 48.484375 27.875 48.484375 
Q 21.1875 48.484375 17.84375 46.4375 
Q 14.5 44.390625 14.5 40.28125 
Q 14.5 37.15625 16.890625 35.375 
Q 19.28125 33.59375 26.515625 31.984375 
L 29.59375 31.296875 
Q 39.15625 29.25 43.1875 25.515625 
Q 47.21875 21.78125 47.21875 15.09375 
Q 47.21875 7.46875 41.1875 3.015625 
Q 35.15625 -1.421875 24.609375 -1.421875 
Q 20.21875 -1.421875 15.453125 -0.5625 
Q 10.6875 0.296875 5.421875 2 
L 5.421875 11.28125 
Q 10.40625 8.6875 15.234375 7.390625 
Q 20.0625 6.109375 24.8125 6.109375 
Q 31.15625 6.109375 34.5625 8.28125 
Q 37.984375 10.453125 37.984375 14.40625 
Q 37.984375 18.0625 35.515625 20.015625 
Q 33.0625 21.96875 24.703125 23.78125 
L 21.578125 24.515625 
Q 13.234375 26.265625 9.515625 29.90625 
Q 5.8125 33.546875 5.8125 39.890625 
Q 5.8125 47.609375 11.28125 51.796875 
Q 16.75 56 26.8125 56 
Q 31.78125 56 36.171875 55.265625 
Q 40.578125 54.546875 44.28125 53.078125 
z
&quot; id=&quot;DejaVuSans-115&quot; /&gt;
     &lt;path d=&quot;M 18.3125 70.21875 
L 18.3125 54.6875 
L 36.8125 54.6875 
L 36.8125 47.703125 
L 18.3125 47.703125 
L 18.3125 18.015625 
Q 18.3125 11.328125 20.140625 9.421875 
Q 21.96875 7.515625 27.59375 7.515625 
L 36.8125 7.515625 
L 36.8125 0 
L 27.59375 0 
Q 17.1875 0 13.234375 3.875 
Q 9.28125 7.765625 9.28125 18.015625 
L 9.28125 47.703125 
L 2.6875 47.703125 
L 2.6875 54.6875 
L 9.28125 54.6875 
L 9.28125 70.21875 
z
&quot; id=&quot;DejaVuSans-116&quot; /&gt;
     &lt;path d=&quot;M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
&quot; id=&quot;DejaVuSans-110&quot; /&gt;
     &lt;path d=&quot;M 45.40625 27.984375 
Q 45.40625 37.75 41.375 43.109375 
Q 37.359375 48.484375 30.078125 48.484375 
Q 22.859375 48.484375 18.828125 43.109375 
Q 14.796875 37.75 14.796875 27.984375 
Q 14.796875 18.265625 18.828125 12.890625 
Q 22.859375 7.515625 30.078125 7.515625 
Q 37.359375 7.515625 41.375 12.890625 
Q 45.40625 18.265625 45.40625 27.984375 
z
M 54.390625 6.78125 
Q 54.390625 -7.171875 48.1875 -13.984375 
Q 42 -20.796875 29.203125 -20.796875 
Q 24.46875 -20.796875 20.265625 -20.09375 
Q 16.0625 -19.390625 12.109375 -17.921875 
L 12.109375 -9.1875 
Q 16.0625 -11.328125 19.921875 -12.34375 
Q 23.78125 -13.375 27.78125 -13.375 
Q 36.625 -13.375 41.015625 -8.765625 
Q 45.40625 -4.15625 45.40625 5.171875 
L 45.40625 9.625 
Q 42.625 4.78125 38.28125 2.390625 
Q 33.9375 0 27.875 0 
Q 17.828125 0 11.671875 7.65625 
Q 5.515625 15.328125 5.515625 27.984375 
Q 5.515625 40.671875 11.671875 48.328125 
Q 17.828125 56 27.875 56 
Q 33.9375 56 38.28125 53.609375 
Q 42.625 51.21875 45.40625 46.390625 
L 45.40625 54.6875 
L 54.390625 54.6875 
z
&quot; id=&quot;DejaVuSans-103&quot; /&gt;
     &lt;path id=&quot;DejaVuSans-32&quot; /&gt;
     &lt;path d=&quot;M 54.890625 33.015625 
L 54.890625 0 
L 45.90625 0 
L 45.90625 32.71875 
Q 45.90625 40.484375 42.875 44.328125 
Q 39.84375 48.1875 33.796875 48.1875 
Q 26.515625 48.1875 22.3125 43.546875 
Q 18.109375 38.921875 18.109375 30.90625 
L 18.109375 0 
L 9.078125 0 
L 9.078125 75.984375 
L 18.109375 75.984375 
L 18.109375 46.1875 
Q 21.34375 51.125 25.703125 53.5625 
Q 30.078125 56 35.796875 56 
Q 45.21875 56 50.046875 50.171875 
Q 54.890625 44.34375 54.890625 33.015625 
z
&quot; id=&quot;DejaVuSans-104&quot; /&gt;
     &lt;path d=&quot;M 30.609375 48.390625 
Q 23.390625 48.390625 19.1875 42.75 
Q 14.984375 37.109375 14.984375 27.296875 
Q 14.984375 17.484375 19.15625 11.84375 
Q 23.34375 6.203125 30.609375 6.203125 
Q 37.796875 6.203125 41.984375 11.859375 
Q 46.1875 17.53125 46.1875 27.296875 
Q 46.1875 37.015625 41.984375 42.703125 
Q 37.796875 48.390625 30.609375 48.390625 
z
M 30.609375 56 
Q 42.328125 56 49.015625 48.375 
Q 55.71875 40.765625 55.71875 27.296875 
Q 55.71875 13.875 49.015625 6.21875 
Q 42.328125 -1.421875 30.609375 -1.421875 
Q 18.84375 -1.421875 12.171875 6.21875 
Q 5.515625 13.875 5.515625 27.296875 
Q 5.515625 40.765625 12.171875 48.375 
Q 18.84375 56 30.609375 56 
z
&quot; id=&quot;DejaVuSans-111&quot; /&gt;
     &lt;path d=&quot;M 45.40625 46.390625 
L 45.40625 75.984375 
L 54.390625 75.984375 
L 54.390625 0 
L 45.40625 0 
L 45.40625 8.203125 
Q 42.578125 3.328125 38.25 0.953125 
Q 33.9375 -1.421875 27.875 -1.421875 
Q 17.96875 -1.421875 11.734375 6.484375 
Q 5.515625 14.40625 5.515625 27.296875 
Q 5.515625 40.1875 11.734375 48.09375 
Q 17.96875 56 27.875 56 
Q 33.9375 56 38.25 53.625 
Q 42.578125 51.265625 45.40625 46.390625 
z
M 14.796875 27.296875 
Q 14.796875 17.390625 18.875 11.75 
Q 22.953125 6.109375 30.078125 6.109375 
Q 37.203125 6.109375 41.296875 11.75 
Q 45.40625 17.390625 45.40625 27.296875 
Q 45.40625 37.203125 41.296875 42.84375 
Q 37.203125 48.484375 30.078125 48.484375 
Q 22.953125 48.484375 18.875 42.84375 
Q 14.796875 37.203125 14.796875 27.296875 
z
&quot; id=&quot;DejaVuSans-100&quot; /&gt;
     &lt;path d=&quot;M 9.421875 75.984375 
L 18.40625 75.984375 
L 18.40625 0 
L 9.421875 0 
z
&quot; id=&quot;DejaVuSans-108&quot; /&gt;
    &lt;/defs&gt;
    &lt;g transform=&quot;translate(135.776563 17.837812)scale(0.14 -0.14)&quot;&gt;
     &lt;use xlink:href=&quot;#DejaVuSans-84&quot; /&gt;
     &lt;use x=&quot;60.818359&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
     &lt;use x=&quot;122.341797&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
     &lt;use x=&quot;174.441406&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;213.650391&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
     &lt;use x=&quot;241.433594&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
     &lt;use x=&quot;304.8125&quot; xlink:href=&quot;#DejaVuSans-103&quot; /&gt;
     &lt;use x=&quot;368.289062&quot; xlink:href=&quot;#DejaVuSans-32&quot; /&gt;
     &lt;use x=&quot;400.076172&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;use x=&quot;439.285156&quot; xlink:href=&quot;#DejaVuSans-104&quot; /&gt;
     &lt;use x=&quot;502.664062&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
     &lt;use x=&quot;564.1875&quot; xlink:href=&quot;#DejaVuSans-32&quot; /&gt;
     &lt;use x=&quot;595.974609&quot; xlink:href=&quot;#DejaVuSans-109&quot; /&gt;
     &lt;use x=&quot;693.386719&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
     &lt;use x=&quot;754.568359&quot; xlink:href=&quot;#DejaVuSans-100&quot; /&gt;
     &lt;use x=&quot;818.044922&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
     &lt;use x=&quot;879.568359&quot; xlink:href=&quot;#DejaVuSans-108&quot; /&gt;
    &lt;/g&gt;
   &lt;/g&gt;
   &lt;g id=&quot;legend_1&quot;&gt;
    &lt;g id=&quot;patch_7&quot;&gt;
     &lt;path d=&quot;M 38.890625 75.872187 
L 121.279687 75.872187 
Q 123.279687 75.872187 123.279687 73.872187 
L 123.279687 30.837812 
Q 123.279687 28.837812 121.279687 28.837812 
L 38.890625 28.837812 
Q 36.890625 28.837812 36.890625 30.837812 
L 36.890625 73.872187 
Q 36.890625 75.872187 38.890625 75.872187 
z
&quot; style=&quot;fill:#ffffff;opacity:0.8;stroke:#cccccc;stroke-linejoin:miter;&quot; /&gt;
    &lt;/g&gt;
    &lt;g id=&quot;line2d_13&quot; /&gt;
    &lt;g id=&quot;line2d_14&quot;&gt;
     &lt;g&gt;
      &lt;use style=&quot;fill:#0000ff;stroke:#0000ff;&quot; x=&quot;50.890625&quot; xlink:href=&quot;#mea819fdfe2&quot; y=&quot;36.93625&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_12&quot;&gt;
     &lt;!-- instance --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 34.28125 27.484375 
Q 23.390625 27.484375 19.1875 25 
Q 14.984375 22.515625 14.984375 16.5 
Q 14.984375 11.71875 18.140625 8.90625 
Q 21.296875 6.109375 26.703125 6.109375 
Q 34.1875 6.109375 38.703125 11.40625 
Q 43.21875 16.703125 43.21875 25.484375 
L 43.21875 27.484375 
z
M 52.203125 31.203125 
L 52.203125 0 
L 43.21875 0 
L 43.21875 8.296875 
Q 40.140625 3.328125 35.546875 0.953125 
Q 30.953125 -1.421875 24.3125 -1.421875 
Q 15.921875 -1.421875 10.953125 3.296875 
Q 6 8.015625 6 15.921875 
Q 6 25.140625 12.171875 29.828125 
Q 18.359375 34.515625 30.609375 34.515625 
L 43.21875 34.515625 
L 43.21875 35.40625 
Q 43.21875 41.609375 39.140625 45 
Q 35.0625 48.390625 27.6875 48.390625 
Q 23 48.390625 18.546875 47.265625 
Q 14.109375 46.140625 10.015625 43.890625 
L 10.015625 52.203125 
Q 14.9375 54.109375 19.578125 55.046875 
Q 24.21875 56 28.609375 56 
Q 40.484375 56 46.34375 49.84375 
Q 52.203125 43.703125 52.203125 31.203125 
z
&quot; id=&quot;DejaVuSans-97&quot; /&gt;
      &lt;path d=&quot;M 48.78125 52.59375 
L 48.78125 44.1875 
Q 44.96875 46.296875 41.140625 47.34375 
Q 37.3125 48.390625 33.40625 48.390625 
Q 24.65625 48.390625 19.8125 42.84375 
Q 14.984375 37.3125 14.984375 27.296875 
Q 14.984375 17.28125 19.8125 11.734375 
Q 24.65625 6.203125 33.40625 6.203125 
Q 37.3125 6.203125 41.140625 7.25 
Q 44.96875 8.296875 48.78125 10.40625 
L 48.78125 2.09375 
Q 45.015625 0.34375 40.984375 -0.53125 
Q 36.96875 -1.421875 32.421875 -1.421875 
Q 20.0625 -1.421875 12.78125 6.34375 
Q 5.515625 14.109375 5.515625 27.296875 
Q 5.515625 40.671875 12.859375 48.328125 
Q 20.21875 56 33.015625 56 
Q 37.15625 56 41.109375 55.140625 
Q 45.0625 54.296875 48.78125 52.59375 
z
&quot; id=&quot;DejaVuSans-99&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(68.890625 40.43625)scale(0.1 -0.1)&quot;&gt;
      &lt;use xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
      &lt;use x=&quot;27.783203&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
      &lt;use x=&quot;91.162109&quot; xlink:href=&quot;#DejaVuSans-115&quot; /&gt;
      &lt;use x=&quot;143.261719&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;use x=&quot;182.470703&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
      &lt;use x=&quot;243.75&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
      &lt;use x=&quot;307.128906&quot; xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
      &lt;use x=&quot;362.109375&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;line2d_15&quot; /&gt;
    &lt;g id=&quot;line2d_16&quot;&gt;
     &lt;g&gt;
      &lt;use style=&quot;fill:#ffffff;stroke:#ffffff;stroke-linejoin:bevel;&quot; x=&quot;50.890625&quot; xlink:href=&quot;#m627b4b924d&quot; y=&quot;51.614375&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_13&quot;&gt;
     &lt;!-- target --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 41.109375 46.296875 
Q 39.59375 47.171875 37.8125 47.578125 
Q 36.03125 48 33.890625 48 
Q 26.265625 48 22.1875 43.046875 
Q 18.109375 38.09375 18.109375 28.8125 
L 18.109375 0 
L 9.078125 0 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.1875 
Q 20.953125 51.171875 25.484375 53.578125 
Q 30.03125 56 36.53125 56 
Q 37.453125 56 38.578125 55.875 
Q 39.703125 55.765625 41.0625 55.515625 
z
&quot; id=&quot;DejaVuSans-114&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(68.890625 55.114375)scale(0.1 -0.1)&quot;&gt;
      &lt;use xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;use x=&quot;39.208984&quot; xlink:href=&quot;#DejaVuSans-97&quot; /&gt;
      &lt;use x=&quot;100.488281&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
      &lt;use x=&quot;141.585938&quot; xlink:href=&quot;#DejaVuSans-103&quot; /&gt;
      &lt;use x=&quot;205.0625&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
      &lt;use x=&quot;266.585938&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;line2d_17&quot; /&gt;
    &lt;g id=&quot;line2d_18&quot;&gt;
     &lt;g&gt;
      &lt;use style=&quot;fill:#ff0000;stroke:#ff0000;&quot; x=&quot;50.890625&quot; xlink:href=&quot;#mc42a00adea&quot; y=&quot;66.2925&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
    &lt;g id=&quot;text_14&quot;&gt;
     &lt;!-- prediction --&gt;
     &lt;defs&gt;
      &lt;path d=&quot;M 18.109375 8.203125 
L 18.109375 -20.796875 
L 9.078125 -20.796875 
L 9.078125 54.6875 
L 18.109375 54.6875 
L 18.109375 46.390625 
Q 20.953125 51.265625 25.265625 53.625 
Q 29.59375 56 35.59375 56 
Q 45.5625 56 51.78125 48.09375 
Q 58.015625 40.1875 58.015625 27.296875 
Q 58.015625 14.40625 51.78125 6.484375 
Q 45.5625 -1.421875 35.59375 -1.421875 
Q 29.59375 -1.421875 25.265625 0.953125 
Q 20.953125 3.328125 18.109375 8.203125 
z
M 48.6875 27.296875 
Q 48.6875 37.203125 44.609375 42.84375 
Q 40.53125 48.484375 33.40625 48.484375 
Q 26.265625 48.484375 22.1875 42.84375 
Q 18.109375 37.203125 18.109375 27.296875 
Q 18.109375 17.390625 22.1875 11.75 
Q 26.265625 6.109375 33.40625 6.109375 
Q 40.53125 6.109375 44.609375 11.75 
Q 48.6875 17.390625 48.6875 27.296875 
z
&quot; id=&quot;DejaVuSans-112&quot; /&gt;
     &lt;/defs&gt;
     &lt;g transform=&quot;translate(68.890625 69.7925)scale(0.1 -0.1)&quot;&gt;
      &lt;use xlink:href=&quot;#DejaVuSans-112&quot; /&gt;
      &lt;use x=&quot;63.476562&quot; xlink:href=&quot;#DejaVuSans-114&quot; /&gt;
      &lt;use x=&quot;104.558594&quot; xlink:href=&quot;#DejaVuSans-101&quot; /&gt;
      &lt;use x=&quot;166.082031&quot; xlink:href=&quot;#DejaVuSans-100&quot; /&gt;
      &lt;use x=&quot;229.558594&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
      &lt;use x=&quot;257.341797&quot; xlink:href=&quot;#DejaVuSans-99&quot; /&gt;
      &lt;use x=&quot;312.322266&quot; xlink:href=&quot;#DejaVuSans-116&quot; /&gt;
      &lt;use x=&quot;351.53125&quot; xlink:href=&quot;#DejaVuSans-105&quot; /&gt;
      &lt;use x=&quot;379.314453&quot; xlink:href=&quot;#DejaVuSans-111&quot; /&gt;
      &lt;use x=&quot;440.496094&quot; xlink:href=&quot;#DejaVuSans-110&quot; /&gt;
     &lt;/g&gt;
    &lt;/g&gt;
   &lt;/g&gt;
  &lt;/g&gt;
 &lt;/g&gt;
 &lt;defs&gt;
  &lt;clipPath id=&quot;p82d3d07fcd&quot;&gt;
   &lt;rect height=&quot;217.44&quot; width=&quot;334.8&quot; x=&quot;31.890625&quot; y=&quot;23.837812&quot; /&gt;
  &lt;/clipPath&gt;
 &lt;/defs&gt;
&lt;/svg&gt;

&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Oops, it seems that Dropout does not help at all in this particular case.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Handling-long-sequences&quot;&gt;Handling long sequences&lt;a class=&quot;anchor-link&quot; href=&quot;#Handling-long-sequences&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;To train an RNN on long sequences, you will need to run it over many time steps, making the unrolled RNN a very deep network. Just like any deep neural network it may suffer from the vanishing/exploding gradients problem and take forever to train. Many of the tricks to alleviate this problem can be used for deep unrolled RNNs as well: good parameter initialization,
nonsaturating activation functions (e.g., ReLU), Batch Normalization, Gradient Clipping, and faster optimizers. However, if the RNN needs to handle even moderately long sequences (e.g., 100 inputs), then training will still be very slow.&lt;/p&gt;
&lt;p&gt;The simplest and most common solution to this problem is to unroll the RNN only
over a limited number of time steps during training. This is called truncated backpropagation
through time. In TensorFlow you can implement it simply by truncating the
input sequences. The problem, of course, is that the model will
not be able to learn long-term patterns.&lt;/p&gt;
&lt;p&gt;second problem faced by long-running RNNs is the
fact that the memory of the first inputs gradually fades away. Indeed, due to the transformations
that the data goes through when traversing an RNN, some information is
lost after each time step.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;LSTM&quot;&gt;LSTM&lt;a class=&quot;anchor-link&quot; href=&quot;#LSTM&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;If you consider the LSTM cell as a black box, it can be used very much like a basic cell,
except it will perform much better; training will converge faster and it will detect
long-term dependencies in the data. In TensorFlow, you can simply use a BasicLSTM
Cell instead of a BasicRNNCell:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow.examples.tutorials.mnist&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_data_sets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/tmp/data/&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;images&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Extracting /tmp/data/train-images-idx3-ubyte.gz
Extracting /tmp/data/train-labels-idx1-ubyte.gz
Extracting /tmp/data/t10k-images-idx3-ubyte.gz
Extracting /tmp/data/t10k-labels-idx1-ubyte.gz
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lstm_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicLSTMCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;28&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lstm_cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicLSTMCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;multi_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_cells&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;top_layer_h_state&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;top_layer_h_state&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;softmax&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;xentropy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sparse_softmax_cross_entropy_with_logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xentropy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AdamOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;correct&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_top_k&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;logits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cast&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;correct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(LSTMStateTuple(c=&amp;lt;tf.Tensor &amp;#39;rnn/while/Exit_3:0&amp;#39; shape=(?, 150) dtype=float32&amp;gt;, h=&amp;lt;tf.Tensor &amp;#39;rnn/while/Exit_4:0&amp;#39; shape=(?, 150) dtype=float32&amp;gt;),
 LSTMStateTuple(c=&amp;lt;tf.Tensor &amp;#39;rnn/while/Exit_5:0&amp;#39; shape=(?, 150) dtype=float32&amp;gt;, h=&amp;lt;tf.Tensor &amp;#39;rnn/while/Exit_6:0&amp;#39; shape=(?, 150) dtype=float32&amp;gt;),
 LSTMStateTuple(c=&amp;lt;tf.Tensor &amp;#39;rnn/while/Exit_7:0&amp;#39; shape=(?, 150) dtype=float32&amp;gt;, h=&amp;lt;tf.Tensor &amp;#39;rnn/while/Exit_8:0&amp;#39; shape=(?, 150) dtype=float32&amp;gt;))&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;150&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_epochs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_examples&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;//&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mnist&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;acc_train&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;acc_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Epoch&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Train accuracy =&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;Test accuracy =&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;acc_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Epoch 0 Train accuracy = 0.97333336 Test accuracy = 0.9481
Epoch 1 Train accuracy = 0.97333336 Test accuracy = 0.9703
Epoch 2 Train accuracy = 0.97333336 Test accuracy = 0.9709
Epoch 3 Train accuracy = 1.0 Test accuracy = 0.9786
Epoch 4 Train accuracy = 0.98 Test accuracy = 0.9816
Epoch 5 Train accuracy = 0.99333334 Test accuracy = 0.9846
Epoch 6 Train accuracy = 0.99333334 Test accuracy = 0.9862
Epoch 7 Train accuracy = 1.0 Test accuracy = 0.9852
Epoch 8 Train accuracy = 0.9866667 Test accuracy = 0.9884
Epoch 9 Train accuracy = 0.99333334 Test accuracy = 0.9876
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;LSTM cells manage two state vectors, and for performance reasons they are kept
separate by default. You can change this default behavior by setting
state_is_tuple=False when creating the BasicLSTMCell.&lt;/p&gt;
&lt;p&gt;The key idea is that the network can learn what to store in the
long-term state, what to throw away, and what to read from it. As the long-term state
c(t–1) traverses the network from left to right, you can see that it first goes through a
forget gate, dropping some memories, and then it adds some new memories via the
addition operation (which adds the memories that were selected by an input gate).
The result c(t) is sent straight out, without any further transformation. So, at each time
step, some memories are dropped and some memories are added. Moreover, after the
addition operation, the long-term state is copied and passed through the tanh function,
and then the result is filtered by the output gate. This produces the short-term
state h(t) (which is equal to the cell’s output for this time step y(t)).&lt;/p&gt;
&lt;p&gt;In short, an LSTM cell can learn to recognize an important input (that’s the role of the
input gate), store it in the long-term state, learn to preserve it for as long as it is
needed (that’s the role of the forget gate), and learn to extract it whenever it is needed.
This explains why they have been amazingly successful at capturing long-term patterns
in time series, long texts, audio recordings, and more.&lt;/p&gt;
&lt;h3 id=&quot;PEEPHOLE-Connection&quot;&gt;PEEPHOLE Connection&lt;a class=&quot;anchor-link&quot; href=&quot;#PEEPHOLE-Connection&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;In a basic LSTM cell, the gate controllers can look only at the input x(t) and the previous
short-term state h(t–1). It may be a good idea to give them a bit more context by
letting them peek at the long-term state as well. This idea was proposed by Felix Gers
and Jürgen Schmidhuber in 2000.6 They proposed an LSTM variant with extra connections
called peephole connections: the previous long-term state c(t–1) is added as an
input to the controllers of the forget gate and the input gate, and the current longterm
state c(t) is added as input to the controller of the output gate.
To implement peephole connections in TensorFlow, you must use the LSTMCell
instead of the BasicLSTMCell and set use_peepholes=True:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lstm_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contrib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;LSTMCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;use_peepholes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From &amp;lt;ipython-input-16-f368bbc8fe51&amp;gt;:1: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;GRU-Cells&quot;&gt;GRU Cells&lt;a class=&quot;anchor-link&quot; href=&quot;#GRU-Cells&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The GRU cell is a simplified version of the LSTM cell, and it seems to perform just as
well (which explains its growing popularity). The main simplifications are:&lt;/p&gt;
&lt;p&gt;• Both state vectors are merged into a single vector h(t).
• A single gate controller controls both the forget gate and the input gate. If the
gate controller outputs a 1, the forget gate is open and the input gate is closed. If
it outputs a 0, the opposite happens. In other words, whenever a memory must
be stored, the location where it will be stored is erased first. This is actually a frequent
variant to the LSTM cell in and of itself.
• There is no output gate; the full state vector is output at every time step. However,
there is a new gate controller that controls which part of the previous state
will be shown to the main layer.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;gru_cells&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GRUCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;multi_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;gru_cells&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multi_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;#Train the model&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;square&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AdamOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;MSE:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./gru_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0 	MSE: 14.013569
100 	MSE: 0.49593905
200 	MSE: 0.12562285
300 	MSE: 0.05490951
400 	MSE: 0.06835106
500 	MSE: 0.058419418
600 	MSE: 0.050165113
700 	MSE: 0.047782168
800 	MSE: 0.048071586
900 	MSE: 0.05129924
1000 	MSE: 0.04340675
1100 	MSE: 0.041156635
1200 	MSE: 0.036301177
1300 	MSE: 0.042271547
1400 	MSE: 0.043177534
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Testing the model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;bo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;prediction&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;upper left&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">A guided introduction to building a simple Recurrent Neural Network from scratch</title><link href="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/nlp/rnn/tensorflow1/2020/07/20/Intro_RNN_Tensorflow1.html" rel="alternate" type="text/html" title="A guided introduction to building a simple Recurrent Neural Network from scratch" /><published>2020-07-20T00:00:00-05:00</published><updated>2020-07-20T00:00:00-05:00</updated><id>https://edumunozsala.github.io/BlogEms/fastpages/jupyter/nlp/rnn/tensorflow1/2020/07/20/Intro_RNN_Tensorflow1</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/fastpages/jupyter/nlp/rnn/tensorflow1/2020/07/20/Intro_RNN_Tensorflow1.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-20-Intro_RNN_Tensorflow1.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h1 id=&quot;Introduction-to-Recurrent-Neural-Networks-in-Tensorflow&quot;&gt;Introduction to Recurrent Neural Networks in Tensorflow&lt;a class=&quot;anchor-link&quot; href=&quot;#Introduction-to-Recurrent-Neural-Networks-in-Tensorflow&quot;&gt; &lt;/a&gt;&lt;/h1&gt;&lt;p&gt;A brief summary of an excellent machine learning book &quot;Hands-on Machine Learning with Scikit Learn ad Tensorflow First Edition&quot;. The text and code has been extracted from that source book for educational purposes.&lt;/p&gt;
&lt;p&gt;A recurrent neural network looks very much like a feedforward neural network, except it also has connections pointing backward. The simplest possible RNN is composed of just one neuron receiving inputs, producing an output, and sending that output back to itself. At each time step t (also called a frame), this recurrent neuron receives the inputs x(t) as well as its own output from the previous time step, y(t–1). You can easily create a layer of recurrent neurons. At each time step t, every neuron
receives both the input vector x(t) and the output vector from the previous time step y(t–1). Each recurrent neuron has two sets of weights: one for the inputs x(t) and the other for the outputs of the previous time step, y(t–1).&lt;/p&gt;
&lt;h3 id=&quot;Memory-Cell&quot;&gt;Memory Cell&lt;a class=&quot;anchor-link&quot; href=&quot;#Memory-Cell&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Since the output of a recurrent neuron at time step t is a function of all the inputs from previous time steps, you could say it has a form of memory. A part of a neural network that preserves some state across time steps is called a memory cell.&lt;br /&gt;
In general a cell’s state at time step t, denoted h(t), is a function f of some inputs at that time step and its state at the previous time step (h(t) = f(h(t–1), x(t)) ). Its output at time step t, denoted y(t), is also a function of the previous
state and the current inputs. In the case of the basic cells we have discussed so far, the output is simply equal to the state, but in more complex cells this is not always the case.&lt;/p&gt;
&lt;h3 id=&quot;Input-and-Output-Sequences&quot;&gt;Input and Output Sequences&lt;a class=&quot;anchor-link&quot; href=&quot;#Input-and-Output-Sequences&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;An RNN can simultaneously take a sequence of inputs and produce a sequence of outputs:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Sequence-to-vector: you could feed the network a sequence of inputs, and ignore all outputs
except for the last one. Input, a movie review, and the network would output a sentiment score&lt;/li&gt;
&lt;li&gt;Vector-to-Sequence: you could feed the network a single input at the first time step (and zeros
for all other time steps), and let it output a sequence. The input could be an image, and
the output could be a caption for that image.&lt;/li&gt;
&lt;li&gt;Sequence-to-Sequence: An RNN can simultaneously take a sequence of inputs and produce a sequence of
outputs. Predicting time series such as stock prices: you feed it the prices over the last N
days, and it must output the prices shifted by one day into the future&lt;/li&gt;
&lt;li&gt;Encoder-Decoder: you could have a sequence-to-vector network, called an encoder, followed by a
vector-to-sequence network, called a decoder. translating a sentence from one language to another&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# To plot pretty figures&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;axes.labelsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;xtick.labelsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rcParams&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ytick.labelsize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tensorflow&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tf&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# to make this notebook&amp;#39;s output stable across runs&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_default_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_random_seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;c1&quot;&gt;# Where to save the figures&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PROJECT_ROOT_DIR&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;PROJECT_ID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;rnn&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;RNN-in-Tensorflow&quot;&gt;RNN in Tensorflow&lt;a class=&quot;anchor-link&quot; href=&quot;#RNN-in-Tensorflow&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The basic workflow for creating RNN models in low-level TensorFlow library is almost the
same as MLP:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;First create the input and output placeholders of shape (None, # TimeSteps, #
Features) or (Batch Size, # TimeSteps, # Features)&lt;/li&gt;
&lt;li&gt;From the input placeholder, create a list of length # TimeSteps, containing
Tensors of Shape (None, #Features) or (Batch Size, # Features)&lt;/li&gt;
&lt;li&gt;Create a cell of the desired RNN type from the tf.rnn.rnn_cell module&lt;/li&gt;
&lt;li&gt;Use the cell and the input tensor list created previously to create a static or
dynamic RNN&lt;/li&gt;
&lt;li&gt;Create the output weights and bias variables, and define the loss and optimizer
functions&lt;/li&gt;
&lt;li&gt;For the required number of epochs, train the model using the loss and optimizer
functions&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Basic-RNN&quot;&gt;Basic RNN&lt;a class=&quot;anchor-link&quot; href=&quot;#Basic-RNN&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;A simple RNN model, without using any of TensorFlow’s RNN operations, to better understand what goes on under the hood.
An RNN composed of a layer of five recurrent neurons, using the tanh activation function, that runs over only two time steps,
and taking input vectors of size 3 at each time step,.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Wx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Wy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random_normal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Variable&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tanh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Wx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tanh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Wy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matmul&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Wx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From C:\Users\edumu\AppData\Roaming\Python\Python36\site-packages\tensorflow\python\framework\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
Instructions for updating:
Colocations handled automatically by placer.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This network looks much like a two-layer feedforward neural network, with a few twists: first, the same weights and bias terms are shared by both layers, and second, we feed inputs at each layer, and we get outputs from each layer. To feedforward the model, we need to feed it the inputs at both time steps, like so&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# Feedforward the net, but not training.&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X0_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# t = 0&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# t = 1&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Y0_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X0_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y0_val&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[-0.9824319 ,  0.9570006 , -0.9743307 ,  0.95520276,  0.46366057],
       [-0.999742  ,  0.999999  , -0.999996  ,  0.9999392 ,  0.9985889 ],
       [-0.9999963 ,  1.        , -1.        ,  0.9999999 ,  0.9999974 ],
       [ 0.91073656,  0.99982816, -0.9971014 ,  0.82599384,  0.9999999 ]],
      dtype=float32)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;This mini-batch contains four instances (data samples), each with an input sequence composed of
exactly two inputs (the time steps) and three features for instance. At the end, Y0_val and Y1_val contain the outputs of the network at both time steps for all neurons (5) and all instances in the mini-batch.&lt;br /&gt;
If you want to be able to run an RNN over 100 time steps, the graph is going to be pretty big. Now let’s look at how to create the same model using TensorFlow’s RNN operations.&lt;br /&gt;
The static_rnn() function creates an unrolled RNN network by chaining cells. The following code creates the exact same model as the previous one:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_seqs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;static_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                                                &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output_seqs&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From &amp;lt;ipython-input-5-49c4dd7035a4&amp;gt;:6: BasicRNNCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.SimpleRNNCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From &amp;lt;ipython-input-5-49c4dd7035a4&amp;gt;:8: static_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell, unroll=True)`, which is equivalent to this API
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X1_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Y0_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Y0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Y1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X0_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X1_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The static_rnn() function
calls the cell factory’s &lt;strong&gt;call&lt;/strong&gt;() function once per input, creating two copies of the
cell (each containing a layer of five recurrent neurons), with shared weights and bias
terms, and it chains them just like we did earlier. The static_rnn() function returns
two objects. The first is a Python list containing the output tensors for each time step.
The second is a tensor containing the final states of the network. When you are using
basic cells, the final state is simply equal to the last output.&lt;br /&gt;
If there were 50 time steps, it would not be very convenient to have to define 50 input placeholders and 50 output tensors. Moreover, at execution time you would have to feed each of the 50 placeholders and manipulate the 50 outputs. Let’s simplify this.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Length of the input sequence&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Number of features per input data&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#Length of output sequence&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_seqs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unstack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;perm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;output_seqs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;static_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_seqs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                                &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output_seqs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;perm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;The previous code builds the same RNN again, but this time it takes a single input placeholder of shape [None, n_steps, n_inputs] where the first dimension is the mini-batch size. Then it extracts the list of input sequences for each time step. X_seqs is a Python list of n_steps tensors of shape [None, n_inputs], where once again the first dimension is the mini-batch size. To do this, we first swap the first two dimensions using the transpose() function, so that the time steps are now the first dimension. Then we extract a Python list of tensors along the first dimension (i.e., one tensor per time step) using the unstack() function. The next two lines are the same as before. Finally, we merge all the output tensors into a single tensor using the stack() function, and we swap the first two dimensions to get a final outputs tensor of shape [None, n_steps, n_neurons] (again the first dimension is the mini-batch size).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# t = 0      t = 1 &lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 1&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 2&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 3&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 4&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transpose&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;axes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[[-0.9428799  -0.9998869   0.94055814  0.9999985  -0.9999997 ]
 [-0.637116    0.11300927  0.5798437   0.4310559  -0.6371699 ]
 [-0.9165386  -0.9945604   0.896054    0.99987197 -0.9999751 ]
 [-0.02746338 -0.73191994  0.7827872   0.9525682  -0.9781773 ]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;However, this approach still builds a graph containing one cell per time step. If there were 50 time steps, the graph would look pretty ugly. It is a bit like writing a program without ever using loops (e.g., Y0=f(0, X0); Y1=f(Y0, X1); Y2=f(Y1, X2); ...; Y50=f(Y49, X50)). Fortunately, there is a better solution: the dynamic_rnn() function.&lt;br /&gt;
The dynamic_rnn() function uses a while_loop() operation to run over the cell the appropriate number of times. Conveniently, it also accepts a single tensor for all inputs at every time step (shape [None, n_steps, n_inputs]) and it outputs a single tensor for all outputs at every time step (shape [None, n_steps, n_neurons]); there is no need to stack, unstack, or transpose. The following code creates the same RNN as earlier using the dynamic_rnn() function.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From &amp;lt;ipython-input-10-1e39d93c6961&amp;gt;:6: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 1&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 2&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 3&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 4&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[[[-0.85115266  0.87358344  0.5802911   0.8954789  -0.0557505 ]
  [-0.999996    0.99999577  0.9981815   1.          0.37679607]]

 [[-0.9983293   0.9992038   0.98071456  0.999985    0.25192663]
  [-0.7081804  -0.0772338  -0.85227895  0.5845349  -0.78780943]]

 [[-0.9999827   0.99999535  0.9992863   1.          0.5159072 ]
  [-0.9993956   0.9984095   0.83422637  0.99999976 -0.47325212]]

 [[ 0.87888587  0.07356028  0.97216916  0.9998546  -0.7351168 ]
  [-0.9134514   0.3600957   0.7624866   0.99817705  0.80142   ]]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Handling-Variable-Length-Input-Sequences&quot;&gt;Handling Variable Length Input Sequences&lt;a class=&quot;anchor-link&quot; href=&quot;#Handling-Variable-Length-Input-Sequences&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;So far we have used only fixed-size input sequences (all exactly two steps long). What
if the input sequences have variable lengths (e.g., like sentences)? In this case you
should set the sequence_length argument when calling the dynamic_rnn() (or
static_rnn()) function; it must be a 1D tensor indicating the length of the input
sequence for each instance.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seq_length&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;int32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basic_cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                                    &lt;span class=&quot;n&quot;&gt;sequence_length&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From C:\Users\edumu\AppData\Roaming\Python\Python36\site-packages\tensorflow\python\ops\rnn.py:626: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.cast instead.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Suppose the second input sequence contains only one input instead of two. It must be padded with a zero vector in order to fit in the input tensor X (because the input tensor’s second dimension is the size of the longest sequence).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# step 0     step 1&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 1&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 2 (padded with zero vectors)&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 3&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# instance 4&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;seq_length_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states_val&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;seq_length_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs_val&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[[[-0.9123188   0.16516446  0.5548655  -0.39159346  0.20846416]
  [-1.          0.956726    0.99831694  0.99970174  0.96518576]]

 [[-0.9998612   0.6702289   0.9723653   0.6631046   0.74457586]
  [ 0.          0.          0.          0.          0.        ]]

 [[-0.99999976  0.8967997   0.9986295   0.9647514   0.93662   ]
  [-0.9999526   0.9681953   0.96002865  0.98706263  0.85459226]]

 [[-0.96435434  0.99501586 -0.36150697  0.9983378   0.999497  ]
  [-0.9613586   0.9568762   0.7132288   0.97729224 -0.0958299 ]]]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Now the RNN outputs zero vectors for every time step past the input sequence length
(look at the second instance’s output for the second time step):&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Training-an-RNN&quot;&gt;Training an RNN&lt;a class=&quot;anchor-link&quot; href=&quot;#Training-an-RNN&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;To train an RNN, the trick is to unroll it through time (like we just did) and then simply use regular backpropagation (see Figure 14-5). This strategy is called backpropagation through time (BPTT). Note that the gradients flow backward through all
the outputs used by the cost function, not just through the final output.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Let's start using RNN for time series prediction&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# This will be defined in every example&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save_fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fig_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;path&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;PROJECT_ROOT_DIR&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;images&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CHAPTER_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fig_id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;.png&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Saving figure&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fig_id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tight_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savefig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;png&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dpi&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sin&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rand&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;Ts&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t0&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;ys&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Ts&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;((&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linspace&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;12.2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;121&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;A time series (generated)&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;$t . \sin(t) / 3 + 2 . \sin(5t)$&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;A training instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;lower left&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;axis&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;122&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;A training instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;bo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;upper left&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;save_fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;time_series_plot&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Saving figure time_series_plot
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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ziYrK4u1a9fy2WefERQUxDXXXMOpU6fcep+mtOTx7Nu3L0ePHq2dvv3220avbc7xVsodvRIj2aclEEoppRzwqgTCGLPAQfWmBXWWf2KM6WeMCbdVidrvuWg9q7KykpCQEL744gueeOIJRIQBAwa4fM0XX3zBqFGjiIqKIjY2lpEjR9bedW9Y5WbcuHFkZWXxi1/8gsTERJKTk5k7dy41NTW163z00UcEBAQwZswYt+L6/ve/z1tvvdUorq+//pqysjIuv/xypkyZwsSJE+nduzd9+vThqaeeIjo6mq+++uqijldDH3/8MXfccQcDBw5k0KBBvPbaa+Tn57NmzRq3t9EWxxMgKCiITp061U51OwW4kOOtlDt6JUWxr0BLIJRSSjXWnrpxbTOPfbidHUfOtel7pneJ4dHrXScAdQUGBvLVV1+RmZnJ+vXr6d69O6GhoU7Xr6qqYsqUKcyaNYs33niDyspKNm7cSGCg8y4a33jjDebMmcPatWvZvHkzt956K8OGDeOWW24B4Msvv2TYsGH1+s13FdeIESN48sknKS0tJTw8vPY177//PpMmTSIoqP7Hsbq6mnfffZeioiJGjx7t9rG5EIWFhdTU1NChQwe31m+r4wmwb9++2tHSR44cydNPP02vXr2ACzveSrmjV1IkS785RGFZJdHaQ5VSSqk6NIFopwICAjh69CjR0dEMHz68ycGvzp07x5kzZ7j++utr69f36+d6DL709HQef/xxAPr06cOf//xnPv3009oL3ry8PDp37ux2XF26dKGyspIjR47UazPx97//nSeeeKL2+bfffstll11GWVkZUVFRLFu2jEGDBrlxVC7cnDlzGDJkCJdddplb67fV8Rw5ciSvvvoq/fr148SJEzz55JOMHj2a7du3k5CQcEHHWyl3pNkaUu/LL2ZwtzgKiso9HJFSSilvoQmEA80pCfCkTZs2MXjwYLdGzo2Pj+f2229nwoQJjB8/nvHjxzNt2jS6devm9DUZGRn1nnfp0oUTJ07UPi8tLaVjx45ux2W/C15aer5v+b1797Jv3z4mTJhQO69v375s3ryZM2fO8Le//Y2ZM2eSnZ3NwIEDG73X008/zdNPP137vLy8HBHh2WefrZ23YsUKrrjiCqf7+cADD7B69WpWr17tsgShrrY6nhMnTqz3fNSoUfTq1YslS5bwwAMPAM073kq5q3eylUDsOnaOwd3iuP+dzR6OSCmllLfwqjYQqnk2b97M0KFD3V5/8eLFrF+/nrFjx/LBBx/Qp08fPv74Y6frBwfXr7YgIvXq7CcmJnL69Gm347I3UK5bh//9999n/PjxREZG1s4LCQmhd+/eZGZm8swzzzBkyBB++9vfOozxnnvuYfPmzbXT97///UbzMjMzne7j/fffz1tvvcVnn31WWy3IXW11POuKiopiwIABfPfdd7XzmnO8lXJXz4RIEqNCWbP3JKUV1azPbZkOBppDREJF5GURyRORQhHZJCITm35l+5KTA1lZkJICy5ZZj1lZ1nyllPJGmkC0Y1u2bGl0V7spgwcPZt68eWRnZzNu3DiWLFlywe8/dOhQduzY4XZc27Zto0uXLvXusv/973/nhhtucPk+NTU1lJc7rj4RHx9P7969a6fo6OhG85zV/58zZw5vvvkmn332WZPVj5xpi+NZV1lZGbt27apX1ak5x1spdwUECGMvSWT13gLW5hRQUVXT9ItaXhBwELgSiAV+CfxVRHp4IpjWsGIFZGTAokVw1VVw440wbpz1PCPDWq6UUt5GE4h2rKqqil27dnHkyBHOnDkDwMKFCx1eDOfm5jJ//nzWrl1LXl4eq1atYuvWraSnp1/w+0+YMIGdO3dy8uTJJuMCq5Fw3bEK8vPzWbduHddff33tvPnz5/Pll1+yf/9+vv32Wx566CGys7OZPn36BcfpyL333svixYt566236NChA8eOHePYsWMUFZ3vttLZsYS2O55z587l888/Jzc3l/Xr1zN16lSKi4uZOXNm7TruHm+lmuuKPomcKq7gD9k5hAW3/c+FMabY1jvffmNMjTHmH0AuMKzNg2kFOTkwdSqUlEBlJdx5pzX/zjut5yUl1nItiVBKeRtNINqxp556irfffpuUlBQeeughAAoKCti9e3ejdSMiItizZw/Tpk2jT58+zJw5k+nTpzNv3rwLfv9BgwYxYsQI3n777SbjKisrY9myZdx1112163344YcMHz683h3yY8eOMWPGDPr27cv48eP5+uuvWbFiRaO2ABfrD3/4A4WFhYwfP57OnTvXTnXbTjg7ltB2x/PQoUPccsst9O3blx/84AeEhoaybt06UlNTa9dx93gr1VxjeiciAt/knWZ0WqKnw0FEOgJ9gO2ejqUlVFRAcTEYY032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T2fRokUXvM3MzMx6z6urq3nqqafIyMggISGBqKgo3nvvPQ4cOOByOxkZGfWed+nShRMnTlzwa3bt2kWXLl3o2rVr7fLhw4cTEND8j296ejpBQefHT6z7PvHx8dx+++1MmDCBSZMm8fzzz3Pw4MEmt7lx40amTJlCamoq0dHRtcex4XGqu49dunQBqH3vTZs2MX78eIfb37FjB2VlZVx33XVERUXVTn/84x/J0dubSnlUTg5MnQolJVBZCXfeac2/807reUmJtVz/VZVSvkRHonbAGE9H0LRFixZRXV1N9+7da+cZW+AHDx6kW7duzd5mZGRkvefPPvsszz33HC+88AKDBg0iKiqKX/ziF00mA8HBwfWei0i9NhDNfY0xBmlu/a4LjG3x4sX813/9FytXruSDDz7g4Ycf5v3332fChAkOt1dcXMyECRO45ppreO2110hOTqagoIArrriCiooKp+9t35+6++iMfZ0PP/yw3vl2tD9KqbZVUQHFxeef22tWjhlT/7dk1662jUsppVqTlkC0Q1VVVSxZsoRnnnmGzZs3105btmwhIyOjUUPnukJCQqiurnbrfVavXs3111/PbbfdxpAhQ0hLS2PPnj0ttRtu69+/P4cPH65tUAywYcOGJpOSCzV48GDmzZtHdnY248aNY8mSJYDjY7dr1y4KCgp4+umnGTt2LP369WsywXLk0ksv5bPPPnO4LD09ndDQUPLy8ujdu3e9KTU1tfk7qJRqMXPn1k8gQkPrP4K1/MEH2zYupZRqTV6VQIjIfSKyQUTKReTVBst6iIgRkaI60y89FKpHLV++nIKCAu666y4GDhxYb/rRj37EK6+84vTiukePHmzbto3du3dTUFDgstF1nz59+PTTT1m9ejW7du3ivvvuIzc3t7V2y6lrr72Wvn37MnPmTLZs2cK6det44IEHCAoKarGSCYDc3Fzmz5/P2rVrycvLY9WqVWzdupX09HTAOnZlZWX861//oqCggJKSErp3705oaCgLFy5k3759LF++nF/+svkfy5/97Gds2rSJ2bNns2XLFnbv3s2iRYs4cOAA0dHRzJ07l7lz5/LKK6+wd+9eNm/ezJ/+9CdeeumlFtt/pVTzrVgBkyfXTyLqKi6GSZNg5cq2jUsppVqTVyUQwBHgSeAVF+vEGWOibNMTbRSXV3n55Ze56qqrHI5xMG3a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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;First, let’s create the RNN. It will contain 100 recurrent neurons and we will unroll it over 20 time steps since each training instance will be 20 inputs long. Each input will contain only one feature (the value at that time). The targets are also sequences of 20 inputs, each containing a single value. At each time step we now have an output vector of size 100. But what we actually want is a single output value at each time step. The simplest solution is to wrap the cell in an OutputProjectionWrapper.The OutputProjectionWrapper adds a fully connected layer of linear neurons (i.e., without any activation function) on top of each output (but it does not affect the cell state). All these fully connected layers share the same (trainable) weights and bias terms.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contrib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;OutputProjectionWrapper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;contrib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;output_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;So far, so good. Now we need to define the cost function. We will use the Mean Squared Error (MSE), as we did in previous regression tasks. Next we will create an Adam optimizer, the training op, and the variable initialization op, as usual.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;square&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# MSE&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AdamOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;MSE:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./RNN_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0 	MSE: 10.261381
100 	MSE: 0.38792896
200 	MSE: 0.10900874
300 	MSE: 0.061354414
400 	MSE: 0.059336416
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Once the model is trained, you can make predictions&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                          &lt;span class=&quot;c1&quot;&gt;# not shown in the book&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./RNN_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;c1&quot;&gt;# not shown&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;INFO:tensorflow:Restoring parameters from ./RNN_time_series_model
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[[-3.4715862],
        [-2.496961 ],
        [-1.1906002],
        [ 0.5933468],
        [ 2.1409998],
        [ 3.1869278],
        [ 3.5038798],
        [ 3.3455482],
        [ 2.8316703],
        [ 2.2724738],
        [ 1.7263942],
        [ 1.5089282],
        [ 1.8453466],
        [ 2.7461205],
        [ 3.8531406],
        [ 5.098026 ],
        [ 6.1933246],
        [ 6.7496552],
        [ 6.623117 ],
        [ 6.043438 ]]], dtype=float32)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Testing the model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;bo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;prediction&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;upper left&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;save_fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;time_series_pred_plot&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Saving figure time_series_pred_plot
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Without-using-an-OutputProjectionWrapper&quot;&gt;Without using an OutputProjectionWrapper&lt;a class=&quot;anchor-link&quot; href=&quot;#Without-using-an-OutputProjectionWrapper&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;There is a trickier but more efficient solution: you can reshape the RNN outputs from [batch_size, n_steps, n_neurons] to [batch_size &lt;em&gt; n_steps, n_neurons], then apply a single fully connected layer with the appropriate output size (in our case just 1), which will result in an output tensor of shape [batch_size &lt;/em&gt; n_steps, n_outputs], and then reshape this tensor
to [batch_size, n_steps, n_outputs].&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;placeholder&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_cell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;BasicRNNCell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;num_units&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;activation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dynamic_rnn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cell&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.001&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_neurons&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_rnn_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stacked_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;WARNING:tensorflow:From &amp;lt;ipython-input-56-f1563c9dbe7a&amp;gt;:18: dense (from tensorflow.python.layers.core) is deprecated and will be removed in a future version.
Instructions for updating:
Use keras.layers.dense instead.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reduce_mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;square&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AdamOptimizer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;learning_rate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;global_variables_initializer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Saver&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1500&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;50&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_iterations&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;next_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;training_op&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;MSE:&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_inputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./RNN_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0 	MSE: 13.907029
100 	MSE: 0.5056698
200 	MSE: 0.19735886
300 	MSE: 0.101214476
400 	MSE: 0.06850145
500 	MSE: 0.06291986
600 	MSE: 0.055129297
700 	MSE: 0.049436502
800 	MSE: 0.050434686
900 	MSE: 0.0482007
1000 	MSE: 0.04809868
1100 	MSE: 0.04982501
1200 	MSE: 0.041912545
1300 	MSE: 0.049292978
1400 	MSE: 0.043140374
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Testing the model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fontsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;bo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;instance&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]),&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;w*&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;target&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_instance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,:,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;r.&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;markersize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;prediction&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;legend&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;upper left&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Generating-a-new-sequence,-creative-RNN&quot;&gt;Generating a new sequence, creative RNN&lt;a class=&quot;anchor-link&quot; href=&quot;#Generating-a-new-sequence,-creative-RNN&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Once the net is trained we can use it to generate some creative sequences. All we need is to provide it a seed sequence containing n_steps values (e.g., full of zeros), use the model to predict the next value, append this predicted value to the sequence, feed the last n_steps values to the model to predict the next value, and so on. This process generates
a new sequence that has some resemblance to the original time series&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;                        &lt;span class=&quot;c1&quot;&gt;# not shown in the book&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./RNN_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# not shown&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;300&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;INFO:tensorflow:Restoring parameters from ./RNN_time_series_model
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;arange&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tf&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;saver&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;restore&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;./RNN_time_series_model&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;sequence1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sequence1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;sequence2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;time_series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resolution&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t_min&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iteration&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sequence2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sess&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;feed_dict&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;sequence2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figure&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;figsize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;121&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ylabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Value&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;subplot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;122&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;t&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sequence2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_steps&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;b-&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;linewidth&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xlabel&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;Time&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;save_fig&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;creative_sequence_plot&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;plt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;show&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;INFO:tensorflow:Restoring parameters from ./RNN_time_series_model
Saving figure creative_sequence_plot
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;In the figure we can see the sequence generated using an non-zero initial state at the right.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html"></summary></entry><entry><title type="html">An Example Markdown Post</title><link href="https://edumunozsala.github.io/BlogEms/markdown/2020/01/14/test-markdown-post.html" rel="alternate" type="text/html" title="An Example Markdown Post" /><published>2020-01-14T00:00:00-06:00</published><updated>2020-01-14T00:00:00-06:00</updated><id>https://edumunozsala.github.io/BlogEms/markdown/2020/01/14/test-markdown-post</id><content type="html" xml:base="https://edumunozsala.github.io/BlogEms/markdown/2020/01/14/test-markdown-post.html">&lt;h1 id=&quot;example-markdown-post&quot;&gt;Example Markdown Post&lt;/h1&gt;

&lt;h2 id=&quot;basic-setup&quot;&gt;Basic setup&lt;/h2&gt;

&lt;p&gt;Jekyll requires blog post files to be named according to the following format:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;YEAR-MONTH-DAY-filename.md&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Where &lt;code class=&quot;highlighter-rouge&quot;&gt;YEAR&lt;/code&gt; is a four-digit number, &lt;code class=&quot;highlighter-rouge&quot;&gt;MONTH&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;DAY&lt;/code&gt; are both two-digit numbers, and &lt;code class=&quot;highlighter-rouge&quot;&gt;filename&lt;/code&gt; is whatever file name you choose, to remind yourself what this post is about. &lt;code class=&quot;highlighter-rouge&quot;&gt;.md&lt;/code&gt; is the file extension for markdown files.&lt;/p&gt;

&lt;p&gt;The first line of the file should start with a single hash character, then a space, then your title. This is how you create a “&lt;em&gt;level 1 heading&lt;/em&gt;” in markdown. Then you can create level 2, 3, etc headings as you wish but repeating the hash character, such as you see in the line &lt;code class=&quot;highlighter-rouge&quot;&gt;## File names&lt;/code&gt; above.&lt;/p&gt;

&lt;h2 id=&quot;basic-formatting&quot;&gt;Basic formatting&lt;/h2&gt;

&lt;p&gt;You can use &lt;em&gt;italics&lt;/em&gt;, &lt;strong&gt;bold&lt;/strong&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;code font text&lt;/code&gt;, and create &lt;a href=&quot;https://www.markdownguide.org/cheat-sheet/&quot;&gt;links&lt;/a&gt;. Here’s a footnote &lt;sup id=&quot;fnref:1&quot; role=&quot;doc-noteref&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot; rel=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. Here’s a horizontal rule:&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;lists&quot;&gt;Lists&lt;/h2&gt;

&lt;p&gt;Here’s a list:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;item 1&lt;/li&gt;
  &lt;li&gt;item 2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;And a numbered list:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;item 1&lt;/li&gt;
  &lt;li&gt;item 2&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;boxes-and-stuff&quot;&gt;Boxes and stuff&lt;/h2&gt;

&lt;blockquote&gt;
  &lt;p&gt;This is a quotation&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;Toast Toast--warning googoo&quot;&gt;
   &lt;span class=&quot;Toast-icon&quot;&gt;&lt;svg class=&quot;octicon octicon-alert&quot; viewBox=&quot;0 0 16 16&quot; version=&quot;1.1&quot; width=&quot;16&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 000 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 00.01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;
   &lt;span class=&quot;Toast-content&quot;&gt;You can include alert boxes&lt;/span&gt;
&lt;/div&gt;

&lt;p&gt;…and…&lt;/p&gt;

&lt;div class=&quot;Toast&quot;&gt;
   &lt;span class=&quot;Toast-icon&quot;&gt;&lt;svg class=&quot;octicon octicon-info&quot; viewBox=&quot;0 0 14 16&quot; version=&quot;1.1&quot; width=&quot;14&quot; height=&quot;16&quot; aria-hidden=&quot;true&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/span&gt;
   &lt;span class=&quot;Toast-content&quot;&gt;You can include info boxes&lt;/span&gt;
&lt;/div&gt;

&lt;h2 id=&quot;images&quot;&gt;Images&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/BlogEms/images/logo.png&quot; alt=&quot;&quot; title=&quot;fast.ai's logo&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;code&quot;&gt;Code&lt;/h2&gt;

&lt;p&gt;You can format text and code per usual&lt;/p&gt;

&lt;p&gt;General preformatted text:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Do a thing
do_thing()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Python code and output:&lt;/p&gt;

&lt;div class=&quot;language-python highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Prints '2'
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Formatting text as shell commands:&lt;/p&gt;

&lt;div class=&quot;language-shell highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;hello world&quot;&lt;/span&gt;
./some_script.sh &lt;span class=&quot;nt&quot;&gt;--option&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;value&quot;&lt;/span&gt;
wget https://example.com/cat_photo1.png
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Formatting text as YAML:&lt;/p&gt;

&lt;div class=&quot;language-yaml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;value&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;another_key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;another&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s&quot;&gt;value&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;tables&quot;&gt;Tables&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Column 1&lt;/th&gt;
      &lt;th&gt;Column 2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;A thing&lt;/td&gt;
      &lt;td&gt;Another thing&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;tweetcards&quot;&gt;Tweetcards&lt;/h2&gt;

&lt;div class=&quot;jekyll-twitter-plugin&quot;&gt;&lt;blockquote class=&quot;twitter-tweet&quot;&gt;&lt;p lang=&quot;en&quot; dir=&quot;ltr&quot;&gt;Altair 4.0 is released! &lt;a href=&quot;https://t.co/PCyrIOTcvv&quot;&gt;https://t.co/PCyrIOTcvv&lt;/a&gt;&lt;br /&gt;Try it with:&lt;br /&gt;&lt;br /&gt;  pip install -U altair&lt;br /&gt;&lt;br /&gt;The full list of changes is at &lt;a href=&quot;https://t.co/roXmzcsT58&quot;&gt;https://t.co/roXmzcsT58&lt;/a&gt; ...read on for some highlights. &lt;a href=&quot;https://t.co/vWJ0ZveKbZ&quot;&gt;pic.twitter.com/vWJ0ZveKbZ&lt;/a&gt;&lt;/p&gt;&amp;mdash; Jake VanderPlas (@jakevdp) &lt;a href=&quot;https://twitter.com/jakevdp/status/1204765621767901185?ref_src=twsrc%5Etfw&quot;&gt;December 11, 2019&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async=&quot;&quot; src=&quot;https://platform.twitter.com/widgets.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;
&lt;/div&gt;

&lt;h2 id=&quot;footnotes&quot;&gt;Footnotes&lt;/h2&gt;

&lt;div class=&quot;footnotes&quot; role=&quot;doc-endnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot; role=&quot;doc-endnote&quot;&gt;
      &lt;p&gt;This is the footnote. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot; role=&quot;doc-backlink&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name></name></author><summary type="html">Example Markdown Post</summary></entry></feed>